<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ä¸‰ é›†ç¾¤éƒ¨ç½² | AGou&#39;s Docs-v2</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="https://infinitypro-img.infinitynewtab.com/custom-icon/8001de1jd3n68lbfnxxt564xvb0vl5.png?imageMogr2/thumbnail/240x/format/webp/blur/1x0/quality/100|imageslim">
    <script language="javascript" type="text/javascript" src="https://cdn.staticfile.org/jquery/1.7.2/jquery.min.js"></script>
    <script language="javascript" type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-2DZCW6NJZF"></script>
    <script language="javascript" type="text/javascript" content="function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag(&quot;js&quot;,new Date),gtag(&quot;config&quot;,&quot;G-2DZCW6NJZF&quot;);"></script>
    <meta name="description" content="å²‚èƒ½å°½å¦‚äººæ„ï¼Œä½†æ±‚æ— æ„§æˆ‘å¿ƒã€‚">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/myDocsv2/assets/css/0.styles.21bb8301.css" as="style"><link rel="preload" href="/myDocsv2/assets/js/app.792c833e.js" as="script"><link rel="preload" href="/myDocsv2/assets/js/5.dd197eb6.js" as="script"><link rel="preload" href="/myDocsv2/assets/js/1.3bd7010a.js" as="script"><link rel="preload" href="/myDocsv2/assets/js/2.0c757b52.js" as="script"><link rel="preload" href="/myDocsv2/assets/js/54.e8578653.js" as="script"><link rel="preload" href="/myDocsv2/assets/js/17.ce9a229a.js" as="script"><link rel="prefetch" href="/myDocsv2/assets/js/10.560f0585.js"><link rel="prefetch" href="/myDocsv2/assets/js/100.d260e792.js"><link rel="prefetch" href="/myDocsv2/assets/js/101.59a52c3b.js"><link rel="prefetch" href="/myDocsv2/assets/js/102.c83fe080.js"><link rel="prefetch" href="/myDocsv2/assets/js/103.486f1569.js"><link rel="prefetch" href="/myDocsv2/assets/js/104.147ef422.js"><link rel="prefetch" href="/myDocsv2/assets/js/105.7cdddb7f.js"><link rel="prefetch" href="/myDocsv2/assets/js/106.6bb6504a.js"><link rel="prefetch" href="/myDocsv2/assets/js/107.958c4a2e.js"><link rel="prefetch" href="/myDocsv2/assets/js/108.89dea5fa.js"><link rel="prefetch" href="/myDocsv2/assets/js/109.25e918a2.js"><link rel="prefetch" href="/myDocsv2/assets/js/11.30085370.js"><link rel="prefetch" href="/myDocsv2/assets/js/110.5b72de31.js"><link rel="prefetch" href="/myDocsv2/assets/js/111.950db23b.js"><link rel="prefetch" href="/myDocsv2/assets/js/112.dea68ec6.js"><link rel="prefetch" href="/myDocsv2/assets/js/113.4cd2fdf5.js"><link rel="prefetch" href="/myDocsv2/assets/js/114.8fb68b8d.js"><link rel="prefetch" href="/myDocsv2/assets/js/115.853e9eac.js"><link rel="prefetch" href="/myDocsv2/assets/js/116.370ed12f.js"><link rel="prefetch" href="/myDocsv2/assets/js/117.e54ab1d2.js"><link rel="prefetch" href="/myDocsv2/assets/js/118.f875192d.js"><link rel="prefetch" href="/myDocsv2/assets/js/119.130ba6df.js"><link rel="prefetch" href="/myDocsv2/assets/js/12.bad43817.js"><link rel="prefetch" href="/myDocsv2/assets/js/120.ea722a75.js"><link rel="prefetch" href="/myDocsv2/assets/js/121.e6b1a38f.js"><link rel="prefetch" href="/myDocsv2/assets/js/122.cfa9c92b.js"><link rel="prefetch" href="/myDocsv2/assets/js/123.bd0e517c.js"><link rel="prefetch" href="/myDocsv2/assets/js/124.516b8976.js"><link rel="prefetch" href="/myDocsv2/assets/js/125.aa9491a0.js"><link rel="prefetch" href="/myDocsv2/assets/js/126.249ad6f3.js"><link rel="prefetch" href="/myDocsv2/assets/js/127.15e07998.js"><link rel="prefetch" href="/myDocsv2/assets/js/128.6e4e1f1d.js"><link rel="prefetch" href="/myDocsv2/assets/js/129.9fa7ef9d.js"><link rel="prefetch" href="/myDocsv2/assets/js/13.4f93795a.js"><link rel="prefetch" href="/myDocsv2/assets/js/130.7ed7958f.js"><link rel="prefetch" href="/myDocsv2/assets/js/131.6a4ed50f.js"><link rel="prefetch" href="/myDocsv2/assets/js/132.60d2ac03.js"><link rel="prefetch" href="/myDocsv2/assets/js/133.657186df.js"><link rel="prefetch" href="/myDocsv2/assets/js/134.de4a0998.js"><link rel="prefetch" href="/myDocsv2/assets/js/135.773bff70.js"><link rel="prefetch" href="/myDocsv2/assets/js/136.03b7adc5.js"><link rel="prefetch" href="/myDocsv2/assets/js/137.e59abdb8.js"><link rel="prefetch" href="/myDocsv2/assets/js/138.b00ee386.js"><link rel="prefetch" href="/myDocsv2/assets/js/139.11d16ca5.js"><link rel="prefetch" href="/myDocsv2/assets/js/14.5b43ffdb.js"><link rel="prefetch" href="/myDocsv2/assets/js/140.d2461af0.js"><link rel="prefetch" href="/myDocsv2/assets/js/141.51a02429.js"><link rel="prefetch" href="/myDocsv2/assets/js/142.de00d6b2.js"><link rel="prefetch" href="/myDocsv2/assets/js/143.2e00599f.js"><link rel="prefetch" href="/myDocsv2/assets/js/144.d91b742b.js"><link rel="prefetch" href="/myDocsv2/assets/js/145.fd4eeb59.js"><link rel="prefetch" href="/myDocsv2/assets/js/146.2da768b9.js"><link rel="prefetch" href="/myDocsv2/assets/js/147.2392d1bd.js"><link rel="prefetch" href="/myDocsv2/assets/js/148.3f9f1e85.js"><link rel="prefetch" href="/myDocsv2/assets/js/149.ccc77b35.js"><link rel="prefetch" href="/myDocsv2/assets/js/15.567b35e8.js"><link rel="prefetch" href="/myDocsv2/assets/js/150.bc27fad5.js"><link rel="prefetch" href="/myDocsv2/assets/js/151.8d88bccd.js"><link rel="prefetch" href="/myDocsv2/assets/js/152.2f8b753c.js"><link rel="prefetch" href="/myDocsv2/assets/js/153.3e99f777.js"><link rel="prefetch" href="/myDocsv2/assets/js/154.28a03309.js"><link rel="prefetch" href="/myDocsv2/assets/js/155.d31e6da9.js"><link rel="prefetch" href="/myDocsv2/assets/js/156.dbbb018d.js"><link rel="prefetch" href="/myDocsv2/assets/js/157.dacf2c34.js"><link rel="prefetch" href="/myDocsv2/assets/js/158.92d5a5c7.js"><link rel="prefetch" href="/myDocsv2/assets/js/159.163e1ce5.js"><link rel="prefetch" href="/myDocsv2/assets/js/16.246dc068.js"><link rel="prefetch" href="/myDocsv2/assets/js/160.f6373d44.js"><link rel="prefetch" href="/myDocsv2/assets/js/161.1ee05cbb.js"><link rel="prefetch" href="/myDocsv2/assets/js/162.90d44205.js"><link rel="prefetch" href="/myDocsv2/assets/js/163.0ab9f4cc.js"><link rel="prefetch" href="/myDocsv2/assets/js/164.e7b76b81.js"><link rel="prefetch" href="/myDocsv2/assets/js/165.f4e96a57.js"><link rel="prefetch" href="/myDocsv2/assets/js/166.9da04171.js"><link rel="prefetch" href="/myDocsv2/assets/js/167.7869b189.js"><link rel="prefetch" href="/myDocsv2/assets/js/168.fd171306.js"><link rel="prefetch" href="/myDocsv2/assets/js/169.a3accba0.js"><link rel="prefetch" href="/myDocsv2/assets/js/170.69b8ea3d.js"><link rel="prefetch" href="/myDocsv2/assets/js/171.8519d41a.js"><link rel="prefetch" href="/myDocsv2/assets/js/172.853e162a.js"><link rel="prefetch" href="/myDocsv2/assets/js/173.61f68a82.js"><link rel="prefetch" href="/myDocsv2/assets/js/174.4a6c4ebe.js"><link rel="prefetch" href="/myDocsv2/assets/js/175.4da076f8.js"><link rel="prefetch" href="/myDocsv2/assets/js/176.db59955f.js"><link rel="prefetch" href="/myDocsv2/assets/js/177.8e8a7c16.js"><link rel="prefetch" href="/myDocsv2/assets/js/178.c253fb27.js"><link rel="prefetch" href="/myDocsv2/assets/js/179.5662c8f8.js"><link rel="prefetch" href="/myDocsv2/assets/js/18.42c2a799.js"><link rel="prefetch" href="/myDocsv2/assets/js/180.54165af7.js"><link rel="prefetch" href="/myDocsv2/assets/js/181.e07c952b.js"><link rel="prefetch" href="/myDocsv2/assets/js/182.53626bff.js"><link rel="prefetch" href="/myDocsv2/assets/js/183.b92c4e7a.js"><link rel="prefetch" href="/myDocsv2/assets/js/184.640e2011.js"><link rel="prefetch" href="/myDocsv2/assets/js/185.82c83e0f.js"><link rel="prefetch" href="/myDocsv2/assets/js/186.0e7a9c8a.js"><link rel="prefetch" href="/myDocsv2/assets/js/187.b1279218.js"><link rel="prefetch" href="/myDocsv2/assets/js/188.919e8202.js"><link rel="prefetch" href="/myDocsv2/assets/js/189.12ca6319.js"><link rel="prefetch" href="/myDocsv2/assets/js/19.80fbdf4d.js"><link rel="prefetch" href="/myDocsv2/assets/js/190.0cabf0ec.js"><link rel="prefetch" href="/myDocsv2/assets/js/191.4473c05d.js"><link rel="prefetch" href="/myDocsv2/assets/js/192.cfd1676f.js"><link rel="prefetch" href="/myDocsv2/assets/js/193.be924226.js"><link rel="prefetch" href="/myDocsv2/assets/js/194.28405918.js"><link rel="prefetch" href="/myDocsv2/assets/js/195.895d8931.js"><link rel="prefetch" href="/myDocsv2/assets/js/196.a5074835.js"><link rel="prefetch" href="/myDocsv2/assets/js/197.5ac7add8.js"><link rel="prefetch" href="/myDocsv2/assets/js/198.1243e120.js"><link rel="prefetch" href="/myDocsv2/assets/js/199.1dedd774.js"><link rel="prefetch" href="/myDocsv2/assets/js/20.03b1f0ff.js"><link rel="prefetch" href="/myDocsv2/assets/js/200.47677147.js"><link rel="prefetch" href="/myDocsv2/assets/js/201.ae7c32ad.js"><link rel="prefetch" href="/myDocsv2/assets/js/202.b9ab3aba.js"><link rel="prefetch" href="/myDocsv2/assets/js/203.5716a175.js"><link rel="prefetch" href="/myDocsv2/assets/js/204.0dff0870.js"><link rel="prefetch" href="/myDocsv2/assets/js/205.5722c8b0.js"><link rel="prefetch" href="/myDocsv2/assets/js/206.94ecd56d.js"><link rel="prefetch" href="/myDocsv2/assets/js/207.fbef39ad.js"><link rel="prefetch" href="/myDocsv2/assets/js/208.f033c96a.js"><link rel="prefetch" href="/myDocsv2/assets/js/209.b022ee5b.js"><link rel="prefetch" href="/myDocsv2/assets/js/21.2048f6fd.js"><link rel="prefetch" href="/myDocsv2/assets/js/210.c8278e5f.js"><link rel="prefetch" href="/myDocsv2/assets/js/211.df648ec4.js"><link rel="prefetch" href="/myDocsv2/assets/js/212.c591597e.js"><link rel="prefetch" href="/myDocsv2/assets/js/213.59dd0072.js"><link rel="prefetch" href="/myDocsv2/assets/js/214.4250b8d5.js"><link rel="prefetch" href="/myDocsv2/assets/js/215.06bf9012.js"><link rel="prefetch" href="/myDocsv2/assets/js/216.f9f569dc.js"><link rel="prefetch" href="/myDocsv2/assets/js/217.0d90efa0.js"><link rel="prefetch" href="/myDocsv2/assets/js/218.941f9041.js"><link rel="prefetch" href="/myDocsv2/assets/js/219.087abc3e.js"><link rel="prefetch" href="/myDocsv2/assets/js/22.1468e026.js"><link rel="prefetch" href="/myDocsv2/assets/js/220.4519068e.js"><link rel="prefetch" href="/myDocsv2/assets/js/221.020f293f.js"><link rel="prefetch" href="/myDocsv2/assets/js/222.0eabad26.js"><link rel="prefetch" href="/myDocsv2/assets/js/223.ad574537.js"><link rel="prefetch" href="/myDocsv2/assets/js/224.ae6d0b7a.js"><link rel="prefetch" href="/myDocsv2/assets/js/225.8a723b88.js"><link rel="prefetch" href="/myDocsv2/assets/js/226.7285c5f4.js"><link rel="prefetch" href="/myDocsv2/assets/js/227.a14fc969.js"><link rel="prefetch" href="/myDocsv2/assets/js/228.66daebef.js"><link rel="prefetch" href="/myDocsv2/assets/js/229.6403de74.js"><link rel="prefetch" href="/myDocsv2/assets/js/23.e667901e.js"><link rel="prefetch" href="/myDocsv2/assets/js/230.03323ece.js"><link rel="prefetch" href="/myDocsv2/assets/js/231.f3295fcb.js"><link rel="prefetch" href="/myDocsv2/assets/js/232.9c83055f.js"><link rel="prefetch" href="/myDocsv2/assets/js/233.169da2a3.js"><link rel="prefetch" href="/myDocsv2/assets/js/234.2c098527.js"><link rel="prefetch" href="/myDocsv2/assets/js/235.62700dfa.js"><link rel="prefetch" href="/myDocsv2/assets/js/236.f682323d.js"><link rel="prefetch" href="/myDocsv2/assets/js/237.60773b74.js"><link rel="prefetch" href="/myDocsv2/assets/js/238.fb376db3.js"><link rel="prefetch" href="/myDocsv2/assets/js/239.21fe9787.js"><link rel="prefetch" href="/myDocsv2/assets/js/24.18db0e43.js"><link rel="prefetch" href="/myDocsv2/assets/js/240.412b1fd5.js"><link rel="prefetch" href="/myDocsv2/assets/js/241.eb5e205b.js"><link rel="prefetch" href="/myDocsv2/assets/js/242.1b505ffe.js"><link rel="prefetch" href="/myDocsv2/assets/js/243.07e81cfd.js"><link rel="prefetch" href="/myDocsv2/assets/js/244.82c529d0.js"><link rel="prefetch" href="/myDocsv2/assets/js/245.c3458778.js"><link rel="prefetch" href="/myDocsv2/assets/js/246.66e98887.js"><link rel="prefetch" href="/myDocsv2/assets/js/247.1a0993dd.js"><link rel="prefetch" href="/myDocsv2/assets/js/248.a63069b1.js"><link rel="prefetch" href="/myDocsv2/assets/js/249.dd372d75.js"><link rel="prefetch" href="/myDocsv2/assets/js/25.285160e4.js"><link rel="prefetch" href="/myDocsv2/assets/js/250.eb634570.js"><link rel="prefetch" href="/myDocsv2/assets/js/251.f04a5705.js"><link rel="prefetch" href="/myDocsv2/assets/js/252.6ad19080.js"><link rel="prefetch" href="/myDocsv2/assets/js/253.dd154571.js"><link rel="prefetch" href="/myDocsv2/assets/js/254.230b3e5e.js"><link rel="prefetch" href="/myDocsv2/assets/js/255.d40d9e7e.js"><link rel="prefetch" href="/myDocsv2/assets/js/256.28281885.js"><link rel="prefetch" href="/myDocsv2/assets/js/257.6298bda8.js"><link rel="prefetch" href="/myDocsv2/assets/js/258.2fefa56c.js"><link rel="prefetch" href="/myDocsv2/assets/js/259.cb5aea63.js"><link rel="prefetch" href="/myDocsv2/assets/js/26.fae61a7f.js"><link rel="prefetch" href="/myDocsv2/assets/js/260.b29da0f4.js"><link rel="prefetch" href="/myDocsv2/assets/js/261.3db0aa59.js"><link rel="prefetch" href="/myDocsv2/assets/js/262.0b3015b0.js"><link rel="prefetch" href="/myDocsv2/assets/js/263.7577edc3.js"><link rel="prefetch" href="/myDocsv2/assets/js/264.5ff38add.js"><link rel="prefetch" href="/myDocsv2/assets/js/265.e339901e.js"><link rel="prefetch" href="/myDocsv2/assets/js/266.a2027a85.js"><link rel="prefetch" href="/myDocsv2/assets/js/267.08188cb1.js"><link rel="prefetch" href="/myDocsv2/assets/js/268.d30558f8.js"><link rel="prefetch" href="/myDocsv2/assets/js/269.aa62020a.js"><link rel="prefetch" href="/myDocsv2/assets/js/27.b1a4cdea.js"><link rel="prefetch" href="/myDocsv2/assets/js/270.56fe4e52.js"><link rel="prefetch" href="/myDocsv2/assets/js/271.4dbe5ca9.js"><link rel="prefetch" href="/myDocsv2/assets/js/272.ebb4279a.js"><link rel="prefetch" href="/myDocsv2/assets/js/273.82120a56.js"><link rel="prefetch" href="/myDocsv2/assets/js/274.409c4f82.js"><link rel="prefetch" href="/myDocsv2/assets/js/275.b1030128.js"><link rel="prefetch" href="/myDocsv2/assets/js/276.e35f1ba0.js"><link rel="prefetch" href="/myDocsv2/assets/js/277.78b42eab.js"><link rel="prefetch" href="/myDocsv2/assets/js/278.1d224e38.js"><link rel="prefetch" href="/myDocsv2/assets/js/279.5c7dd3ae.js"><link rel="prefetch" href="/myDocsv2/assets/js/28.e9c369f8.js"><link rel="prefetch" href="/myDocsv2/assets/js/280.07aa017e.js"><link rel="prefetch" href="/myDocsv2/assets/js/281.dcb43aec.js"><link rel="prefetch" href="/myDocsv2/assets/js/282.22bc522a.js"><link rel="prefetch" href="/myDocsv2/assets/js/283.c8474c90.js"><link rel="prefetch" href="/myDocsv2/assets/js/284.581fa5ab.js"><link rel="prefetch" href="/myDocsv2/assets/js/285.208c4406.js"><link rel="prefetch" href="/myDocsv2/assets/js/286.5e6c6df0.js"><link rel="prefetch" href="/myDocsv2/assets/js/287.acef2acc.js"><link rel="prefetch" href="/myDocsv2/assets/js/288.ae3f5d32.js"><link rel="prefetch" href="/myDocsv2/assets/js/289.039c32e1.js"><link rel="prefetch" href="/myDocsv2/assets/js/29.a3644474.js"><link rel="prefetch" href="/myDocsv2/assets/js/290.80dfce69.js"><link rel="prefetch" href="/myDocsv2/assets/js/291.9396076f.js"><link rel="prefetch" href="/myDocsv2/assets/js/292.aafda658.js"><link rel="prefetch" href="/myDocsv2/assets/js/293.9d432ff9.js"><link rel="prefetch" href="/myDocsv2/assets/js/294.9bd1328b.js"><link rel="prefetch" href="/myDocsv2/assets/js/295.272f5c7a.js"><link rel="prefetch" href="/myDocsv2/assets/js/296.0cc8fe44.js"><link rel="prefetch" href="/myDocsv2/assets/js/297.67a972ae.js"><link rel="prefetch" href="/myDocsv2/assets/js/298.9d16d98c.js"><link rel="prefetch" href="/myDocsv2/assets/js/299.0f04c0eb.js"><link rel="prefetch" href="/myDocsv2/assets/js/30.b5a32504.js"><link rel="prefetch" href="/myDocsv2/assets/js/300.d4e215e6.js"><link rel="prefetch" href="/myDocsv2/assets/js/301.60d51efc.js"><link rel="prefetch" href="/myDocsv2/assets/js/302.abb371d9.js"><link rel="prefetch" href="/myDocsv2/assets/js/303.b22b36ac.js"><link rel="prefetch" href="/myDocsv2/assets/js/304.3261e7b2.js"><link rel="prefetch" href="/myDocsv2/assets/js/305.807e25af.js"><link rel="prefetch" href="/myDocsv2/assets/js/306.fe10f19e.js"><link rel="prefetch" href="/myDocsv2/assets/js/307.9f74b43c.js"><link rel="prefetch" href="/myDocsv2/assets/js/308.b8c9f8e6.js"><link rel="prefetch" href="/myDocsv2/assets/js/309.1e5c14f9.js"><link rel="prefetch" href="/myDocsv2/assets/js/31.12707513.js"><link rel="prefetch" href="/myDocsv2/assets/js/310.911f38ce.js"><link rel="prefetch" href="/myDocsv2/assets/js/311.3940d290.js"><link rel="prefetch" href="/myDocsv2/assets/js/312.af9de452.js"><link rel="prefetch" href="/myDocsv2/assets/js/313.e10357a1.js"><link rel="prefetch" href="/myDocsv2/assets/js/314.8d732c56.js"><link rel="prefetch" href="/myDocsv2/assets/js/315.97345578.js"><link rel="prefetch" href="/myDocsv2/assets/js/316.5de46f5d.js"><link rel="prefetch" href="/myDocsv2/assets/js/317.ecbaee88.js"><link rel="prefetch" href="/myDocsv2/assets/js/318.f16657b3.js"><link rel="prefetch" href="/myDocsv2/assets/js/319.e9fc2b8b.js"><link rel="prefetch" href="/myDocsv2/assets/js/32.4794eb28.js"><link rel="prefetch" href="/myDocsv2/assets/js/320.87a080c9.js"><link rel="prefetch" href="/myDocsv2/assets/js/321.dc421947.js"><link rel="prefetch" href="/myDocsv2/assets/js/322.0d8f158f.js"><link rel="prefetch" href="/myDocsv2/assets/js/323.9feb5296.js"><link rel="prefetch" href="/myDocsv2/assets/js/324.11b428d5.js"><link rel="prefetch" href="/myDocsv2/assets/js/325.51e26ebb.js"><link rel="prefetch" href="/myDocsv2/assets/js/326.d7c9128a.js"><link rel="prefetch" href="/myDocsv2/assets/js/327.d2a1a3da.js"><link rel="prefetch" href="/myDocsv2/assets/js/328.f3119b29.js"><link rel="prefetch" href="/myDocsv2/assets/js/329.01ae2bb1.js"><link rel="prefetch" href="/myDocsv2/assets/js/33.7e8c531c.js"><link rel="prefetch" href="/myDocsv2/assets/js/330.757b5be7.js"><link rel="prefetch" href="/myDocsv2/assets/js/331.335622c4.js"><link rel="prefetch" href="/myDocsv2/assets/js/332.79b5dfeb.js"><link rel="prefetch" href="/myDocsv2/assets/js/333.b5bff6cd.js"><link rel="prefetch" href="/myDocsv2/assets/js/334.b4e9badb.js"><link rel="prefetch" href="/myDocsv2/assets/js/335.aed5ff57.js"><link rel="prefetch" href="/myDocsv2/assets/js/336.14ce19b1.js"><link rel="prefetch" href="/myDocsv2/assets/js/337.f0e871b6.js"><link rel="prefetch" href="/myDocsv2/assets/js/338.ba74f399.js"><link rel="prefetch" href="/myDocsv2/assets/js/339.e308e875.js"><link rel="prefetch" href="/myDocsv2/assets/js/34.76ac76e5.js"><link rel="prefetch" href="/myDocsv2/assets/js/340.8afe9761.js"><link rel="prefetch" href="/myDocsv2/assets/js/341.5f7f2739.js"><link rel="prefetch" href="/myDocsv2/assets/js/342.856b7535.js"><link rel="prefetch" href="/myDocsv2/assets/js/343.b71213f5.js"><link rel="prefetch" href="/myDocsv2/assets/js/344.4e9b4c16.js"><link rel="prefetch" href="/myDocsv2/assets/js/345.fde23f4c.js"><link rel="prefetch" href="/myDocsv2/assets/js/346.20b96938.js"><link rel="prefetch" href="/myDocsv2/assets/js/347.476680bb.js"><link rel="prefetch" href="/myDocsv2/assets/js/348.ecf44b79.js"><link rel="prefetch" href="/myDocsv2/assets/js/349.19235284.js"><link rel="prefetch" href="/myDocsv2/assets/js/35.b761363a.js"><link rel="prefetch" href="/myDocsv2/assets/js/350.42e4d37c.js"><link rel="prefetch" href="/myDocsv2/assets/js/351.6982f677.js"><link rel="prefetch" href="/myDocsv2/assets/js/352.f17e6bce.js"><link rel="prefetch" href="/myDocsv2/assets/js/353.2be51bc7.js"><link rel="prefetch" href="/myDocsv2/assets/js/354.77f5d2fb.js"><link rel="prefetch" href="/myDocsv2/assets/js/355.f6285383.js"><link rel="prefetch" href="/myDocsv2/assets/js/356.94418b9f.js"><link rel="prefetch" href="/myDocsv2/assets/js/357.b8b20e21.js"><link rel="prefetch" href="/myDocsv2/assets/js/358.1b2e896c.js"><link rel="prefetch" href="/myDocsv2/assets/js/36.34a14d0e.js"><link rel="prefetch" href="/myDocsv2/assets/js/37.aa4916db.js"><link rel="prefetch" href="/myDocsv2/assets/js/38.deb490d2.js"><link rel="prefetch" href="/myDocsv2/assets/js/39.8672f15d.js"><link rel="prefetch" href="/myDocsv2/assets/js/40.644dee16.js"><link rel="prefetch" href="/myDocsv2/assets/js/41.1b06014c.js"><link rel="prefetch" href="/myDocsv2/assets/js/42.e7ff72f1.js"><link rel="prefetch" href="/myDocsv2/assets/js/43.02a62ac3.js"><link rel="prefetch" href="/myDocsv2/assets/js/44.cd8672e0.js"><link rel="prefetch" href="/myDocsv2/assets/js/45.02596789.js"><link rel="prefetch" href="/myDocsv2/assets/js/46.a1c40368.js"><link rel="prefetch" href="/myDocsv2/assets/js/47.8d8b2f4d.js"><link rel="prefetch" href="/myDocsv2/assets/js/48.5dadf9f0.js"><link rel="prefetch" href="/myDocsv2/assets/js/49.ea5bbb89.js"><link rel="prefetch" href="/myDocsv2/assets/js/50.ad180d98.js"><link rel="prefetch" href="/myDocsv2/assets/js/51.0df9f4e8.js"><link rel="prefetch" href="/myDocsv2/assets/js/52.f04a6e1b.js"><link rel="prefetch" href="/myDocsv2/assets/js/53.74f2f2cf.js"><link rel="prefetch" href="/myDocsv2/assets/js/55.79a1b789.js"><link rel="prefetch" href="/myDocsv2/assets/js/56.693e099d.js"><link rel="prefetch" href="/myDocsv2/assets/js/57.82c7c63a.js"><link rel="prefetch" href="/myDocsv2/assets/js/58.15dea23c.js"><link rel="prefetch" href="/myDocsv2/assets/js/59.63d66b63.js"><link rel="prefetch" href="/myDocsv2/assets/js/6.97e7a4cb.js"><link rel="prefetch" href="/myDocsv2/assets/js/60.80a3efc6.js"><link rel="prefetch" href="/myDocsv2/assets/js/61.3f648458.js"><link rel="prefetch" href="/myDocsv2/assets/js/62.991be8f4.js"><link rel="prefetch" href="/myDocsv2/assets/js/63.c70d0dfb.js"><link rel="prefetch" href="/myDocsv2/assets/js/64.cbfa33ab.js"><link rel="prefetch" href="/myDocsv2/assets/js/65.f89bbfb7.js"><link rel="prefetch" href="/myDocsv2/assets/js/66.70c68ea1.js"><link rel="prefetch" href="/myDocsv2/assets/js/67.27436099.js"><link rel="prefetch" href="/myDocsv2/assets/js/68.6c730d30.js"><link rel="prefetch" href="/myDocsv2/assets/js/69.31e87a96.js"><link rel="prefetch" href="/myDocsv2/assets/js/7.b469f62b.js"><link rel="prefetch" href="/myDocsv2/assets/js/70.66a0fe4e.js"><link rel="prefetch" href="/myDocsv2/assets/js/71.150be7fc.js"><link rel="prefetch" href="/myDocsv2/assets/js/72.a2b6c89a.js"><link rel="prefetch" href="/myDocsv2/assets/js/73.65559007.js"><link rel="prefetch" href="/myDocsv2/assets/js/74.f61e2991.js"><link rel="prefetch" href="/myDocsv2/assets/js/75.fde71997.js"><link rel="prefetch" href="/myDocsv2/assets/js/76.cf3d3a31.js"><link rel="prefetch" href="/myDocsv2/assets/js/77.36633bd8.js"><link rel="prefetch" href="/myDocsv2/assets/js/78.82d49b8f.js"><link rel="prefetch" href="/myDocsv2/assets/js/79.6c213d15.js"><link rel="prefetch" href="/myDocsv2/assets/js/8.ebe4b359.js"><link rel="prefetch" href="/myDocsv2/assets/js/80.e6ee5654.js"><link rel="prefetch" href="/myDocsv2/assets/js/81.2d6febe8.js"><link rel="prefetch" href="/myDocsv2/assets/js/82.b1d7c015.js"><link rel="prefetch" href="/myDocsv2/assets/js/83.e4d15d98.js"><link rel="prefetch" href="/myDocsv2/assets/js/84.98d75c07.js"><link rel="prefetch" href="/myDocsv2/assets/js/85.8bd12af2.js"><link rel="prefetch" href="/myDocsv2/assets/js/86.3bc59854.js"><link rel="prefetch" href="/myDocsv2/assets/js/87.c26415ef.js"><link rel="prefetch" href="/myDocsv2/assets/js/88.12cc1dae.js"><link rel="prefetch" href="/myDocsv2/assets/js/89.1e08c26e.js"><link rel="prefetch" href="/myDocsv2/assets/js/9.bd9ef1a2.js"><link rel="prefetch" href="/myDocsv2/assets/js/90.4d879007.js"><link rel="prefetch" href="/myDocsv2/assets/js/91.089c1c17.js"><link rel="prefetch" href="/myDocsv2/assets/js/92.5aec83b9.js"><link rel="prefetch" href="/myDocsv2/assets/js/93.efe44a21.js"><link rel="prefetch" href="/myDocsv2/assets/js/94.ffc75f13.js"><link rel="prefetch" href="/myDocsv2/assets/js/95.d2012256.js"><link rel="prefetch" href="/myDocsv2/assets/js/96.87fef0cb.js"><link rel="prefetch" href="/myDocsv2/assets/js/97.aae1fc0b.js"><link rel="prefetch" href="/myDocsv2/assets/js/98.5f33b8aa.js"><link rel="prefetch" href="/myDocsv2/assets/js/99.f3fbb5db.js"><link rel="prefetch" href="/myDocsv2/assets/js/vendors~flowchart.f05697d3.js">
    <link rel="stylesheet" href="/myDocsv2/assets/css/0.styles.21bb8301.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container" data-v-584a622c><div data-v-584a622c><div id="loader-wrapper" class="loading-wrapper" data-v-1c4f0192 data-v-584a622c data-v-584a622c><div class="loader-main" data-v-1c4f0192><div data-v-1c4f0192></div><div data-v-1c4f0192></div><div data-v-1c4f0192></div><div data-v-1c4f0192></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-73c95a87 data-v-584a622c data-v-584a622c><h3 class="title" style="display:none;" data-v-73c95a87 data-v-73c95a87>AGou's Docs-v2</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-73c95a87 data-v-73c95a87><input type="password" value="" data-v-73c95a87> <span data-v-73c95a87>Konck! Knock!</span> <button data-v-73c95a87>OK</button></label> <div class="footer" style="display:none;" data-v-73c95a87 data-v-73c95a87><span data-v-73c95a87><i class="iconfont reco-theme" data-v-73c95a87></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-73c95a87>vuePress-theme-reco</a></span> <span data-v-73c95a87><i class="iconfont reco-copyright" data-v-73c95a87></i> <a data-v-73c95a87><span data-v-73c95a87>AGou-ops</span>
          Â Â 
          <!---->
          2022
        </a></span></div></div> <div class="hide" data-v-584a622c><header class="navbar" data-v-584a622c><div title="å¯¼èˆª" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myDocsv2/" class="home-link router-link-active"><img src="/myDocsv2/favicon.png" alt="AGou's Docs-v2" class="logo"> <span class="site-name">AGou's Docs-v2</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myDocsv2/timeline/" class="nav-link"><i class="iconfont undefined"></i>
  ğŸ•Ÿæ—¶é—´çº¿
</a></div><div class="nav-item"><a href="/myDocsv2/" class="nav-link"><i class="iconfont undefined"></i>
  ğŸ Home
</a></div><div class="nav-item"><a href="/myDocsv2/guide/" class="nav-link"><i class="iconfont undefined"></i>
  ğŸ—ºï¸Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      ğŸ“„å…¶å®ƒ
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myDocsv2/Golang/" class="nav-link"><i class="iconfont undefined"></i>
  ğŸ“šGolang
</a></li><li class="dropdown-item"><!----> <a href="/myDocsv2/k8s/" class="nav-link router-link-active"><i class="iconfont undefined"></i>
  ğŸš¢K8s
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      ç‰ˆæœ¬
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://agou-ops.cn/myDocs" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  ver 1.0
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://agou-ops.cn/myDocsv2" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  ver 2.0
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://agou-ops.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  âœ¨myBlog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/AGou-ops/myDocsv2" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask" data-v-584a622c></div> <aside class="sidebar" data-v-584a622c><div class="personal-info-wrapper" data-v-7e653f02><img src="/myDocsv2/favicon.png" alt="author-avatar" class="personal-img" data-v-7e653f02> <h3 class="name" data-v-7e653f02>
    AGou-ops
  </h3> <div class="num" data-v-7e653f02><div data-v-7e653f02><h3 data-v-7e653f02>2</h3> <h6 data-v-7e653f02>æ–‡ç« </h6></div> <div data-v-7e653f02><h3 data-v-7e653f02>1</h3> <h6 data-v-7e653f02>æ ‡ç­¾</h6></div></div> <hr data-v-7e653f02></div> <nav class="nav-links"><div class="nav-item"><a href="/myDocsv2/timeline/" class="nav-link"><i class="iconfont undefined"></i>
  ğŸ•Ÿæ—¶é—´çº¿
</a></div><div class="nav-item"><a href="/myDocsv2/" class="nav-link"><i class="iconfont undefined"></i>
  ğŸ Home
</a></div><div class="nav-item"><a href="/myDocsv2/guide/" class="nav-link"><i class="iconfont undefined"></i>
  ğŸ—ºï¸Guide
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      ğŸ“„å…¶å®ƒ
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myDocsv2/Golang/" class="nav-link"><i class="iconfont undefined"></i>
  ğŸ“šGolang
</a></li><li class="dropdown-item"><!----> <a href="/myDocsv2/k8s/" class="nav-link router-link-active"><i class="iconfont undefined"></i>
  ğŸš¢K8s
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      ç‰ˆæœ¬
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://agou-ops.cn/myDocs" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  ver 1.0
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://agou-ops.cn/myDocsv2" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  ver 2.0
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="https://agou-ops.github.io" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  âœ¨myBlog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/AGou-ops/myDocsv2" target="_blank" rel="noopener noreferrer" class="repo-link"><i class="iconfont reco-github"></i>
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/myDocsv2/k8s/Installation/" class="sidebar-heading clickable"><span>K8s Installation</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/myDocsv2/k8s/å®æˆ˜æ¡ˆä¾‹/" class="sidebar-heading clickable"><span>K8s å®æˆ˜æ¡ˆä¾‹</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/myDocsv2/k8s/Quicklystart/" class="sidebar-heading clickable router-link-active open"><span>k8s å¿«é€Ÿæ‰‹å†Œ</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/myDocsv2/k8s/Quicklystart/ä¸€ Kubernetesæ¦‚è¿°.html" class="sidebar-link">ä¸€ Kubernetesæ¦‚è¿°</a></li><li><a href="/myDocsv2/k8s/Quicklystart/äºŒ æ ¸å¿ƒç»„ä»¶åŠé™„ä»¶.html" class="sidebar-link">äºŒ æ ¸å¿ƒç»„ä»¶åŠé™„ä»¶</a></li><li><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html" class="active sidebar-link">ä¸‰ é›†ç¾¤éƒ¨ç½²</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-1-ä¸€èˆ¬éƒ¨ç½²" class="sidebar-link">3.1 ä¸€èˆ¬éƒ¨ç½²</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-1-1-å…³é—­-firewalld-å’Œ-selinux" class="sidebar-link">3.1.1 å…³é—­ firewalld å’Œ selinux</a></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-1-2-åŠ è½½-ipvs-å†…æ ¸æ¨¡å—" class="sidebar-link">3.1.2 åŠ è½½ ipvs å†…æ ¸æ¨¡å—</a></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-1-3-ä¸‹è½½-docker-å’Œ-k8s" class="sidebar-link">3.1.3 ä¸‹è½½ Docker å’Œ K8S</a></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-1-4-è®¾ç½®å†…æ ¸åŠ-k8s-å‚æ•°" class="sidebar-link">3.1.4 è®¾ç½®å†…æ ¸åŠ K8S å‚æ•°</a></li></ul></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-2-éƒ¨ç½²-master" class="sidebar-link">3.2 éƒ¨ç½² Master</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-2-1-æå‰æ‹‰å–é•œåƒ" class="sidebar-link">3.2.1 æå‰æ‹‰å–é•œåƒ</a></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-2-2-åˆå§‹åŒ–master" class="sidebar-link">3.2.2 åˆå§‹åŒ–Master</a></li></ul></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-3-éƒ¨ç½²-node" class="sidebar-link">3.3 éƒ¨ç½² Node</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-3-1-åŠ å…¥é›†ç¾¤" class="sidebar-link">3.3.1 åŠ å…¥é›†ç¾¤</a></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-3-2-æŸ¥çœ‹è¿›åº¦" class="sidebar-link">3.3.2 æŸ¥çœ‹è¿›åº¦</a></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-3-3-é•œåƒä¸‹è½½å¤ªæ…¢" class="sidebar-link">3.3.3 é•œåƒä¸‹è½½å¤ªæ…¢</a></li></ul></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-4-jioæœ¬éƒ¨ç½²" class="sidebar-link">3.4 jioæœ¬éƒ¨ç½²</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-4-1-é¢„å…ˆå‡†å¤‡" class="sidebar-link">3.4.1 é¢„å…ˆå‡†å¤‡</a></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-4-2-åˆå§‹åŒ–-master-èŠ‚ç‚¹" class="sidebar-link">3.4.2 åˆå§‹åŒ– master èŠ‚ç‚¹</a></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-4-3-åˆå§‹åŒ–-node-èŠ‚ç‚¹" class="sidebar-link">3.4.3 åˆå§‹åŒ– node èŠ‚ç‚¹</a></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-4-4-æ£€æŸ¥åˆå§‹åŒ–ç»“æœ" class="sidebar-link">3.4.4 æ£€æŸ¥åˆå§‹åŒ–ç»“æœ</a></li></ul></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-5-ä½¿ç”¨-kubespray-éƒ¨ç½²" class="sidebar-link">3.5 ä½¿ç”¨ Kubespray éƒ¨ç½²</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-5-1-kubespray-ç®€ä»‹" class="sidebar-link">3.5.1 Kubespray ç®€ä»‹</a></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-5-2-åˆå§‹åŒ–ç¯å¢ƒ" class="sidebar-link">3.5.2 åˆå§‹åŒ–ç¯å¢ƒ</a></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-5-3-å®‰è£…-kubespray" class="sidebar-link">3.5.3 å®‰è£… Kubespray</a></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-5-4-ç™»å½•-dashboard" class="sidebar-link">3.5.4 ç™»å½• Dashboard</a></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-5-5-éªŒè¯-k8s-é›†ç¾¤" class="sidebar-link">3.5.5 éªŒè¯ K8s é›†ç¾¤</a></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#_3-5-6-å…¶ä»–" class="sidebar-link">3.5.6 å…¶ä»–</a></li></ul></li><li class="sidebar-sub-header"><a href="/myDocsv2/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².html#å‚è€ƒé“¾æ¥" class="sidebar-link">å‚è€ƒé“¾æ¥</a></li></ul></li><li><a href="/myDocsv2/k8s/Quicklystart/å›› å…¥é—¨å‘½ä»¤.html" class="sidebar-link">å›› å…¥é—¨å‘½ä»¤</a></li><li><a href="/myDocsv2/k8s/Quicklystart/äº” é…ç½®æ¸…å•ä½¿ç”¨.html" class="sidebar-link">äº” é…ç½®æ¸…å•ä½¿ç”¨</a></li><li><a href="/myDocsv2/k8s/Quicklystart/å…­ POD é…ç½®æ¸…å•.html" class="sidebar-link">å…­ POD é…ç½®æ¸…å•</a></li><li><a href="/myDocsv2/k8s/Quicklystart/ä¸ƒ æ§åˆ¶å™¨é…ç½®æ¸…å•.html" class="sidebar-link">ä¸ƒ æ§åˆ¶å™¨é…ç½®æ¸…å•</a></li><li><a href="/myDocsv2/k8s/Quicklystart/å…« Service é…ç½®æ¸…å•.html" class="sidebar-link">å…« Service é…ç½®æ¸…å•</a></li><li><a href="/myDocsv2/k8s/Quicklystart/ä¹ ingress æ§åˆ¶å™¨.html" class="sidebar-link">ä¹ ingress æ§åˆ¶å™¨</a></li><li><a href="/myDocsv2/k8s/Quicklystart/å POD å­˜å‚¨å·.html" class="sidebar-link">å POD å­˜å‚¨å·</a></li><li><a href="/myDocsv2/k8s/Quicklystart/åä¸€ é…ç½®ä¿¡æ¯å®¹å™¨åŒ–.html" class="sidebar-link">åä¸€ é…ç½®ä¿¡æ¯å®¹å™¨åŒ–</a></li><li><a href="/myDocsv2/k8s/Quicklystart/åäºŒ StatefulSet æ§åˆ¶å™¨.html" class="sidebar-link">åäºŒ StatefulSet æ§åˆ¶å™¨</a></li><li><a href="/myDocsv2/k8s/Quicklystart/åä¸‰ ç”¨æˆ·è®¤è¯ç³»ç»Ÿ.html" class="sidebar-link">åä¸‰ ç”¨æˆ·è®¤è¯ç³»ç»Ÿ</a></li><li><a href="/myDocsv2/k8s/Quicklystart/åå›› ç”¨æˆ·æƒé™ç³»ç»Ÿ.html" class="sidebar-link">åå›› ç”¨æˆ·æƒé™ç³»ç»Ÿ</a></li><li><a href="/myDocsv2/k8s/Quicklystart/åäº” dashboard.html" class="sidebar-link">åäº” dashboard</a></li><li><a href="/myDocsv2/k8s/Quicklystart/åå…­ ç½‘ç»œé€šä¿¡.html" class="sidebar-link">åå…­ ç½‘ç»œé€šä¿¡</a></li><li><a href="/myDocsv2/k8s/Quicklystart/åä¸ƒ è°ƒåº¦ç­–ç•¥.html" class="sidebar-link">åä¸ƒ è°ƒåº¦ç­–ç•¥</a></li><li><a href="/myDocsv2/k8s/Quicklystart/åå…« é«˜çº§è°ƒåº¦è®¾ç½®.html" class="sidebar-link">åå…« é«˜çº§è°ƒåº¦è®¾ç½®</a></li><li><a href="/myDocsv2/k8s/Quicklystart/åä¹ å®¹å™¨èµ„æºé™åˆ¶.html" class="sidebar-link">åä¹ å®¹å™¨èµ„æºé™åˆ¶</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/myDocsv2/k8s/Helm/" class="sidebar-heading clickable"><span>Helm</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group depth-0"><a href="/myDocsv2/k8s/" class="sidebar-heading clickable router-link-active"><span>Others</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/myDocsv2/k8s/Kubernetes Yaml quicklystart.html" class="sidebar-link">â­k8s Yaml quicklystart</a></li><li><a href="/myDocsv2/k8s/k8s command.html" class="sidebar-link">â­k8s command quicklystart</a></li><li><a href="/myDocsv2/k8s/Kubernetes with Jenkins CICD.html" class="sidebar-link">Kubernetes with Jenkins CICD</a></li><li><a href="/myDocsv2/k8s/Prometheus+Grafanaå…¨æ–¹ä½ç›‘æ§Kubernetesé›†ç¾¤.html" class="sidebar-link">Prometheus+Grafanaå…¨æ–¹ä½ç›‘æ§Kubernetesé›†ç¾¤</a></li><li><a href="/myDocsv2/k8s/kompose Basic.html" class="sidebar-link">kompose Basic</a></li><li><a href="/myDocsv2/k8s/kubenetesè¿œç¨‹è°ƒè¯•å·¥å…·.html" class="sidebar-link">kubenetesè¿œç¨‹è°ƒè¯•å·¥å…·</a></li><li><a href="/myDocsv2/k8s/Kubernetes REST API.html" class="sidebar-link">Kubernetes REST API</a></li><li><a href="/myDocsv2/k8s/k3d.html" class="sidebar-link">k3d</a></li><li><a href="/myDocsv2/k8s/Minikube Basic.html" class="sidebar-link">Minikube Basic</a></li><li><a href="/myDocsv2/k8s/Remote access k8s.html" class="sidebar-link">Remote access k8s</a></li><li><a href="/myDocsv2/k8s/k8s å›¾è§£å¤§å…¨.html" class="sidebar-link">k8s å›¾è§£å¤§å…¨</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-73c95a87 data-v-584a622c><h3 class="title" style="display:none;" data-v-73c95a87 data-v-73c95a87></h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-73c95a87 data-v-73c95a87><input type="password" value="" data-v-73c95a87> <span data-v-73c95a87>Konck! Knock!</span> <button data-v-73c95a87>OK</button></label> <div class="footer" style="display:none;" data-v-73c95a87 data-v-73c95a87><span data-v-73c95a87><i class="iconfont reco-theme" data-v-73c95a87></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-73c95a87>vuePress-theme-reco</a></span> <span data-v-73c95a87><i class="iconfont reco-copyright" data-v-73c95a87></i> <a data-v-73c95a87><span data-v-73c95a87>AGou-ops</span>
          Â Â 
          <!---->
          2022
        </a></span></div></div> <div data-v-584a622c><main class="page"><!----> <div class="page-title" style="display:none;"><h1>ä¸‰ é›†ç¾¤éƒ¨ç½²</h1> <hr> <div data-v-7b2e794a><i class="iconfont reco-account" data-v-7b2e794a><span data-v-7b2e794a>AGou-ops</span></i> <!----> <i class="iconfont reco-eye" data-v-7b2e794a><span id="/myDocsv2/k8s/Quicklystart/%E4%B8%89%20%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-7b2e794a><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <!----></div></div> <div class="theme-reco-content content__default" style="display:none;"><h1 id="ä¸‰-é›†ç¾¤éƒ¨ç½²"><a href="#ä¸‰-é›†ç¾¤éƒ¨ç½²" class="header-anchor">#</a> ä¸‰ é›†ç¾¤éƒ¨ç½²</h1> <p>ä¸ºç®€å•ä¸Šæ‰‹ä½“éªŒåŠŸèƒ½ï¼Œå¯ä»¥å…ˆåˆ©ç”¨kubeadmå®‰è£…æµ‹è¯•ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®äºŒè¿›åˆ¶æˆ–è€…ä¸€äº›æˆç†Ÿçš„é›†ç¾¤é«˜å¯ç”¨å®‰è£…æ–¹å¼ï¼ŒKubeadm æ˜¯ K8S å®˜æ–¹æä¾›çš„å¿«é€Ÿéƒ¨ç½²å·¥å…·ï¼Œå®ƒæä¾›äº† kubeadm init ä»¥åŠ kubeadm join è¿™ä¸¤ä¸ªå‘½ä»¤ä½œä¸ºå¿«é€Ÿåˆ›å»º kubernetes é›†ç¾¤çš„æœ€ä½³å®è·µï¼Œæœ¬ç« èŠ‚è¯´æ˜äº†ä½¿ç”¨ kubeadm æ¥éƒ¨ç½² K8S é›†ç¾¤çš„è¿‡ç¨‹ã€‚</p> <ul><li>é›†ç¾¤ç»„ç»‡ç»“æ„</li></ul> <table><thead><tr><th>é¡¹ç›®</th> <th>è¯´æ˜</th></tr></thead> <tbody><tr><td>é›†ç¾¤è§„æ¨¡</td> <td>Masterã€node1ã€node2</td></tr> <tr><td>ç³»ç»Ÿ</td> <td>CentOS 7.3</td></tr> <tr><td>ç½‘ç»œè§„åˆ’</td> <td>PODï¼š10.244.0.0/16ã€Serviceï¼š10.96.0.0/12</td></tr></tbody></table> <h2 id="_3-1-ä¸€èˆ¬éƒ¨ç½²"><a href="#_3-1-ä¸€èˆ¬éƒ¨ç½²" class="header-anchor">#</a> 3.1 ä¸€èˆ¬éƒ¨ç½²</h2> <blockquote><p>æœ¬å°èŠ‚çš„æ‰€æœ‰çš„æ“ä½œï¼Œåœ¨æ‰€æœ‰çš„èŠ‚ç‚¹ä¸Šè¿›è¡Œ</p></blockquote> <h3 id="_3-1-1-å…³é—­-firewalld-å’Œ-selinux"><a href="#_3-1-1-å…³é—­-firewalld-å’Œ-selinux" class="header-anchor">#</a> 3.1.1 å…³é—­ firewalld å’Œ selinux</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>setenforce <span class="token number">0</span>
<span class="token function">sed</span> -i <span class="token string">'/^SELINUX=/cSELINUX=disabled'</span> /etc/selinux/config

systemctl stop firewalld
systemctl disable firewalld
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_3-1-2-åŠ è½½-ipvs-å†…æ ¸æ¨¡å—"><a href="#_3-1-2-åŠ è½½-ipvs-å†…æ ¸æ¨¡å—" class="header-anchor">#</a> 3.1.2 åŠ è½½ ipvs å†…æ ¸æ¨¡å—</h3> <ul><li>å®‰è£… IPVS æ¨¡å—</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yum -y <span class="token function">install</span> ipvsadm ipset sysstat conntrack libseccomp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>è®¾ç½®å¼€æœºåŠ è½½é…ç½®æ–‡ä»¶</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&gt;&gt;</span>/etc/modules-load.d/ipvs.conf<span class="token operator">&lt;&lt;</span><span class="token string">EOF
ip_vs_dh
ip_vs_ftp
ip_vs
ip_vs_lblc
ip_vs_lblcr
ip_vs_lc
ip_vs_nq
ip_vs_pe_sip
ip_vs_rr
ip_vs_sed
ip_vs_sh
ip_vs_wlc
ip_vs_wrr
nf_conntrack_ipv4
EOF</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li>è®¾ç½®å¼€æœºåŠ è½½ IPVS æ¨¡å—</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>systemctl <span class="token builtin class-name">enable</span> systemd-modules-load.service   <span class="token comment"># è®¾ç½®å¼€æœºåŠ è½½å†…æ ¸æ¨¡å—</span>
lsmod <span class="token operator">|</span> <span class="token function">grep</span> -e ip_vs -e nf_conntrack_ipv4      <span class="token comment"># é‡å¯åæ£€æŸ¥ ipvs æ¨¡å—æ˜¯å¦åŠ è½½</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>å¦‚æœé›†ç¾¤å·²ç»éƒ¨ç½²åœ¨äº† iptables æ¨¡å¼ä¸‹ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢å‘½ä»¤ä¿®æ”¹ï¼Œä¿®æ”¹ mode ä¸º ipvs é‡å¯é›†ç¾¤å³å¯ã€‚</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl edit -n kube-system configmap kube-proxy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_3-1-3-ä¸‹è½½-docker-å’Œ-k8s"><a href="#_3-1-3-ä¸‹è½½-docker-å’Œ-k8s" class="header-anchor">#</a> 3.1.3 ä¸‹è½½ Docker å’Œ K8S</h3> <ul><li>è®¾ç½® docker æº</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">curl</span> -o /etc/yum.repos.d/docker-ce.repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>è®¾ç½® k8s æº</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&gt;&gt;</span>/etc/yum.repos.d/kuberetes.repo<span class="token operator">&lt;&lt;</span><span class="token string">EOF
[kuberneres]
name=Kubernetes
baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/
gpgcheck=0
gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg
enabled=1
EOF</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>å®‰è£… docker-ce å’Œ kubernetes</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yum <span class="token function">install</span> docker-ce kubelet kubectl kubeadm -y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>systemctl start <span class="token function">docker</span>
systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span>
systemctl <span class="token builtin class-name">enable</span> kubelet
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_3-1-4-è®¾ç½®å†…æ ¸åŠ-k8s-å‚æ•°"><a href="#_3-1-4-è®¾ç½®å†…æ ¸åŠ-k8s-å‚æ•°" class="header-anchor">#</a> 3.1.4 è®¾ç½®å†…æ ¸åŠ K8S å‚æ•°</h3> <ul><li>è®¾ç½®å†…æ ¸å‚æ•°</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&gt;&gt;</span>/etc/sysctl.conf<span class="token operator">&lt;&lt;</span><span class="token string">EOF
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
net.ipv4.ip_forward = 1
EOF</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>è®¾ç½® kubelet å¿½ç•¥ swapï¼Œä½¿ç”¨ ipvs</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&gt;</span>/etc/sysconfig/kubelet<span class="token operator">&lt;&lt;</span><span class="token string">EOF
KUBELET_EXTRA_ARGS=&quot;--fail-swap-on=false&quot;
KUBE_PROXY_MODE=ipvs
EOF</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_3-2-éƒ¨ç½²-master"><a href="#_3-2-éƒ¨ç½²-master" class="header-anchor">#</a> 3.2 éƒ¨ç½² Master</h2> <blockquote><p>æœ¬å°èŠ‚çš„æ‰€æœ‰çš„æ“ä½œï¼Œåªåœ¨ Master èŠ‚ç‚¹ä¸Šè¿›è¡Œ</p></blockquote> <h3 id="_3-2-1-æå‰æ‹‰å–é•œåƒ"><a href="#_3-2-1-æå‰æ‹‰å–é•œåƒ" class="header-anchor">#</a> 3.2.1 æå‰æ‹‰å–é•œåƒ</h3> <p>å®¿ä¸»æœºæœ€å¥½èƒ½è®¿é—®å›½å¤–èµ„æºï¼Œåœ¨kubeadm init åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¼šåˆ°è°·æ­Œçš„ docker hub æ‹‰å–é•œåƒï¼Œå¦‚æœå®¿ä¸»æœºæµ‹è¯•æ— æ³•è®¿é—® k8s.gcr.io å¯ä»¥åœ¨æœåŠ¡å™¨æ‰€ä»¥æˆ‘ä»¬è¦æå‰éƒ¨ç½²å¥½ä»£ç†è½¯ä»¶ï¼Œæœ¬ä¾‹ä¸­ç›‘å¬ä¸ªæœ¬æœº 9666 è¿›è¡Œéƒ¨ç½²ã€‚</p> <p>å¦‚æœæ¡ä»¶ä¸å…è®¸å¯ä»¥å‚è€ƒ: https://blog.csdn.net/jinguangliu/article/details/82792617 æ¥è§£å†³é•œåƒé—®é¢˜ã€‚</p> <ul><li>é…ç½® Docker æ‹‰å–é•œåƒæ—¶å€™çš„ä»£ç†åœ°å€ï¼Œvim /usr/lib/systemd/system/docker.serviceã€‚</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Environment</span><span class="token operator">=</span><span class="token string">&quot;HTTPS_PROXY=127.0.0.1:9666&quot;</span>
<span class="token assign-left variable">Environment</span><span class="token operator">=</span><span class="token string">&quot;NO_PROXY=127.0.0.0/8,172.16.0.0/16&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>æå‰æ‹‰å–åˆå§‹åŒ–éœ€è¦çš„é•œåƒ</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubeadm config images pull
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>ä½¿ç”¨å…¶ä»–æºé•œåƒ</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> pull mirrorgooglecontainers/kube-apiserver:v1.14.2
<span class="token function">docker</span> pull mirrorgooglecontainers/kube-controller-manager:v1.14.2
<span class="token function">docker</span> pull mirrorgooglecontainers/kube-scheduler:v1.14.2
<span class="token function">docker</span> pull mirrorgooglecontainers/kube-proxy:v1.14.2
<span class="token function">docker</span> pull mirrorgooglecontainers/pause:3.1
<span class="token function">docker</span> pull mirrorgooglecontainers/etcd:3.3.10
<span class="token function">docker</span> pull coredns/coredns:1.3.1


åˆ©ç”¨<span class="token variable"><span class="token variable">`</span>kubeadm config images list<span class="token variable">`</span></span> æŸ¥çœ‹éœ€è¦çš„docker image name

k8s.gcr.io/kube-apiserver:v1.14.2
k8s.gcr.io/kube-controller-manager:v1.14.2
k8s.gcr.io/kube-scheduler:v1.14.2
k8s.gcr.io/kube-proxy:v1.14.2
k8s.gcr.io/pause:3.1
k8s.gcr.io/etcd:3.3.10
k8s.gcr.io/coredns:1.3.1

<span class="token comment"># ä¿®æ”¹tag</span>

<span class="token function">docker</span> tag docker.io/mirrorgooglecontainers/kube-apiserver:v1.14.2 k8s.gcr.io/kube-apiserver:v1.14.2
<span class="token function">docker</span> tag docker.io/mirrorgooglecontainers/kube-scheduler:v1.14.2 k8s.gcr.io/kube-scheduler:v1.14.2
<span class="token function">docker</span> tag docker.io/mirrorgooglecontainers/kube-proxy:v1.14.2 k8s.gcr.io/kube-proxy:v1.14.2
<span class="token function">docker</span> tag docker.io/mirrorgooglecontainers/kube-controller-manager:v1.14.2 k8s.gcr.io/kube-controller-manager:v1.14.2
<span class="token function">docker</span> tag docker.io/mirrorgooglecontainers/etcd:3.3.10  k8s.gcr.io/etcd:3.3.10
<span class="token function">docker</span> tag docker.io/mirrorgooglecontainers/pause:3.1  k8s.gcr.io/pause:3.1
<span class="token function">docker</span> tag docker.io/coredns/coredns:1.3.1  k8s.gcr.io/coredns:1.3.1

<span class="token function">docker</span> rmi <span class="token variable"><span class="token variable">`</span><span class="token function">docker</span> images <span class="token operator">|</span><span class="token function">grep</span> docker.io/ <span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'{print $1&quot;:&quot;$2}'</span><span class="token variable">`</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="_3-2-2-åˆå§‹åŒ–master"><a href="#_3-2-2-åˆå§‹åŒ–master" class="header-anchor">#</a> 3.2.2 åˆå§‹åŒ–Master</h3> <ul><li>ä½¿ç”¨ kubeadm åˆå§‹åŒ– k8s é›†ç¾¤</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubeadm init --kubernetes-version<span class="token operator">=</span>v1.14.0 --pod-network-cidr<span class="token operator">=</span><span class="token number">10.244</span>.0.0/16 --service-cidr<span class="token operator">=</span><span class="token number">10.96</span>.0.0/12 --ignore-preflight-errors<span class="token operator">=</span>Swap
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>å¦‚æœæœ‰æŠ¥é”™ä½¿ç”¨ä¸‹é¢å‘½ä»¤æŸ¥çœ‹</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>journalctl -xeu kubelet
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>å¦‚æœåˆå§‹åŒ–è¿‡ç¨‹è¢«ä¸­æ–­å¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤æ¥æ¢å¤</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubeadm reset
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>ä¸‹é¢æ˜¯æœ€åæ‰§è¡ŒæˆåŠŸæ˜¾ç¤ºçš„ç»“æœï¼Œéœ€è¦ä¿å­˜è¿™ä¸ªæ‰§è¡Œç»“æœï¼Œä»¥è®© node èŠ‚ç‚¹åŠ å…¥é›†ç¾¤</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Your Kubernetes control-plane has initialized successfully<span class="token operator">!</span>

To start using your cluster, you need to run the following as a regular user:

  <span class="token function">mkdir</span> -p <span class="token environment constant">$HOME</span>/.kube
  <span class="token function">sudo</span> <span class="token function">cp</span> -i /etc/kubernetes/admin.conf <span class="token environment constant">$HOME</span>/.kube/config
  <span class="token function">sudo</span> <span class="token function">chown</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> -u<span class="token variable">)</span></span><span class="token builtin class-name">:</span><span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> -g<span class="token variable">)</span></span> <span class="token environment constant">$HOME</span>/.kube/config

You should now deploy a pod network to the cluster.
Run <span class="token string">&quot;kubectl apply -f [podnetwork].yaml&quot;</span> with one of the options listed at:
  https://kubernetes.io/docs/concepts/cluster-administration/addons/

Then you can <span class="token function">join</span> any number of worker nodes by running the following on each as root:

kubeadm <span class="token function">join</span> <span class="token number">172.16</span>.100.9:6443 --token 2dyd69.hrfsjkkxs4stim7n <span class="token punctuation">\</span>
    --discovery-token-ca-cert-hash sha256:4e30c1f41aefb177b708a404ccb7e818e31647c7dbdd2d42f6c5c9894b6f41e7
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li>æœ€å¥½ä»¥æ™®é€šç”¨æˆ·çš„èº«ä»½è¿è¡Œä¸‹é¢çš„å‘½ä»¤</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># åœ¨å½“å‰ç”¨æˆ·å®¶ç›®å½•ä¸‹åˆ›å»º.kubeç›®å½•å¹¶é…ç½®è®¿é—®é›†ç¾¤çš„config æ–‡ä»¶</span>
<span class="token function">mkdir</span> -p <span class="token environment constant">$HOME</span>/.kube
<span class="token function">sudo</span> <span class="token function">cp</span> -i /etc/kubernetes/admin.conf <span class="token environment constant">$HOME</span>/.kube/config
<span class="token function">sudo</span> <span class="token function">chown</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> -u<span class="token variable">)</span></span><span class="token builtin class-name">:</span><span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> -g<span class="token variable">)</span></span> <span class="token environment constant">$HOME</span>/.kube/config
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>éƒ¨ç½² flannel ç½‘ç»œæ’ä»¶</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>æŸ¥çœ‹ kube-system å‘½åç©ºé—´ä¸­è¿è¡Œçš„ pods</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl get pods -n kube-system
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>æŸ¥çœ‹ k8s é›†ç¾¤ç»„ä»¶çš„çŠ¶æ€</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl get ComponentStatus
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>é…ç½®å‘½ä»¤è¡¥å…¨</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yum <span class="token function">install</span> -y bash-completion
<span class="token builtin class-name">source</span> /usr/share/bash-completion/bash_completion
<span class="token builtin class-name">source</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>kubectl completion <span class="token function">bash</span><span class="token punctuation">)</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;source &lt;(kubectl completion bash)&quot;</span> <span class="token operator">&gt;&gt;</span> ~/.bashrc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_3-3-éƒ¨ç½²-node"><a href="#_3-3-éƒ¨ç½²-node" class="header-anchor">#</a> 3.3 éƒ¨ç½² Node</h2> <blockquote><p>æœ¬å°èŠ‚çš„æ‰€æœ‰çš„æ“ä½œï¼Œåªåœ¨ Node èŠ‚ç‚¹ä¸Šè¿›è¡Œã€‚</p></blockquote> <h3 id="_3-3-1-åŠ å…¥é›†ç¾¤"><a href="#_3-3-1-åŠ å…¥é›†ç¾¤" class="header-anchor">#</a> 3.3.1 åŠ å…¥é›†ç¾¤</h3> <ul><li>åŠ å…¥é›†ç¾¤ï¼Œæ³¨æ„åœ¨å‘½ä»¤å°¾éƒ¨åŠ ä¸Š --ignore-preflight-errors=Swap ï¼Œä»¥å¿½ç•¥ k8s å¯¹ä¸»æœº swap çš„æ£€æŸ¥ï¼ˆk8sä¸ºäº†æ€§èƒ½æ‰€ä»¥è¦æ±‚è¿›åˆ¶ swap ï¼‰</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubeadm <span class="token function">join</span> <span class="token number">172.16</span>.100.9:6443 --token 2dyd69.hrfsjkkxs4stim7n <span class="token punctuation">\</span>
    --discovery-token-ca-cert-hash sha256:4e30c1f41aefb177b708a404ccb7e818e31647c7dbdd2d42f6c5c9894b6f41e7 --ignore-preflight-errors<span class="token operator">=</span>Swap
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>è¿”å›ç»“æœï¼Œè¡¨ç¤ºåŠ å…¥é›†ç¾¤æˆåŠŸ</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>This <span class="token function">node</span> has joined the cluster:
* Certificate signing request was sent to apiserver and a response was received.
* The Kubelet was informed of the new secure connection details.

Run <span class="token string">'kubectl get nodes'</span> on the control-plane to see this <span class="token function">node</span> <span class="token function">join</span> the cluster.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_3-3-2-æŸ¥çœ‹è¿›åº¦"><a href="#_3-3-2-æŸ¥çœ‹è¿›åº¦" class="header-anchor">#</a> 3.3.2 æŸ¥çœ‹è¿›åº¦</h3> <p>å½“ node èŠ‚ç‚¹åŠ å…¥ K8S é›†ç¾¤ä¸­åï¼ŒMaster ä¼šè°ƒåº¦åˆ° Node èŠ‚ç‚¹ä¸Šä¸€äº›ç»„ä»¶ï¼Œç”¨äºå¤„ç†é›†ç¾¤äº‹åŠ¡ï¼Œè¿™äº›ç»„ä»¶æ²¡æœ‰ä¸‹è½½å®Œæˆä¹‹å‰ Node èŠ‚ç‚¹åœ¨é›†ç¾¤ä¸­è¿˜æ˜¯æœªå°±ç»ªçŠ¶æ€</p> <ul><li>åœ¨ node æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹é•œåƒçš„ä¸‹è½½è¿›åº¦ï¼Œä¸‹é¢æ˜¯æœ€ç»ˆç»“æœæ˜¾ç¤º</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">docker</span> image <span class="token function">ls</span>
REPOSITORY               TAG                 IMAGE ID            CREATED             SIZE
k8s.gcr.io/kube-proxy    v1.14.0             5cd54e388aba        <span class="token number">6</span> weeks ago         <span class="token number">82</span>.1MB
quay.io/coreos/flannel   v0.11.0-amd64       ff281650a721        <span class="token number">3</span> months ago        <span class="token number">52</span>.6MB
k8s.gcr.io/pause         <span class="token number">3.1</span>                 da86e6ba6ca1        <span class="token number">16</span> months ago       742kB
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>å¯ä»¥åœ¨ Master ä¸Šä½¿ç”¨ä¸‹é¢å‘½ä»¤æ¥æŸ¥çœ‹æ–°åŠ å…¥çš„èŠ‚ç‚¹çŠ¶æ€</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ kubectl get nodes
NAME     STATUS   ROLES    AGE     VERSION
master   Ready    master   3d21h   v1.14.1
node1    Ready    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>   3d21h   v1.14.1
node2    Ready    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>   3d21h   v1.14.1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl cluster-info </span>
Kubernetes master is running at https://10.234.2.204:6443
KubeDNS is running at https://10.234.2.204:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
Metrics-server is running at https://10.234.2.204:6443/api/v1/namespaces/kube-system/services/https:metrics-server:/proxy

To further debug and diagnose cluster problems, use <span class="token string">'kubectl cluster-info dump'</span><span class="token builtin class-name">.</span>
<span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token comment"># kubectl get componentstatuses</span>
NAME                 STATUS    MESSAGE             ERROR
controller-manager   Healthy   ok                  
scheduler            Healthy   ok                  
etcd-0               Healthy   <span class="token punctuation">{</span><span class="token string">&quot;health&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;true&quot;</span><span class="token punctuation">}</span>   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>å¦‚æœå«Œç½‘ç»œpullé•œåƒæ…¢å¯ä»¥åœ¨ä¸€å°ä¸Šé¢å°†é•œåƒæ‰“åŒ…å‘é€è‡³å…¶ä»–nodeèŠ‚ç‚¹</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>æ‹·è´åˆ°nodeèŠ‚ç‚¹
for i in /tmp/*.tar; do scp -i $i root@172.16.0.15:/root/;done


nodeèŠ‚ç‚¹è¿˜åŸ
for i in *.tar ;do docker load -i $i;done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>æŸ¥çœ‹ kube-system è¿™ä¸ª k8s å‘½åç©ºé—´ä¸­æœ‰å“ªäº›ç»„ä»¶ï¼Œåˆ†åˆ«è¿è¡Œåœ¨å“ªä¸ªèŠ‚ç‚¹ï¼Œ-o wide æ˜¯ä»¥è¯¦ç»†æ–¹å¼æ˜¾ç¤ºã€‚</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ kubectl get pods -n kube-system -o wide

NAME                                 READY   STATUS    RESTARTS   AGE     IP              NODE         NOMINATED NODE   READINESS GATES
coredns-fb8b8dccf-cp24r              <span class="token number">1</span>/1     Running   <span class="token number">0</span>          26m     <span class="token number">10.244</span>.0.2      i-xeahpl98   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
coredns-fb8b8dccf-ljswp              <span class="token number">1</span>/1     Running   <span class="token number">0</span>          26m     <span class="token number">10.244</span>.0.3      i-xeahpl98   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
etcd-i-xeahpl98                      <span class="token number">1</span>/1     Running   <span class="token number">0</span>          25m     <span class="token number">172.16</span>.100.9    i-xeahpl98   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
kube-apiserver-i-xeahpl98            <span class="token number">1</span>/1     Running   <span class="token number">0</span>          25m     <span class="token number">172.16</span>.100.9    i-xeahpl98   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
kube-controller-manager-i-xeahpl98   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          25m     <span class="token number">172.16</span>.100.9    i-xeahpl98   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
kube-flannel-ds-amd64-crft8          <span class="token number">1</span>/1     Running   <span class="token number">3</span>          16m     <span class="token number">172.16</span>.100.6    i-me87b6gw   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
kube-flannel-ds-amd64-nckw4          <span class="token number">1</span>/1     Running   <span class="token number">0</span>          6m41s   <span class="token number">172.16</span>.100.10   i-qhcc2owe   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
kube-flannel-ds-amd64-zb7sg          <span class="token number">1</span>/1     Running   <span class="token number">0</span>          23m     <span class="token number">172.16</span>.100.9    i-xeahpl98   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
kube-proxy-7kjkf                     <span class="token number">1</span>/1     Running   <span class="token number">0</span>          6m41s   <span class="token number">172.16</span>.100.10   i-qhcc2owe   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
kube-proxy-c5xs2                     <span class="token number">1</span>/1     Running   <span class="token number">2</span>          16m     <span class="token number">172.16</span>.100.6    i-me87b6gw   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
kube-proxy-rdzq2                     <span class="token number">1</span>/1     Running   <span class="token number">0</span>          26m     <span class="token number">172.16</span>.100.9    i-xeahpl98   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
kube-scheduler-i-xeahpl98            <span class="token number">1</span>/1     Running   <span class="token number">0</span>          25m     <span class="token number">172.16</span>.100.9    i-xeahpl98   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_3-3-3-é•œåƒä¸‹è½½å¤ªæ…¢"><a href="#_3-3-3-é•œåƒä¸‹è½½å¤ªæ…¢" class="header-anchor">#</a> 3.3.3 é•œåƒä¸‹è½½å¤ªæ…¢</h3> <p>node èŠ‚ç‚¹éœ€è¦ç¿»å¢™ä¸‹è½½é•œåƒå¤ªæ…¢ï¼Œå»ºè®®ä½¿ç”¨ docker é•œåƒçš„å¯¼å…¥å¯¼å‡ºåŠŸèƒ½
å…ˆå°†masterçš„ä¸‰ä¸ªé•œåƒæ‰“åŒ…å‘é€åˆ°nodeèŠ‚ç‚¹ï¼Œloadåå†jion</p> <ul><li>å¯¼å‡º</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> image save -o /tmp/kube-proxy.tar k8s.gcr.io/kube-proxy
<span class="token function">docker</span> image save -o /tmp/flannel.tar quay.io/coreos/flannel
<span class="token function">docker</span> image save -o /tmp/pause.tar k8s.gcr.io/pause
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>å¯¼å…¥</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> image load -i /tmp/kube-proxy.tar
<span class="token function">docker</span> image load -i /tmp/pause.tar
<span class="token function">docker</span> image load -i /tmp/flannel.tar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_3-4-jioæœ¬éƒ¨ç½²"><a href="#_3-4-jioæœ¬éƒ¨ç½²" class="header-anchor">#</a> 3.4 jioæœ¬éƒ¨ç½²</h2> <h3 id="_3-4-1-é¢„å…ˆå‡†å¤‡"><a href="#_3-4-1-é¢„å…ˆå‡†å¤‡" class="header-anchor">#</a> 3.4.1 é¢„å…ˆå‡†å¤‡</h3> <p>ç¯å¢ƒï¼š</p> <table><thead><tr><th>è§’è‰²</th> <th>IP</th></tr></thead> <tbody><tr><td>master</td> <td>172.16.1.129</td></tr> <tr><td>node01</td> <td>172.16.1.133</td></tr></tbody></table> <p>ä¿®æ”¹å½“å‰çš„ä¸»æœºåï¼Œç¡®ä¿ä¸æ˜¯ <code>localhost</code>ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>hostnamectl set-hostname master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä¸ºå„èŠ‚ç‚¹æ·»åŠ ä¸»æœºåè§£æï¼Œ ç¼–è¾‘<code>/etc/hosts</code>ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">..</span>.
<span class="token number">172.16</span>.1 master master.agou-ops.com
<span class="token number">172.16</span>.1 node01 node01.aogu-ops.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>ç¡®ä¿ä»»æ„èŠ‚ç‚¹ä¸Š <code>Kubelet</code>ä½¿ç”¨çš„ IP åœ°å€å¯äº’é€šï¼ˆæ— éœ€ NAT æ˜ å°„å³å¯ç›¸äº’è®¿é—®ï¼‰ï¼Œä¸”æ²¡æœ‰é˜²ç«å¢™ã€å®‰å…¨ç»„éš”ç¦»</p></blockquote> <p>å…³é—­<code>é˜²ç«å¢™</code>å’Œ<code>SElinux</code>ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">sed</span> -i <span class="token string">'s/SELINUX=*/SELINUX=disabled/'</span> /etc/selinux/config
<span class="token comment"># getenforce ç¡®å®šå½“å‰SElinuxçŠ¶æ€</span>
systemctl disable firewalld <span class="token operator">&amp;&amp;</span> systemctl stop firewalld
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å®‰è£… <code>docker</code> ä»¥åŠ <code>kubelet</code> ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># --------- åœ¨ master å’Œ node èŠ‚ç‚¹æ‰§è¡Œ -----------</span>

<span class="token comment"># ä½¿ç”¨é˜¿é‡Œäº‘ docker é•œåƒåŠ é€Ÿï¼Œå¯ä»¥è‡ªè¡Œå»æ§åˆ¶å°ç”³è¯·ï¼Œåœ¨è¿™é‡Œæˆ‘ä½¿ç”¨å…¬å…±åŠ é€Ÿé•œåƒ</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">REGISTRY_MIRROR</span><span class="token operator">=</span>https://registry.cn-hangzhou.aliyuncs.com

<span class="token comment"># ç¼–è¾‘è„šæœ¬å¿«é€Ÿå®‰è£…ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</span>

<span class="token comment">#!/bin/bash</span>

<span class="token comment"># åœ¨ master èŠ‚ç‚¹å’Œ worker èŠ‚ç‚¹éƒ½è¦æ‰§è¡Œ</span>

<span class="token comment"># å®‰è£… docker</span>
<span class="token comment"># å‚è€ƒæ–‡æ¡£å¦‚ä¸‹</span>
<span class="token comment"># https://docs.docker.com/install/linux/docker-ce/centos/ </span>
<span class="token comment"># https://docs.docker.com/install/linux/linux-postinstall/</span>

<span class="token comment"># å¸è½½æ—§ç‰ˆæœ¬</span>
yum remove -y <span class="token function">docker</span> <span class="token punctuation">\</span>
docker-client <span class="token punctuation">\</span>
docker-client-latest <span class="token punctuation">\</span>
docker-common <span class="token punctuation">\</span>
docker-latest <span class="token punctuation">\</span>
docker-latest-logrotate <span class="token punctuation">\</span>
docker-logrotate <span class="token punctuation">\</span>
docker-selinux <span class="token punctuation">\</span>
docker-engine-selinux <span class="token punctuation">\</span>
docker-engine

<span class="token comment"># è®¾ç½® yum repository</span>
yum <span class="token function">install</span> -y yum-utils <span class="token punctuation">\</span>
device-mapper-persistent-data <span class="token punctuation">\</span>
lvm2
yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo

<span class="token comment"># å®‰è£…å¹¶å¯åŠ¨ docker</span>
yum <span class="token function">install</span> -y docker-ce-19.03.8 docker-ce-cli-19.03.8 containerd.io
systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span>
systemctl start <span class="token function">docker</span>

<span class="token comment"># å®‰è£… nfs-utils</span>
<span class="token comment"># å¿…é¡»å…ˆå®‰è£… nfs-utils æ‰èƒ½æŒ‚è½½ nfs ç½‘ç»œå­˜å‚¨</span>
yum <span class="token function">install</span> -y nfs-utils
yum <span class="token function">install</span> -y <span class="token function">wget</span>

<span class="token comment"># å…³é—­ swap Ã—Ã—é‡è¦Ã—Ã—</span>
swapoff -a <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;vm.swappiness=0&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf <span class="token operator">&amp;&amp;</span> sysctl -p <span class="token operator">&amp;&amp;</span> <span class="token function">free</span> â€“h

<span class="token comment"># ä¿®æ”¹ /etc/sysctl.conf</span>
<span class="token comment"># å¦‚æœæœ‰é…ç½®ï¼Œåˆ™ä¿®æ”¹</span>
<span class="token function">sed</span> -i <span class="token string">&quot;s#^net.ipv4.ip_forward.*#net.ipv4.ip_forward=1#g&quot;</span>  /etc/sysctl.conf
<span class="token function">sed</span> -i <span class="token string">&quot;s#^net.bridge.bridge-nf-call-ip6tables.*#net.bridge.bridge-nf-call-ip6tables=1#g&quot;</span>  /etc/sysctl.conf
<span class="token function">sed</span> -i <span class="token string">&quot;s#^net.bridge.bridge-nf-call-iptables.*#net.bridge.bridge-nf-call-iptables=1#g&quot;</span>  /etc/sysctl.conf
<span class="token function">sed</span> -i <span class="token string">&quot;s#^net.ipv6.conf.all.disable_ipv6.*#net.ipv6.conf.all.disable_ipv6=1#g&quot;</span>  /etc/sysctl.conf
<span class="token function">sed</span> -i <span class="token string">&quot;s#^net.ipv6.conf.default.disable_ipv6.*#net.ipv6.conf.default.disable_ipv6=1#g&quot;</span>  /etc/sysctl.conf
<span class="token function">sed</span> -i <span class="token string">&quot;s#^net.ipv6.conf.lo.disable_ipv6.*#net.ipv6.conf.lo.disable_ipv6=1#g&quot;</span>  /etc/sysctl.conf
<span class="token function">sed</span> -i <span class="token string">&quot;s#^net.ipv6.conf.all.forwarding.*#net.ipv6.conf.all.forwarding=1#g&quot;</span>  /etc/sysctl.conf
<span class="token comment"># å¯èƒ½æ²¡æœ‰ï¼Œè¿½åŠ </span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;net.ipv4.ip_forward = 1&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf
<span class="token builtin class-name">echo</span> <span class="token string">&quot;net.bridge.bridge-nf-call-ip6tables = 1&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf
<span class="token builtin class-name">echo</span> <span class="token string">&quot;net.bridge.bridge-nf-call-iptables = 1&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf
<span class="token builtin class-name">echo</span> <span class="token string">&quot;net.ipv6.conf.all.disable_ipv6 = 1&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf
<span class="token builtin class-name">echo</span> <span class="token string">&quot;net.ipv6.conf.default.disable_ipv6 = 1&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf
<span class="token builtin class-name">echo</span> <span class="token string">&quot;net.ipv6.conf.lo.disable_ipv6 = 1&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf
<span class="token builtin class-name">echo</span> <span class="token string">&quot;net.ipv6.conf.all.forwarding = 1&quot;</span>  <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf
<span class="token comment"># æ‰§è¡Œå‘½ä»¤ä»¥åº”ç”¨</span>
sysctl -p

<span class="token comment"># é…ç½®K8Sçš„yumæº</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;</span> /etc/yum.repos.d/kubernetes.repo</span>
[kubernetes]
name=Kubernetes
baseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64
enabled=1
gpgcheck=0
repo_gpgcheck=0
gpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg
       http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg
EOF</span>

<span class="token comment"># å¸è½½æ—§ç‰ˆæœ¬</span>
yum remove -y kubelet kubeadm kubectl

<span class="token comment"># å®‰è£…kubeletã€kubeadmã€kubectl</span>
<span class="token comment"># å°† ${1} æ›¿æ¢ä¸º kubernetes ç‰ˆæœ¬å·ï¼Œä¾‹å¦‚ 1.17.2</span>
yum <span class="token function">install</span> -y kubelet-<span class="token variable">${1}</span> kubeadm-<span class="token variable">${1}</span> kubectl-<span class="token variable">${1}</span>

<span class="token comment"># ä¿®æ”¹docker Cgroup Driverä¸ºsystemd</span>
<span class="token comment"># # å°†/usr/lib/systemd/system/docker.serviceæ–‡ä»¶ä¸­çš„è¿™ä¸€è¡Œ ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</span>
<span class="token comment"># # ä¿®æ”¹ä¸º ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --exec-opt native.cgroupdriver=systemd</span>
<span class="token comment"># å¦‚æœä¸ä¿®æ”¹ï¼Œåœ¨æ·»åŠ  worker èŠ‚ç‚¹æ—¶å¯èƒ½ä¼šç¢°åˆ°å¦‚ä¸‹é”™è¯¯</span>
<span class="token comment"># [WARNING IsDockerSystemdCheck]: detected &quot;cgroupfs&quot; as the Docker cgroup driver. The recommended driver is &quot;systemd&quot;. </span>
<span class="token comment"># Please follow the guide at https://kubernetes.io/docs/setup/cri/</span>
<span class="token function">sed</span> -i <span class="token string">&quot;s#^ExecStart=/usr/bin/dockerd.*#ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --exec-opt native.cgroupdriver=systemd#g&quot;</span> /usr/lib/systemd/system/docker.service

<span class="token comment"># è®¾ç½® docker é•œåƒï¼Œæé«˜ docker é•œåƒä¸‹è½½é€Ÿåº¦å’Œç¨³å®šæ€§</span>
<span class="token comment"># å¦‚æœæ‚¨è®¿é—® https://hub.docker.io é€Ÿåº¦éå¸¸ç¨³å®šï¼Œäº¦å¯ä»¥è·³è¿‡è¿™ä¸ªæ­¥éª¤</span>
<span class="token function">curl</span> -sSL https://kuboard.cn/install-script/set_mirror.sh <span class="token operator">|</span> <span class="token function">sh</span> -s <span class="token variable">${REGISTRY_MIRROR}</span>

<span class="token comment"># é‡å¯ dockerï¼Œå¹¶å¯åŠ¨ kubelet</span>
systemctl daemon-reload
systemctl restart <span class="token function">docker</span>
systemctl <span class="token builtin class-name">enable</span> kubelet <span class="token operator">&amp;&amp;</span> systemctl start kubelet

<span class="token function">docker</span> version
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br></div></div><blockquote><p>âš ï¸ <strong>WARNING</strong></p> <p>å¦‚æœæ­¤æ—¶æ‰§è¡Œ <code>service status kubelet</code> å‘½ä»¤ï¼Œå°†å¾—åˆ° kubelet å¯åŠ¨å¤±è´¥çš„é”™è¯¯æç¤ºï¼Œè¯·å¿½ç•¥æ­¤é”™è¯¯ï¼Œå› ä¸ºå¿…é¡»å®Œæˆåç»­æ­¥éª¤ä¸­ <code>kubeadm init</code> çš„æ“ä½œï¼Œkubelet æ‰èƒ½æ­£å¸¸å¯åŠ¨</p></blockquote> <p>èµ‹äºˆæƒé™åŠè¿è¡Œï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">chmod</span> +x preinstall.sh
./preinstall.sh <span class="token number">1.18</span>.2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_3-4-2-åˆå§‹åŒ–-master-èŠ‚ç‚¹"><a href="#_3-4-2-åˆå§‹åŒ–-master-èŠ‚ç‚¹" class="header-anchor">#</a> 3.4.2 åˆå§‹åŒ– master èŠ‚ç‚¹</h3> <p>å…³äºåˆå§‹åŒ–æ—¶ç”¨åˆ°çš„ç¯å¢ƒå˜é‡</p> <ul><li><strong><code>APISERVER_NAME</code></strong> ä¸èƒ½æ˜¯ master çš„ hostname</li> <li><strong><code>APISERVER_NAME</code></strong> å¿…é¡»å…¨ä¸ºå°å†™å­—æ¯ã€æ•°å­—ã€å°æ•°ç‚¹ï¼Œ<strong>ä¸èƒ½åŒ…å«å‡å·</strong></li> <li><strong><code>POD_SUBNET</code></strong> æ‰€ä½¿ç”¨çš„ç½‘æ®µä¸èƒ½ä¸ <em><strong>masterèŠ‚ç‚¹/workerèŠ‚ç‚¹</strong></em> æ‰€åœ¨çš„ç½‘æ®µé‡å ã€‚è¯¥å­—æ®µçš„å–å€¼ä¸ºä¸€ä¸ª <a href="https://kuboard.cn/glossary/cidr.html" target="_blank" rel="noopener noreferrer">CIDR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å€¼ï¼Œå¦‚æœæ‚¨å¯¹ CIDR è¿™ä¸ªæ¦‚å¿µè¿˜ä¸ç†Ÿæ‚‰ï¼Œè¯·ä»ç„¶æ‰§è¡Œ <code>export POD_SUBNET=10.100.0.1/16</code>å‘½ä»¤ï¼Œä¸åšä¿®æ”¹</li></ul> <p>åœ¨ <code>master</code> èŠ‚ç‚¹ä¸Šè¿è¡Œï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># æ›¿æ¢ x.x.x.x ä¸º master èŠ‚ç‚¹çš„å†…ç½‘IP</span>
<span class="token comment"># export å‘½ä»¤åªåœ¨å½“å‰ shell ä¼šè¯ä¸­æœ‰æ•ˆï¼Œå¼€å¯æ–°çš„ shell çª—å£åï¼Œå¦‚æœè¦ç»§ç»­å®‰è£…è¿‡ç¨‹ï¼Œè¯·é‡æ–°æ‰§è¡Œæ­¤å¤„çš„ export å‘½ä»¤</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">MASTER_IP</span><span class="token operator">=</span><span class="token number">172.16</span>.1.129
<span class="token comment"># æ›¿æ¢ apiserver.demo ä¸º æ‚¨æƒ³è¦çš„ dnsName</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">APISERVER_NAME</span><span class="token operator">=</span>apiserver.agou.com
<span class="token comment"># Kubernetes å®¹å™¨ç»„æ‰€åœ¨çš„ç½‘æ®µï¼Œè¯¥ç½‘æ®µå®‰è£…å®Œæˆåï¼Œç”± kubernetes åˆ›å»ºï¼Œäº‹å…ˆå¹¶ä¸å­˜åœ¨äºæ‚¨çš„ç‰©ç†ç½‘ç»œä¸­</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">POD_SUBNET</span><span class="token operator">=</span><span class="token number">10.100</span>.0.1/16
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${MASTER_IP}</span>    <span class="token variable">${APISERVER_NAME}</span>&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>åœ¨<code>master</code>èŠ‚ç‚¹ä¸Šæ·»åŠ ä»¥ä¸‹è„šæœ¬ï¼š</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token shebang important">#!/bin/bash</span>

<span class="token comment"># åªåœ¨ master èŠ‚ç‚¹æ‰§è¡Œ</span>

<span class="token comment"># è„šæœ¬å‡ºé”™æ—¶ç»ˆæ­¢æ‰§è¡Œ</span>
<span class="token builtin class-name">set</span> -e

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">${<span class="token operator">#</span>POD_SUBNET}</span> -eq <span class="token number">0</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">[</span> <span class="token variable">${<span class="token operator">#</span>APISERVER_NAME}</span> -eq <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\033">\033</span>[31;1mè¯·ç¡®ä¿æ‚¨å·²ç»è®¾ç½®äº†ç¯å¢ƒå˜é‡ POD_SUBNET å’Œ APISERVER_NAME <span class="token entity" title="\033">\033</span>[0m&quot;</span>
  <span class="token builtin class-name">echo</span> å½“å‰POD_SUBNET<span class="token operator">=</span><span class="token variable">$POD_SUBNET</span>
  <span class="token builtin class-name">echo</span> å½“å‰APISERVER_NAME<span class="token operator">=</span><span class="token variable">$APISERVER_NAME</span>
  <span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>


<span class="token comment"># æŸ¥çœ‹å®Œæ•´é…ç½®é€‰é¡¹ https://godoc.org/k8s.io/kubernetes/cmd/kubeadm/app/apis/kubeadm/v1beta2</span>
<span class="token function">rm</span> -f ./kubeadm-config.yaml
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;</span> ./kubeadm-config.yaml</span>
apiVersion: kubeadm.k8s.io/v1beta2
kind: ClusterConfiguration
kubernetesVersion: v<span class="token variable">${1}</span>
imageRepository: registry.cn-hangzhou.aliyuncs.com/google_containers
controlPlaneEndpoint: &quot;<span class="token variable">${APISERVER_NAME}</span>:6443&quot;
networking:
  serviceSubnet: &quot;10.96.0.0/16&quot;
  podSubnet: &quot;<span class="token variable">${POD_SUBNET}</span>&quot;
  dnsDomain: &quot;cluster.local&quot;
EOF</span>

<span class="token comment"># kubeadm init</span>
<span class="token comment"># æ ¹æ®æ‚¨æœåŠ¡å™¨ç½‘é€Ÿçš„æƒ…å†µï¼Œæ‚¨éœ€è¦ç­‰å€™ 3 - 10 åˆ†é’Ÿ</span>
kubeadm init --config<span class="token operator">=</span>kubeadm-config.yaml --upload-certs

<span class="token comment"># é…ç½® kubectl</span>
<span class="token function">rm</span> -rf /root/.kube/
<span class="token function">mkdir</span> /root/.kube/
<span class="token function">cp</span> -i /etc/kubernetes/admin.conf /root/.kube/config

<span class="token comment"># å®‰è£… calico ç½‘ç»œæ’ä»¶</span>
<span class="token comment"># å‚è€ƒæ–‡æ¡£ https://docs.projectcalico.org/v3.13/getting-started/kubernetes/self-managed-onprem/onpremises</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;å®‰è£…calico-3.13.1&quot;</span>
<span class="token function">rm</span> -f calico-3.13.1.yaml
<span class="token function">wget</span> https://kuboard.cn/install-script/calico/calico-3.13.1.yaml
kubectl apply -f calico-3.13.1.yaml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>æ‰§è¡Œè¯¥è„šæœ¬ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">bash</span> master_init.sh <span class="token number">1.18</span>.2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ£€æŸ¥<code>master</code>åˆå§‹åŒ–ç»“æœï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œç­‰å¾… 3-10 åˆ†é’Ÿï¼Œç›´åˆ°æ‰€æœ‰çš„å®¹å™¨ç»„å¤„äº Running çŠ¶æ€</span>
<span class="token function">watch</span> kubectl get pod -n kube-system -o wide

<span class="token comment"># æŸ¥çœ‹ master èŠ‚ç‚¹åˆå§‹åŒ–ç»“æœ</span>
kubectl get nodes -o wide
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_3-4-3-åˆå§‹åŒ–-node-èŠ‚ç‚¹"><a href="#_3-4-3-åˆå§‹åŒ–-node-èŠ‚ç‚¹" class="header-anchor">#</a> 3.4.3 åˆå§‹åŒ– node èŠ‚ç‚¹</h3> <h4 id="_3-4-3-1-è·å¾—-joinå‘½ä»¤å‚æ•°"><a href="#_3-4-3-1-è·å¾—-joinå‘½ä»¤å‚æ•°" class="header-anchor">#</a> 3.4.3.1  è·å¾— joinå‘½ä»¤å‚æ•°</h4> <p>åœ¨<code>master</code> èŠ‚ç‚¹ä¸Šè·å–<code>join</code>å‘½ä»¤è¡Œï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubeadm token create --print-join-command
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>â„¹ï¸ <strong>æœ‰æ•ˆæ—¶é—´</strong></p> <p>è¯¥<code>token</code> çš„æœ‰æ•ˆæ—¶é—´ä¸º 2 ä¸ªå°æ—¶ï¼Œ2å°æ—¶å†…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ­¤ token åˆå§‹åŒ–ä»»æ„æ•°é‡çš„ worker èŠ‚ç‚¹ã€‚</p></blockquote> <h4 id="_3-4-3-2-åˆå§‹åŒ–-node-èŠ‚ç‚¹"><a href="#_3-4-3-2-åˆå§‹åŒ–-node-èŠ‚ç‚¹" class="header-anchor">#</a> 3.4.3.2 åˆå§‹åŒ– node èŠ‚ç‚¹</h4> <p>ç¼–è¾‘æœ¬åœ°ä¸»æœºè§£ææ–‡ä»¶<code>/etc/hosts</code>ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># æ·»åŠ ä»¥ä¸‹å†…å®¹</span>
<span class="token number">172.16</span>.1.129    apiserver.agou.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>æ‰§è¡Œä»<code>master</code>èŠ‚ç‚¹ä¸Šè·å–çš„<code>join</code>å‘½ä»¤ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubeadm <span class="token function">join</span> apiserver.agou.com:6443 --token 7t8xh1.2y6pzjpgl9eai0kd     --discovery-token-ca-cert-hash sha256:a57479ae585f0c0a617d890c62c15c71023d85d4d55f4dd8fffeb56d9a467ef7 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_3-4-4-æ£€æŸ¥åˆå§‹åŒ–ç»“æœ"><a href="#_3-4-4-æ£€æŸ¥åˆå§‹åŒ–ç»“æœ" class="header-anchor">#</a> 3.4.4 æ£€æŸ¥åˆå§‹åŒ–ç»“æœ</h3> <p>åœ¨<code>master</code>èŠ‚ç‚¹ä¸Šæ‰§è¡Œï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl get nodes -o wide
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_3-5-ä½¿ç”¨-kubespray-éƒ¨ç½²"><a href="#_3-5-ä½¿ç”¨-kubespray-éƒ¨ç½²" class="header-anchor">#</a> 3.5 ä½¿ç”¨ Kubespray éƒ¨ç½²</h2> <h3 id="_3-5-1-kubespray-ç®€ä»‹"><a href="#_3-5-1-kubespray-ç®€ä»‹" class="header-anchor">#</a> 3.5.1 Kubespray ç®€ä»‹</h3> <p><a href="https://github.com/kubernetes-incubator/kubespray" target="_blank" rel="noopener noreferrer">Kubespray<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ˜¯ Kubernetes incubator ä¸­çš„é¡¹ç›®ï¼Œç›®æ ‡æ˜¯æä¾› Production Ready Kubernetes éƒ¨ç½²æ–¹æ¡ˆï¼Œè¯¥é¡¹ç›®åŸºç¡€æ˜¯é€šè¿‡ Ansible Playbook æ¥å®šä¹‰ç³»ç»Ÿä¸ Kubernetes é›†ç¾¤éƒ¨ç½²çš„ä»»åŠ¡ï¼Œå…·æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š</p> <ul><li>å¯ä»¥éƒ¨ç½²åœ¨ AWS, GCE, Azure, OpenStack ä»¥åŠè£¸æœºä¸Š.</li> <li>éƒ¨ç½² High Available Kubernetes é›†ç¾¤.</li> <li>å¯ç»„åˆæ€§ (Composable)ï¼Œå¯è‡ªè¡Œé€‰æ‹© Network Plugin (flannel, calico, canal, weave) æ¥éƒ¨ç½².</li> <li>æ”¯æŒå¤šç§ Linux distributions(CoreOS, Debian Jessie, Ubuntu 16.04, CentOS/RHEL7).</li></ul> <p>Kubespray ç”±ä¸€ç³»åˆ—çš„ <a href="http://docs.ansible.com/" target="_blank" rel="noopener noreferrer">Ansible<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> playbookã€ç”Ÿæˆ <a href="https://github.com/kubernetes-incubator/kubespray/blob/master/docs/ansible.md" target="_blank" rel="noopener noreferrer">inventory<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> çš„å‘½ä»¤è¡Œå·¥å…·ä»¥åŠç”Ÿæˆ OS/Kubernetes é›†ç¾¤é…ç½®ç®¡ç†ä»»åŠ¡çš„ä¸“ä¸šçŸ¥è¯†æ„æˆã€‚</p> <h3 id="_3-5-2-åˆå§‹åŒ–ç¯å¢ƒ"><a href="#_3-5-2-åˆå§‹åŒ–ç¯å¢ƒ" class="header-anchor">#</a> 3.5.2 åˆå§‹åŒ–ç¯å¢ƒ</h3> <p>ä¸»æœºç¯å¢ƒï¼š</p> <table><thead><tr><th>è§’è‰²</th> <th>IP</th></tr></thead> <tbody><tr><td>master</td> <td>172.16.1.128</td></tr> <tr><td>node01</td> <td>172.16.1.129</td></tr></tbody></table> <p>ç¼–è¾‘<code>/etc/hosts</code>æ–‡ä»¶ï¼Œä½¿å„ä¸»æœºä¹‹é—´å¯ä»¥é€šè¿‡ä¸»æœºåäº’ç›¸é€šä¿¡ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># æ·»åŠ ä»¥ä¸‹å†…å®¹</span>
<span class="token number">172.16</span>.1.128 master master.agou-ops.com
<span class="token number">172.16</span>.1.129 node01 node01.agou-ops.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å…³é—­ SELinux å’Œé˜²ç«å¢™ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">sed</span> -i <span class="token string">'s/SELINUX=*/SELINUX=disabled/'</span> /etc/selinux/config
systemctl disable firewalld <span class="token operator">&amp;&amp;</span> systemctl stop firewalld
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Kubernetes 1.8 å¼€å§‹è¦æ±‚å…³é—­ç³»ç»Ÿçš„ Swap äº¤æ¢åˆ†åŒºï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>swapoff -a <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;vm.swappiness=0&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/sysctl.conf <span class="token operator">&amp;&amp;</span> sysctl -p <span class="token operator">&amp;&amp;</span> <span class="token function">free</span> â€“h
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Docker ä» 1.13 ç‰ˆæœ¬å¼€å§‹è°ƒæ•´äº†é»˜è®¤çš„é˜²ç«å¢™è§„åˆ™ï¼Œç¦ç”¨äº† <code>iptables filter</code>è¡¨ä¸­<code>FOWARD</code>é“¾ï¼Œè¿™æ ·ä¼šå¼•èµ· Kubernetes é›†ç¾¤ä¸­è·¨ Node çš„ Pod æ— æ³•é€šä¿¡ï¼Œåœ¨å„ä¸ª Docker èŠ‚ç‚¹æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>iptables -P FORWARD ACCEPT
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>é…ç½® SSH Key è®¤è¯ã€‚ç¡®ä¿æœ¬æœºä¹Ÿå¯ä»¥ SSH è¿æ¥ï¼Œå¦åˆ™ä¸‹é¢éƒ¨ç½²å¤±è´¥ã€‚</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>ssh-keygen -t rsa -N <span class="token string">&quot;&quot;</span>
<span class="token function">cat</span> ~/.ssh/id_rsa.pub <span class="token operator">&gt;&gt;</span> ~/.ssh/authorized_keys
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>æ›´æ–°ç³»ç»Ÿå†…æ ¸ä¸º 4.4.x , CentOS é»˜è®¤ä¸º 3.10.x ã€‚</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">rpm</span> --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
<span class="token function">rpm</span> -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm
yum --enablerepo<span class="token operator">=</span>elrepo-kernel <span class="token function">install</span> -y kernel-lt kernel-lt-devel 
grub2-set-default <span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>é‡å¯ç³»ç»Ÿï¼š<code>reboot</code></p> <p>å¢åŠ å†…æ ¸é…ç½®ï¼Œç¼–è¾‘<code>/etc/sysctl.conf</code>æ–‡ä»¶ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># å¢åŠ ä»¥ä¸‹å†…å®¹</span>
net.bridge.bridge-nf-call-iptables <span class="token operator">=</span> <span class="token number">1</span>
net.bridge.bridge-nf-call-ip6tables <span class="token operator">=</span> <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ä½¿å…¶å†…æ ¸é…ç½®ç”Ÿæ•ˆï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>sysctl -p
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_3-5-3-å®‰è£…-kubespray"><a href="#_3-5-3-å®‰è£…-kubespray" class="header-anchor">#</a> 3.5.3 å®‰è£… Kubespray</h3> <p>å®‰è£… Centos çš„ EPEL æºï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code> yum -y <span class="token function">install</span> epel-release
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ›´æ–°ç¼“å­˜ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code> yum clean all <span class="token operator">&amp;&amp;</span> yum makecache
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å®‰è£…ç›¸å…³è½¯ä»¶ï¼ˆAnsible ç‰ˆæœ¬å¿…é¡» &gt;= 2.7ï¼‰ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code> yum <span class="token function">install</span> -y python-pip python3 python-netaddr python3-pip ansible <span class="token function">git</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä¸‹è½½æºç ï¼Œå½“å‰ Kubespray é¡¹ç›®çš„ Master åˆ†æ”¯é»˜è®¤å®‰è£… K8s 1.13.1 ç‰ˆæœ¬ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/kubernetes-sigs/kubespray.git
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å®‰è£… Kubespray ä¾èµ–ï¼Œè‹¥æ— ç‰¹æ®Šè¯´æ˜ï¼Œåç»­æ“ä½œå‡åœ¨ ~/kubespray `ç›®å½•ä¸‹æ‰§è¡Œï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code> <span class="token builtin class-name">cd</span> kubespray 
 pip3 <span class="token function">install</span> -r requirements.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>é…ç½® Kubesprayï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code> <span class="token function">cp</span> -rfp inventory/sample inventory/mycluster
 
 <span class="token comment"># Update Ansible inventory file with inventory builder</span>
<span class="token builtin class-name">declare</span> -a <span class="token assign-left variable">IPS</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10.10</span>.1.3 <span class="token number">10.10</span>.1.4 <span class="token number">10.10</span>.1.5<span class="token punctuation">)</span>
<span class="token assign-left variable">CONFIG_FILE</span><span class="token operator">=</span>inventory/mycluster/hosts.yaml python3 contrib/inventory_builder/inventory.py <span class="token variable">${IPS<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ä¿®æ”¹é…ç½®æ–‡ä»¶ <code>inventory/mycluster/hosts.ini</code>ï¼š</p> <div class="language-ini line-numbers-mode"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">all</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">master ansible_host</span><span class="token punctuation">=</span><span class="token value attr-value">master ip=172.16.1.128</span>

<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">kube-master</span><span class="token punctuation">]</span></span>
master

<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">etcd</span><span class="token punctuation">]</span></span>
master

<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">kube-node</span><span class="token punctuation">]</span></span>
node01

<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">k8s-cluster:children</span><span class="token punctuation">]</span></span>
kube-master
kube-node

<span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">calico-rr</span><span class="token punctuation">]</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>â„¹ï¸æ­¤å¤„ä¹Ÿå¯ä»¥ç”¨ï¼š<code>kubespray prepare --masters master1 --etcds master1 --nodes node1 node2 node3</code>æ¥è‡ªåŠ¨ç”Ÿæˆ<code>inventory</code>æ–‡ä»¶</p> <p>ä¿®æ”¹é…ç½®æ–‡ä»¶<code>inventory/mycluster/group_vars/all/all.yml</code>ï¼š</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># ä¿®æ”¹å¦‚ä¸‹é…ç½®:</span>
<span class="token key atrule">loadbalancer_apiserver_localhost</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> 
<span class="token comment"># åŠ è½½å†…æ ¸æ¨¡å—ï¼Œå¦åˆ™ ceph, gfs ç­‰æ— æ³•æŒ‚è½½å®¢æˆ·ç«¯</span>
<span class="token key atrule">kubelet_load_modules</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>ä¿®æ”¹é•œåƒé»˜è®¤çš„ Repo åœ°å€ï¼Œä½¿ç”¨ Calico ä¸‰å±‚ç½‘ç»œï¼ŒåŒæ—¶å¯ä»¥æŒ‡å®šå®‰è£…çš„ K8sç‰ˆæœ¬ï¼Œå‚æ•°ä¸º<code>kube_version</code>ã€‚ç¼–è¾‘æ–‡ä»¶<code>inventory/mycluster/group_vars/k8s-cluster/k8s-cluster.yml</code>(åœ¨è¿™é‡Œæˆ‘èƒ½å¤Ÿç§‘å­¦ä¸Šç½‘å°±ä¸åšä¿®æ”¹äº†)ï¼š</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">kube_image_repo</span><span class="token punctuation">:</span> <span class="token string">&quot;gcr.io/google-containers&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¦‚éœ€è®¾ç½®ä»£ç†ï¼Œåœ¨<code>cluster.yml</code>ä¸­ç¼–è¾‘ default å€¼å³å¯ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">..</span>.
proxy_env:
          http_proxy: <span class="token string">&quot;ã€ã€ http_proxy | default ('192.168.43.37:8888') ã€‘ã€‘&quot;</span>
          HTTP_PROXY: <span class="token string">&quot;ã€ã€ http_proxy | default ('192.168.43.37:8888') ã€‘ã€‘&quot;</span>
          https_proxy: <span class="token string">&quot;ã€ã€ https_proxy | default ('192.168.43.37:8888') ã€‘ã€‘&quot;</span>
          HTTPS_PROXY: <span class="token string">&quot;ã€ã€ https_proxy | default ('192.168.43.37:8888') ã€‘ã€‘&quot;</span>
          no_proxy: <span class="token string">&quot;ã€ã€ no_proxy | default ('') ã€‘ã€‘&quot;</span>
          NO_PROXY: <span class="token string">&quot;ã€ã€ no_proxy | default ('') ã€‘ã€‘&quot;</span>
      no_log: <span class="token boolean">true</span>
<span class="token punctuation">..</span>.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>å¦‚éœ€è®¾ç½®<code>docker pull</code> ä»£ç†ï¼Œæ–°å»º<code>/etc/systemd/system/docker.service.d/http-proxy.conf</code>æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Environment</span><span class="token operator">=</span><span class="token string">&quot;http_proxy=192.168.43.37:8888&quot;</span>
<span class="token assign-left variable">Environment</span><span class="token operator">=</span><span class="token string">&quot;https_proxy=192.168.43.37:8888&quot;</span>
<span class="token assign-left variable">Environment</span><span class="token operator">=</span><span class="token string">&quot;NO_PROXY= hostname.example.com,172.10.10.10&quot;</span>
<span class="token comment"># æœ€åé‡å¯docker</span>
systemctl daemon-reload
systemctl restart <span class="token function">docker</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>ä¿®æ”¹<code>./roles/kubernetes-apps/ansible/templates/dashboard.yml.j2</code>æ–‡ä»¶ï¼Œä½¿ç”¨ <code>NodePort</code> æ–¹å¼è®¿é—® Dashboardï¼š</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># ------------------- Dashboard Service ------------------- #â€¦â€¦â€¦â€¦      </span>
<span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">8443</span>  
<span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort    //æ·»åŠ è¿™ä¸€è¡Œ      
<span class="token key atrule">selector</span><span class="token punctuation">:</span>
<span class="token key atrule">k8s-app</span><span class="token punctuation">:</span> kubernetes<span class="token punctuation">-</span>dashboard
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>âš ï¸ æ³¨æ„ï¼šå¦‚æœæ˜¯å•èŠ‚ç‚¹éƒ¨ç½² K8sï¼ŒKubespray é»˜è®¤ä¼šåˆ›å»º 2 ä¸ª coredns Podï¼Œä½† Deployment ä¸­åˆç”¨åˆ°äº† podAntiAffinityï¼Œå› æ­¤ä¼šå¯¼è‡´å…¶ä¸­ä¸€ä¸ª coredns pod pendingï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹<code>./roles/kubernetes-apps/ansible/templates/coredns-deployment.yml.j2</code>ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># æ³¨é‡Šæ‰ä»¥ä¸‹å‡ è¡Œä»£ç </span>
      <span class="token key atrule">affinity</span><span class="token punctuation">:</span>
        <span class="token comment">#podAntiAffinity:</span>
        <span class="token comment">#  requiredDuringSchedulingIgnoredDuringExecution:</span>
        <span class="token comment">#  - topologyKey: &quot;kubernetes.io/hostname&quot;</span>
        <span class="token comment">#    labelSelector:</span>
        <span class="token comment">#      matchLabels:</span>
        <span class="token comment">#        k8s-app: corednsã€ã€ coredns_ordinal_suffix | default('') ã€‘ã€‘</span>

<span class="token comment"># æˆ–è€…åœ¨specä¸€è¡Œæ·»åŠ ä»£ç ï¼š</span>
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> 1   //æŒ‡å®špodä¸º1ä¸ªå‰¯æœ¬
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>æœ€åæ‰§è¡Œéƒ¨ç½²å‘½ä»¤ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>ansible-playbook -i inventory/mycluster/hosts.ini  --become --become-user<span class="token operator">=</span>root cluster.yml -b -v
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_3-5-4-ç™»å½•-dashboard"><a href="#_3-5-4-ç™»å½•-dashboard" class="header-anchor">#</a> 3.5.4 ç™»å½• Dashboard</h3> <p>ç™»é™† Dashboard æ”¯æŒ kubeconfig å’Œ token ä¸¤ç§è®¤è¯æ–¹å¼ï¼Œkubeconfig ä¹Ÿä¾èµ– token å­—æ®µï¼Œæ‰€ä»¥ç”Ÿæˆ token è¿™ä¸€æ­¥æ˜¯å¿…ä¸å¯å°‘çš„ã€‚æ­¤å¤„ï¼Œæˆ‘ä»¬è·å–é›†ç¾¤ç®¡ç†å‘˜ï¼ˆæ‹¥æœ‰æ‰€æœ‰å‘½åç©ºé—´çš„ admin æƒé™ï¼‰çš„ tokenã€‚</p> <p>æŸ¥çœ‹ kubernetes-dashboard æš´éœ²çš„ç«¯å£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œè¿™é‡Œæ˜¯31777ç«¯å£ã€‚</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master kubespray<span class="token punctuation">]</span><span class="token punctuation">\</span>#  kubectl get svc --all-namespaces <span class="token operator">|</span> <span class="token function">grep</span> kubernetes-dashboard
kube-system   kubernetes-dashboard        NodePort    <span class="token number">10.233</span>.41.202   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        <span class="token number">443</span>:30548/TCP            8m16s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>è·å– admin çš„ token</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master kubespray<span class="token punctuation">]</span><span class="token punctuation">\</span>#  kubectl -n kube-system describe <span class="token variable"><span class="token variable">$(</span>kubectl -n kube-system get secret -n kube-system -o name <span class="token operator">|</span> <span class="token function">grep</span> namespace<span class="token variable">)</span></span> <span class="token operator">|</span> <span class="token function">grep</span> token
Name:         namespace-controller-token-ksdvp
Type:  kubernetes.io/service-account-token
token:      eyJhbGciOiJSUzI1NiIsImtpZCI6IkV0N0pLMXVqMzNxS2xCNXRlTkxpRTlOYnNMVzRiajNrLU9kdi1qRW5jTDQifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJuYW1lc3BhY2UtY29udHJvbGxlci10b2tlbi1rc2R2cCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50Lm5hbWUiOiJuYW1lc3BhY2UtY29udHJvbGxlciIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6ImZiM2NkMDBhLTE4ZjAtNGI4OC1hZGNiLWYwNGVjZWNlZTUzNiIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDprdWJlLXN5c3RlbTpuYW1lc3BhY2UtY29udHJvbGxlciJ9.bYWcoopcYFC6EYNMNPkoiZeUQqfidC9NwlrMzzkZD3T9e-PbDd37pmTeWAcU_E4DCDzeVc9CXfWPhWCfr3syZKWiIXPNtDrNrIgnGs34Id2evsh7evVTgOjQtWkRoqX9UFdjWZdQPxvJChLZacRqbUp718umCzhR9evuE0zq8JeruBCTrcilQDDYobavfYs72HrwZ5xlIj2GMb66FeS7mYZacP-2-M3oVsziIWLs_kfBIaN_OkpImUPpvJxF-8xMmVP2BCKWyHWaLPIUdVsF8FkiLWH7bIS8f0cm8D4wEcMZ4IYkVe2FMcmMaiFJx5HEXrwA4YT7bMVy4PJhR71Thg
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>åœ¨ dashboard ç™»å½•é¡µé¢ä¸Šä½¿ç”¨ä¸Šé¢è¾“å‡ºä¸­çš„é‚£ä¸ªéå¸¸é•¿çš„å­—ç¬¦ä¸²ä½œä¸º token ç™»å½•ï¼Œå³å¯ä»¥æ‹¥æœ‰ç®¡ç†å‘˜æƒé™æ“ä½œæ•´ä¸ª kubernetes é›†ç¾¤ä¸­çš„å¯¹è±¡ã€‚å½“ç„¶æ‚¨ä¹Ÿå¯ä»¥å°†è¿™ä¸² token åŠ åˆ° admin ç”¨æˆ·çš„ kubeconfig æ–‡ä»¶ä¸­ï¼Œç»§ç»­ä½¿ç”¨ kubeconfig ç™»å½•ï¼Œä¸¤ç§è®¤è¯æ–¹å¼ä»»æ‚¨é€‰æ‹©ã€‚</p> <p>ç™»å½• dashboardï¼šhttps://172.16.1.128:30548</p> <blockquote><p>æ³¨æ„ï¼šç”±äºè¿™é‡Œä½¿ç”¨çš„ HTTPSï¼Œå¹¶æœªä½¿ç”¨è¯ä¹¦ï¼Œå› æ­¤ä½¿ç”¨ Google ç­‰æµè§ˆå™¨ä¼šç»ˆæ­¢è®¿é—®ã€‚</p></blockquote> <h3 id="_3-5-5-éªŒè¯-k8s-é›†ç¾¤"><a href="#_3-5-5-éªŒè¯-k8s-é›†ç¾¤" class="header-anchor">#</a> 3.5.5 éªŒè¯ K8s é›†ç¾¤</h3> <ul><li>æŸ¥çœ‹é›†ç¾¤ç‰ˆæœ¬</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@master ~<span class="token punctuation">]</span><span class="token punctuation">\</span># kubelet --version
Kubernetes v1.18.2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code> kubectl get nodes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>æŸ¥çœ‹é›†ç¾¤ Pod</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code> kubectl get pods --all-namespaces
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>æŸ¥çœ‹ IPVS</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code> ipvsadm -L -n
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_3-5-6-å…¶ä»–"><a href="#_3-5-6-å…¶ä»–" class="header-anchor">#</a> 3.5.6 å…¶ä»–</h3> <p>å¢åŠ  node èŠ‚ç‚¹ï¼ˆæå‰åœ¨<code>hosts.ini</code>æ–‡ä»¶ä¸­å¢åŠ ä¸»æœºèŠ‚ç‚¹ï¼‰ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>ansible-playbook -i inventory/mycluster/hosts.ini scale.yml -b -v -k
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å°†<code>hosts.ini</code> æ–‡ä»¶ä¸­çš„ master å’Œ etcd çš„æœºå™¨å¢åŠ åˆ°å¤šå°ï¼Œæ‰§è¡Œéƒ¨ç½²å‘½ä»¤ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>ansible-playbook -i inventory/mycluster/hosts.ini cluster.yml -b -vvv
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>åˆªé™¤èŠ‚ç‚¹ï¼Œå¦‚æœä¸æŒ‡å®šèŠ‚ç‚¹å°±æ˜¯åˆªé™¤æ•´ä¸ªé›†ç¾¤ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>ansible-playbook -i inventory/mycluster/hosts.ini remove-node.yml -b -v
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¦‚æœéœ€è¦å¸è½½ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>ansible-playbook -i inventory/mycluster/hosts.ini reset.yml -b â€“vvv
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å‡çº§ K8s é›†ç¾¤ï¼Œé€‰æ‹©å¯¹åº”çš„ K8s ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ‰§è¡Œå‡çº§å‘½ä»¤ã€‚æ¶‰åŠæ–‡ä»¶ä¸º <code>upgrade-cluster.yml</code>ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>ansible-playbook upgrade-cluster.yml -b -i inventory/mycluster/hosts.ini -e <span class="token assign-left variable">kube_version</span><span class="token operator">=</span>vX.XX.XX -vvv
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="header-anchor">#</a> å‚è€ƒé“¾æ¥</h2> <ul><li><p>kubespray GetStartedï¼šhttps://github.com/kubernetes-sigs/kubespray/blob/master/docs/getting-started.md</p></li> <li><p>ä½¿ç”¨ Kubespray åœ¨åŸºç¡€è®¾æ–½æˆ–äº‘å¹³å°ä¸Šå®‰è£… Kubernetesï¼šhttps://k8smeetup.github.io/docs/getting-started-guides/kubespray/</p></li></ul></div> <footer class="page-edit" style="display:none;"><div class="edit-link"><a href="https://github.com/AGou-ops/myDocsv2/edit/master/docs/k8s/Quicklystart/ä¸‰ é›†ç¾¤éƒ¨ç½².md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µï¼</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°: </span> <span class="time">2022/06/01, 14:44:58</span></div></footer> <!----> <!----> <div class="article-list" data-v-2af88190><div class="article-title" data-v-2af88190><a href="/myDocsv2/timeline/" class="iconfont icon-shizhong" data-v-2af88190>æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper" data-v-2af88190><dl data-v-2af88190><dd data-v-2af88190>01</dd> <dt data-v-2af88190><a href="/myDocsv2/timeline/2022-03-09.html" data-v-2af88190><div data-v-2af88190>ç”Ÿå‘½çŸ­æš‚ï¼ŒçŠ¹å¦‚éœ²ç æ¶ˆæ•£ï¼Œäººä»¬åœ¨å¥”æ³¢ä¸­å¯»æ±‚ç­”æ¡ˆã€‚</div></a> <span data-v-2af88190>03-09</span></dt></dl><dl data-v-2af88190><dd data-v-2af88190>02</dd> <dt data-v-2af88190><a href="/myDocsv2/timeline/2018-05-06.html" data-v-2af88190><div data-v-2af88190>äººç”Ÿå¤©åœ°ä¹‹é—´ï¼Œè‹¥ç™½é©¹è¿‡éš™ï¼Œå¿½ç„¶è€Œå·²ã€‚</div></a> <span data-v-2af88190>05-06</span></dt></dl></div> <div data-v-2af88190><a href="/myDocsv2/timeline/" class="article-more" data-v-2af88190>æ›´å¤šæ–‡ç«  &gt;</a></div></div></main> <!----> <div class="comments-wrapper" data-v-584a622c><div class="valine-wrapper"><div id="valine"></div></div></div></div></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div><!----><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      æ¬¢è¿æ¥åˆ° AGou's Docs-v2
    </div> <div class="operation" style="right:90px;bottom:40px;display:;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-5775ee02></i></div> <canvas id="banniang" width="150" height="220" class="live2d" style="right:90px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    çœ‹æ¿å¨˜
  </div></div><div></div><!----><div data-v-3338c3f8><div class="DetailsOpenFlag" style="right:1rem;bottom:9rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;font-size:14px;font-weight:500;display:none;" data-v-3338c3f8>
 å±•å¼€

</div></div></div></div>
    <script src="/myDocsv2/assets/js/app.792c833e.js" defer></script><script src="/myDocsv2/assets/js/5.dd197eb6.js" defer></script><script src="/myDocsv2/assets/js/1.3bd7010a.js" defer></script><script src="/myDocsv2/assets/js/2.0c757b52.js" defer></script><script src="/myDocsv2/assets/js/54.e8578653.js" defer></script><script src="/myDocsv2/assets/js/17.ce9a229a.js" defer></script>
  </body>
</html>
