(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{742:function(s,t,n){"use strict";n.r(t);var a=n(6),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"dhcp-简单使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dhcp-简单使用"}},[s._v("#")]),s._v(" DHCP 简单使用")]),s._v(" "),n("h2",{attrs:{id:"简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),n("p",[n("strong",[s._v("动态主机设置协议")]),s._v("（英语："),n("strong",[s._v("D")]),s._v("ynamic "),n("strong",[s._v("H")]),s._v("ost "),n("strong",[s._v("C")]),s._v("onfiguration "),n("strong",[s._v("P")]),s._v("rotocol，缩写："),n("strong",[s._v("DHCP")]),s._v("）是一个用于"),n("a",{attrs:{href:"https://zh.wikipedia.org/wiki/%E7%BD%91%E9%99%85%E5%8D%8F%E8%AE%AE",target:"_blank",rel:"noopener noreferrer"}},[s._v("IP"),n("OutboundLink")],1),s._v("网络的"),n("a",{attrs:{href:"https://zh.wikipedia.org/wiki/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE",target:"_blank",rel:"noopener noreferrer"}},[s._v("网络协议"),n("OutboundLink")],1),s._v("，位于"),n("a",{attrs:{href:"https://zh.wikipedia.org/wiki/OSI%E6%A8%A1%E5%9E%8B",target:"_blank",rel:"noopener noreferrer"}},[s._v("OSI模型"),n("OutboundLink")],1),s._v("的"),n("a",{attrs:{href:"https://zh.wikipedia.org/wiki/%E5%BA%94%E7%94%A8%E5%B1%82",target:"_blank",rel:"noopener noreferrer"}},[s._v("应用层"),n("OutboundLink")],1),s._v("，使用"),n("a",{attrs:{href:"https://zh.wikipedia.org/wiki/%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%8D%8F%E8%AE%AE",target:"_blank",rel:"noopener noreferrer"}},[s._v("UDP"),n("OutboundLink")],1),s._v("协议工作，主要有两个用途：")]),s._v(" "),n("ul",[n("li",[s._v("用于内部网或网络服务供应商自动分配"),n("a",{attrs:{href:"https://zh.wikipedia.org/wiki/IP%E5%9C%B0%E5%9D%80",target:"_blank",rel:"noopener noreferrer"}},[s._v("IP地址"),n("OutboundLink")],1),s._v("给用户")]),s._v(" "),n("li",[s._v("用于内部网管理员对所有电脑作中央管理")])]),s._v(" "),n("p",[s._v("服务器端工具有:")]),s._v(" "),n("ul",[n("li",[s._v("dhcp: 只提供"),n("code",[s._v("dhcp")]),s._v("服务")]),s._v(" "),n("li",[s._v("dnsmasq: 轻量级,提供"),n("code",[s._v("dhcp")]),s._v("和"),n("code",[s._v("dns")]),s._v("服务")])]),s._v(" "),n("h2",{attrs:{id:"安装与配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装与配置文件"}},[s._v("#")]),s._v(" 安装与配置文件")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v(" yum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y dhcp\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("通过"),n("code",[s._v("rpm -ql dhcp")]),s._v("可以了解到")]),s._v(" "),n("ol",[n("li",[n("code",[s._v("dhcp")]),s._v(" 提供两个程序,一个是"),n("code",[s._v("dhcpd")]),s._v("(dhcp服务器端守护进程),另一个是"),n("code",[s._v("dhcrelay")]),s._v("(dhcp中继代理服务)")]),s._v(" "),n("li",[n("code",[s._v("dhcp")]),s._v("有三个"),n("code",[s._v("UNIT FILE")]),s._v("启动服务时应当分清出自己要启动的服务")])]),s._v(" "),n("p",[s._v("配置文件"),n("code",[s._v("/etc/dhcp/dhcp.conf")]),s._v(":")]),s._v(" "),n("p",[s._v("该配置文件默认内容为空,程序包提供了示例配置文件,我们可以直接拿来修改修改")]),s._v(" "),n("p",[n("code",[s._v("cp /usr/share/doc/dhcp-4.2.5/dhcpd.conf.example ./dhcpd.conf")])]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# option definitions common to all supported networks...")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 全局配置")]),s._v("\noption domain-name "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"agou-ops.com"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\noption domain-name-servers "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".159.2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定默认DNS服务器")]),s._v("\noption routers "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".99.1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定默认路由")]),s._v("\n\ndefault-lease-time "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("43200")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmax-lease-time "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("86400")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nlog-facility local7"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 子网配置")]),s._v("\nsubnet "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.0 netmask "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.255")]),s._v(".0.0 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    range "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".99.101 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".99.120"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为特定主机分配固定IP地址")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" apex "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   hardware ethernet 00:0c:29:b8:73:9e"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   fixed-address "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".99.99"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("p",[s._v("修改完配置文件需要重启dhcpd,"),n("code",[s._v("systemctl restart dhcpd")])]),s._v(" "),n("p",[s._v("查看dhcpd 工作情况可以查看其分配情况:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("# "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("less")]),s._v(" /var/lib/dhcpd/dhcpd.leases\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The format of this file is documented in the dhcpd.leases(5) manual page.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# This lease file was written by isc-dhcp-4.2.5")]),s._v("\n\nlease "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".99.101 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  starts "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("/04/19 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":53:55"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  ends "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("/04/20 07:53:55"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  tstp "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("/04/20 07:53:55"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  cltt "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("/04/19 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":53:55"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  binding state active"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  next binding state "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  rewind binding state "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  hardware ethernet 00:0c:29:ad:e1:01"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  client-hostname "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"master"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nserver-duid "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token entity",title:"\\000"}},[s._v("\\000")]),n("span",{pre:!0,attrs:{class:"token entity",title:"\\001"}},[s._v("\\001")]),n("span",{pre:!0,attrs:{class:"token entity",title:"\\000"}},[s._v("\\000")]),n("span",{pre:!0,attrs:{class:"token entity",title:"\\001"}},[s._v("\\001")]),s._v("&/d^"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\000"}},[s._v("\\000")]),n("span",{pre:!0,attrs:{class:"token entity",title:"\\014"}},[s._v("\\014")]),s._v(")"),n("span",{pre:!0,attrs:{class:"token entity",title:"\\255"}},[s._v("\\255")]),n("span",{pre:!0,attrs:{class:"token entity",title:"\\341"}},[s._v("\\341")]),n("span",{pre:!0,attrs:{class:"token entity",title:"\\001"}},[s._v("\\001")]),s._v('"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h2",{attrs:{id:"dhclient-使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#dhclient-使用"}},[s._v("#")]),s._v(" dhclient 使用")]),s._v(" "),n("p",[s._v("默认情况下,dhcp服务端监听的端口是"),n("code",[s._v("udp")]),s._v("的"),n("code",[s._v("67")]),s._v("号端口,客户端"),n("code",[s._v("dhclient")]),s._v("则监听"),n("code",[s._v("udp")]),s._v("的"),n("code",[s._v("68")]),s._v("号端口")]),s._v(" "),n("p",[s._v("在前台查看网络地址信息的获取情况(第二次执行):")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node01 ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("# dhclient -d\t\t"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -d 运行在前台,需要特别注意")]),s._v("\nInternet Systems Consortium DHCP Client "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.2")]),s._v(".5\nCopyright "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2004")]),s._v("-2013 Internet Systems Consortium.\nAll rights reserved.\nFor info, please visit https://www.isc.org/software/dhcp/\n\nListening on LPF/ens33/00:0c:29:d1:17:17\nSending on   LPF/ens33/00:0c:29:d1:17:17\nSending on   Socket/fallback\nDHCPREQUEST on ens33 to "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.255")]),s._v(".255.255 port "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("67")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xid"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2447b4d8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nDHCPACK from "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".159.129 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xid"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0x2447b4d8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nbound to "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".99.103 -- renewal "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("18303")]),s._v(" seconds.\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("可以看到从本地局域网中的DHCP服务器中获取到了IP地址等相关信息.")]),s._v(" "),n("h2",{attrs:{id:"参考链接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[s._v("#")]),s._v(" 参考链接")]),s._v(" "),n("ul",[n("li",[s._v("redhat-dhcp服务器:https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/html/networking_guide/sec-dhcp-configuring-server")]),s._v(" "),n("li",[s._v("dhcp-中继服务器:https://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/html/networking_guide/dhcp-relay-agent")])])])}),[],!1,null,null,null);t.default=e.exports}}]);