(window.webpackJsonp=window.webpackJsonp||[]).push([[203],{835:function(s,t,a){"use strict";a.r(t);var n=a(6),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"ceph-eploy-集群快速部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ceph-eploy-集群快速部署"}},[s._v("#")]),s._v(" Ceph- eploy 集群快速部署")]),s._v(" "),a("h2",{attrs:{id:"_1-1-安装环境介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-安装环境介绍"}},[s._v("#")]),s._v(" 1.1 安装环境介绍")]),s._v(" "),a("p",[s._v("首先介绍一下Ceph安装部署的方法，Ceph社区提供了三种部署方法：")]),s._v(" "),a("ul",[a("li",[s._v("ceph-deploy，一个集群自动化部署工具，使用较久，成熟稳定，被很多自动化工具所集成，可用于生产部署")])]),s._v(" "),a("p",[s._v("⚠️**注意：**ceph-deploy因某些原因不再积极维护，并且官方未在"),a("code",[s._v("Nautilus")]),s._v("版本以上做测试，所以你如果想要安装目前最新版本"),a("code",[s._v("octopus")]),s._v("还是选用其他部署方案，此外，该工具不支持REHL8、CentOS8等较新版本的Linux发行版。")]),s._v(" "),a("ul",[a("li",[s._v("cephadm，较新的集群自动化部署工具，支持通过图形界面或者命令行界面添加节点，目前不建议用于生产环境")]),s._v(" "),a("li",[s._v("manual，手动部署，一步步部署Ceph集群，支持较多定制化和了解部署细节，安装难度较大")])]),s._v(" "),a("p",[s._v("我们采用成熟、简单的ceph-deploy实现Ceph集群的部署，首先了解一下ceph-deploy的架构：")]),s._v(" "),a("ul",[a("li",[s._v("admin-node，需要一个安装管理节点，该安装节点集中管控ceph集群的安装")]),s._v(" "),a("li",[s._v("mon，monitor节点，即是Ceph的监视管理节点，承担Ceph集群重要的管理任务，一般需要3或5个节点")]),s._v(" "),a("li",[s._v("osd，OSD即Object Storage Daemon，实际负责数据存储的节点")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://agou-images.oss-cn-qingdao.aliyuncs.com/blog-images/Ceph%E9%9B%86%E7%BE%A4%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2/1%20-%201620.jpg",alt:"Ceph集群部署架构"}})]),s._v(" "),a("p",[s._v("安装环境以三个节点的方式来完成Ceph集群的部署，如下是各个集群安装部署的信息：")]),s._v(" "),a("ul",[a("li",[s._v("硬件环境：腾讯云CVM，1core+2G+50G系统盘+50G数据盘")]),s._v(" "),a("li",[s._v("操作系统：CentOS Linux release 7.6.1810 (Core)")]),s._v(" "),a("li",[s._v("软件版本：Mimic 13.2.8")]),s._v(" "),a("li",[s._v("部署版本：ceph-deploy  2.0.1")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[s._v("节点名称")]),s._v(" "),a("th",{staticStyle:{"text-align":"center"}},[s._v("角色说明")]),s._v(" "),a("th",{staticStyle:{"text-align":"center"}},[s._v("IP地址")]),s._v(" "),a("th",{staticStyle:{"text-align":"left"}},[s._v("备注说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("node-1")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("admin-node、monitor、OSD")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("172.16.1.129")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("承担ceph-deploy安装部署admin-node角色 2. 充当Ceph Monitor节点 3. 充当Ceph OSD节点，包含一块50G磁盘")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("node-2")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("OSD")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("172.16.1.130")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("充当Ceph OSD数据存储节点，包含一块20G磁盘")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[s._v("node-3")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("OSD")]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("172.16.1.131")]),s._v(" "),a("td",{staticStyle:{"text-align":"left"}},[s._v("充当Ceph OSD数据存储节点，包含一块20G磁盘")])])])]),s._v(" "),a("h2",{attrs:{id:"_1-2-前提环境准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-前提环境准备"}},[s._v("#")]),s._v(" 1.2 前提环境准备")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://agou-images.oss-cn-qingdao.aliyuncs.com/blog-images/Ceph%E9%9B%86%E7%BE%A4%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2/2%20-%201620.jpg",alt:"Ceph环境准备"}})]),s._v(" "),a("p",[s._v("安装Ceph之前需要将环境提前部署好，部署内容参考上图内容，官方安装时推荐创建一个新的用户来实现安装部署，"),a("a",{attrs:{href:"https://docs.ceph.com/docs/master/start/quick-start-preflight/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方参考文档"),a("OutboundLink")],1),s._v("，本文直接以root的身份实现集群的安装。"),a("strong",[s._v("备注：以下操作除了ssh无密码登陆之外，其他操作均需要在所有节点上执行。")])]),s._v(" "),a("p",[s._v("1、主机名设置，以node-1为例")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# hostnamectl set"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("hostname node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# hostnamectl status\n   Static hostname"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n         Icon name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" computer"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("vm\n           "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("Chassis")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" vm\n        Machine "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 0ea734564f9a4e2881b866b82d679dfc\n           Boot "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" b0bc8b8c9cb541d2a582cdb9e9cf22aa\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("Virtualization")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" kvm\n  Operating System"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" CentOS Linux "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Core"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n       "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CPE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("OS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("Name")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" cpe"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("o"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("centos"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("centos"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("Kernel")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Linux "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("957.27")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("el7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x86_64\n      "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("Architecture")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" x86"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("2、设置/etc/hosts文件，将node-1至node-3信息写入到/etc/hosts文件中")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# cat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("hosts\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".129")]),s._v(" node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".130")]),s._v(" node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".131")]),s._v(" node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("3、设置ssh无密码登陆，需要需要在node-1上生成key，然后将公钥拷贝到其他节点(包括node-1节点)，如下图")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://agou-images.oss-cn-qingdao.aliyuncs.com/blog-images/Ceph%E9%9B%86%E7%BE%A4%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2/3%20-%202u7p1t82sz.gif",alt:"设置无密码登陆"}})]),s._v(" "),a("p",[s._v("4、关闭Selinux默认已关闭")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# setenforce "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# getenforce \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("5、关闭iptables防火墙，或者放行对应的端口：Ceph monitor 6789/tcp，Ceph OSD 6800-7300/tcp")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# systemctl stop iptables\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# systemctl stop firewalld\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# systemctl disable iptables\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# systemctl disable firewalld\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("6、配置好ntp时间同步，Ceph是分布式集群，对时间很敏感，如果时间不正确可能会导致集群奔溃，因此在Ceph集中中设置ntp同步非常关键，推荐使用内网的ntp服务器同步时间，腾讯云CVM默认会同步到内网的ntp时间同步，读者根据需要进行设定")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# grep "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v("server "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ntp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf \nserver ntpupdate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tencentyun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com iburst\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ntpq "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("pn \n     remote           refid      st t when poll reach   delay   offset  jitter\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("169.254")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".2")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("183.3")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".239")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".152")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" u  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("238")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("377")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.093")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.443")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.145")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("7、设置Ceph安装yum源，选择安装版本为octopus")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# cat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("yum"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("repos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ceph"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("repo\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Ceph"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nname"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Ceph packages "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" $basearch\nbaseurl"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mirrors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("aliyun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rpm"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("nautilus"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("el7"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("$basearch\nenabled"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ngpgcheck"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ntype"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("rpm"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("md\ngpgkey"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mirrors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("aliyun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("keys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("release"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("asc\npriority"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("配置pip国内源，以防后面"),a("code",[s._v("install")]),s._v("时出现无法安装某个包的情况\n修改"),a("code",[s._v("~/.pip/pip.conf")]),s._v("(没有就创建一个文件夹及文件）")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("global"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nindex-url "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" https://pypi.tuna.tsinghua.edu.cn/simple\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("install"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ntrusted-host "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" https://pypi.tuna.tsinghua.edu.cn\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("临时使用可以加入"),a("code",[s._v("-i URL")]),s._v("，如："),a("code",[s._v("pip install -i https://pypi.tuna.tsinghua.edu.cn/simple ***")])]),s._v(" "),a("p",[s._v("8、安装Ceph-deploy,对应版本为2.0.1，重要：默认epel源中ceph-deploy的版本是1.5，版本较老，会涉及到很多rpm依赖，安装问题，安装前检查好对应的版本，确保无误。")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# yum update "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("y "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" yum install http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mirrors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("aliyun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("rpm"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("octopus"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("el7"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("noarch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("deploy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("noarch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rpm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("y\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("deploy "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("version\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("注意：如果"),a("code",[s._v("--verion")]),s._v("使用时出现"),a("code",[s._v('Traceback (most recent call last): File "/usr/bin/ceph-deploy", line 5, in <module> from pkg_resources import load_entry_point ImportError: No module named pkg_resources')]),s._v("的情况，安装"),a("code",[s._v("python-setuptools")]),s._v("即可。")]),s._v(" "),a("h2",{attrs:{id:"_1-3-部署ceph集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-部署ceph集群"}},[s._v("#")]),s._v(" 1.3 部署Ceph集群")]),s._v(" "),a("p",[s._v("Ceph-deploy部署过程中会生成一些集群初始化配置文件和key，后续扩容的时候也需要使用到，因此，建议在admin-node上创建一个单独的目录，后续操作都进入到该目录中进行操作，以创建的ceph-admin-node为例。")]),s._v(" "),a("p",[s._v("1、创建一个Ceph cluster集群,可以指定cluster-network（集群内部通讯）和public-network（外部访问Ceph集群）")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("admin "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("deploy "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("cluster"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("network "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("network "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     #创建集群\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEBUG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" found configuration file at"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("root")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cephdeploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Invoked")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("deploy "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("cluster"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("network "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("network "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("deploy options"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  username                      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" None\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  func                          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("at")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x7f0493dcdde8")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  verbose                       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" False\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  overwrite_conf                "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" False\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  quiet                         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" False\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  cd_conf                       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cephdeploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Conf instance at "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x7f0493541998")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  cluster                       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" ceph\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  ssh_copykey                   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" True\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  mon                           "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'node-1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  public_network                "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  ceph_conf                     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" None\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  cluster_network               "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  default_release               "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" False\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  fsid                          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" None\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEBUG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Creating "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("cluster")]),s._v(" named ceph\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" making sure passwordless "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SSH")]),s._v(" succeeds\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEBUG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" connected to host"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEBUG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" detect platform information from remote host\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEBUG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" detect machine type\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEBUG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" find the location "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("of")]),s._v(" an executable\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Running command"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ip link show\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("INFO")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Running command"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ip addr show\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEBUG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("IP")]),s._v(" addresses found"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("u"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'172.16.1.132'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEBUG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Resolving host node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEBUG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Monitor node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" at "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".132")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEBUG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Monitor initial members are "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'node-1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEBUG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Monitor addrs are "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("u"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'172.16.1.132'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEBUG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Creating a random mon key"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEBUG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Writing monitor keyring to ceph"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("keyring"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ceph_deploy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("new"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DEBUG")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Writing initial config to ceph"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br")])]),a("p",[s._v("通过上面的输出可以看到，new初始化集群过程中会生成ssh key密钥，ceph.conf配置文件，ceph.mon.keyring认证管理密钥，配置cluster network和pubic network，此时查看目录下的文件可以看到如下内容：")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("admin "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ls "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("l\n总用量 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("r"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("265")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("04")]),s._v(" ceph"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf    #配置文件\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("r"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("r"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3068")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("04")]),s._v(" ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("deploy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ceph"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log #部署日志文件\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("rw"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("73")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("月   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("04")]),s._v(" ceph"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mon"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("keyring #monitor认证key\n \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("admin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# cat ceph"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("global"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nfsid "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cfc3203b"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("6abb"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4957")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("af1b"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("e9a2abdfe725\npublic_network "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.254")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".100")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v("  #"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v("网络和cluster网络\ncluster_network "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.254")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".100")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v("\nmon_initial_members "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     #monitor的地址和主机名\nmon_host "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.254")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".100")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".101")]),s._v("\nauth_cluster_required "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cephx\nauth_service_required "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cephx\nauth_client_required "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cephx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("2、安装Ceph部署相关的软件，常规通过yum进行安装，由于可能会安装错软件包，因此ceph-deploy提供了一个install的工具辅助软件包的安装，"),a("code",[s._v("ceph-deploy install node-1 node-2 node-3")])]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("deploy install node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n # 如果某一节点部署失败，八成是下载程序包出现的问题，对该节点进行单独安装即可\n yum install ceph ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("radosgw\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("3、初始化monitor节点,执行"),a("code",[s._v("ceph-deploy mon create-initial")]),s._v("做初始化")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://agou-images.oss-cn-qingdao.aliyuncs.com/blog-images/Ceph%E9%9B%86%E7%BE%A4%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2/4%20-%203knafaaaz5.gif",alt:"ceph初始化"}})]),s._v(" "),a("p",[s._v("初始化完毕后会生成对应的keyring文件，用于ceph认证：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("ceph.client.admin.keyring")])]),s._v(" "),a("li",[a("code",[s._v("ceph.bootstrap-mgr.keyring")])]),s._v(" "),a("li",[a("code",[s._v("ceph.bootstrap-osd.keyring")])]),s._v(" "),a("li",[a("code",[s._v("ceph.bootstrap-mds.keyring")])]),s._v(" "),a("li",[a("code",[s._v("ceph.bootstrap-rgw.keyring")])]),s._v(" "),a("li",[a("code",[s._v("ceph.bootstrap-rbd.keyring")])]),s._v(" "),a("li",[a("code",[s._v("ceph.bootstrap-rbd-mirror.keyring")])])]),s._v(" "),a("p",[s._v("4、将认证密钥拷贝到其他节点，便于ceph命令行可以通过keyring和ceph集群进行交互,"),a("code",[s._v("ceph-deploy admin node-1 node-2 node-3")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://agou-images.oss-cn-qingdao.aliyuncs.com/blog-images/Ceph%E9%9B%86%E7%BE%A4%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2/5%20-%20bdjm18awgi.gif",alt:"Ceph拷贝管理密钥"}})]),s._v(" "),a("p",[s._v("此时，Ceph集群已经建立起来，包含一个monitor节点，通过ceph -s可以查看当前ceph集群的状态，由于此时并没有任何的OSD节点，因此无法往集群中写数据等操作,如下是ceph -s查看的输出结果")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ceph "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s \n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("cluster")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("     760da58c"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0041")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4525")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("a8ac"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("1118106312de\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("health")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("HEALTH_OK")]),s._v("\n \n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("mon")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" daemons"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" quorum node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("mgr")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" no daemons active\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("osd")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("osds")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" up"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\n \n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("pools")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" pools"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" pgs\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("objects")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  objects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("usage")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B")]),s._v(" used"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B")]),s._v(" avail\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("pgs")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("   \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("5、集群中目前还没有OSD节点，因此没法存储数据，接下来开始往集群中添加OSD节点，每个节点上都有一块50G的vdb磁盘，将其加入到集群中作为OSD节点,如"),a("code",[s._v("ceph-deploy osd create node-1 --data /dev/vdb")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://agou-images.oss-cn-qingdao.aliyuncs.com/blog-images/Ceph%E9%9B%86%E7%BE%A4%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2/6%20-%206xvae2muoj.gif",alt:"ceph添加osd节点"}})]),s._v(" "),a("p",[s._v("如上已将node-1的vdb添加到ceph集群中，ceph -s可以看到当前有一个osd加入到集群中，执行相同的方法将node-2和node-3上的磁盘添加到集群中")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("ceph-deploy osd create node-2 --data /dev/vdb")])]),s._v(" "),a("li",[a("code",[s._v("ceph-deploy osd create node-3 --data /dev/vdb")])])]),s._v(" "),a("p",[s._v("执行完毕后，三个OSD均已加入到ceph集群中，通过ceph -s可以看到对应三个OSD节点")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" ceph"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ceph "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("s \n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("cluster")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("id")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("     760da58c"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0041")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4525")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("a8ac"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("1118106312de\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("health")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("HEALTH_WARN")]),s._v("\n            no active mgr\n \n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("mon")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" daemons"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" quorum node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("mgr")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" no daemons active\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("osd")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("osds")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" up"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("  #三个"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("OSD")]),s._v("，当前状态都是up和"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("状态\n \n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("pools")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" pools"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" pgs\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("objects")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  objects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("usage")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B")]),s._v(" used"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B")]),s._v(" avail\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("pgs")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("     \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("也可以通过ceph osd tree查看每隔节点上osd的情况和crush tree的情况")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("# ceph osd tree \n"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ID")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CLASS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WEIGHT")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("TYPE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NAME")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("STATUS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("REWEIGHT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PRI")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AFF")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.14369")]),s._v(" root "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v("                            \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.04790")]),s._v("     host node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                         \n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   hdd "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.04790")]),s._v("         osd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       up  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.00000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.00000")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.04790")]),s._v("     host node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("                         \n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("   hdd "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.04790")]),s._v("         osd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       up  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.00000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.00000")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.04790")]),s._v("     host node"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("                         \n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("   hdd "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.04790")]),s._v("         osd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       up  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.00000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.00000")]),s._v(" \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("6、此时Ceph的health状态为HEALTH_WARN告警状态，提示信息为“no active mgr”，因此需要部署一个mgr节点，manager节点在luminous之后的版本才可以部署（本环境部署的是M版本，因此可以支持），将mgr部署到node-1节点，执行"),a("code",[s._v("ceph-deploy mgr create node-1")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://agou-images.oss-cn-qingdao.aliyuncs.com/blog-images/Ceph%E9%9B%86%E7%BE%A4%E5%BF%AB%E9%80%9F%E9%83%A8%E7%BD%B2/7%20-%20vka5irzwpc.gif",alt:"Ceph添加mgr节点"}})]),s._v(" "),a("p",[s._v("至此，Ceph集群已经部署完毕。通过ceph-deploy工具进行部署完成Ceph集群的自动化部署，后续添加monitor节点，osd节点，mgr节点也会很方便。")]),s._v(" "),a("h2",{attrs:{id:"_2-4-ceph安装小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-ceph安装小结"}},[s._v("#")]),s._v(" 2.4 Ceph安装小结")]),s._v(" "),a("p",[s._v("本文通过ceph-deploy完成一个1mon节点+1mgr节点+3个osd节点的集群，ceph-deploy安装简化了集群的部署，我在安装过程中遇到了不少报错（主要是rpm版本问题，尤其是ceph-deploy的包，EPEL默认的是1.5版本，需要用到ceph官网的2.0.1，否则会遇到各种各样的问题，1年未安装Ceph，变化很大，不得不感慨社区的发展速度）。")]),s._v(" "),a("p",[s._v("另外，还介绍了Ceph另外当前集群只有一个monitor节点，存在单点故障，当node-1节点故障时，整个集群都会处于不可用状态，因此需要部署高可用集群，以避免集群存在单点故障，保障业务的高可用性，后续章节来介绍monitor节点的扩容。")]),s._v(" "),a("h2",{attrs:{id:"参考文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[s._v("#")]),s._v(" 参考文档")]),s._v(" "),a("ul",[a("li",[s._v("ceph-deploy：https://docs.ceph.com/docs/master/install/ceph-deploy/quick-start-preflight/#ceph-deploy-setup")]),s._v(" "),a("li",[s._v("ceph-admin：https://docs.ceph.com/docs/master/cephadmin")]),s._v(" "),a("li",[s._v("手动安装：https://docs.ceph.com/docs/master/install/")]),s._v(" "),a("li",[s._v("资源池pool的管理：https://docs.ceph.com/docs/master/rbd/rados-rbd-cmds/")]),s._v(" "),a("li",[s._v("RBD块存储使用：https://docs.ceph.com/docs/master/start/quick-rbd/?highlight=rbdmap")])])])}),[],!1,null,null,null);t.default=e.exports}}]);