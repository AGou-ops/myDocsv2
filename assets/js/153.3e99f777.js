(window.webpackJsonp=window.webpackJsonp||[]).push([[153],{785:function(s,t,a){"use strict";a.r(t);var e=a(6),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker-远程访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-远程访问"}},[s._v("#")]),s._v(" Docker 远程访问")]),s._v(" "),a("h2",{attrs:{id:"配置服务端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置服务端"}},[s._v("#")]),s._v(" 配置服务端")]),s._v(" "),a("p",[s._v("编辑"),a("code",[s._v("/lib/systemd/system/docker.service")]),s._v("文件，找到"),a("code",[s._v("ExecStart")]),s._v("行，操作如下所示：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/dockerd -H fd:// --containerd"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/run/containerd/containerd.sock\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改为")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExecStart")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/bin/dockerd -H fd:// -H"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("tcp://0.0.0.0:2375\n\nsystemctl daemon-reload "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试访问")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" localhost:2375/images/json\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h2",{attrs:{id:"配置客户端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置客户端"}},[s._v("#")]),s._v(" 配置客户端")]),s._v(" "),a("p",[s._v("远程访问之前可以做好SSH免密，在此就不再赘述。")]),s._v(" "),a("h3",{attrs:{id:"使用环境变量-docker-host"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用环境变量-docker-host"}},[s._v("#")]),s._v(" 使用环境变量："),a("code",[s._v("DOCKER_HOST")])]),s._v(" "),a("p",[s._v("例如使用"),a("code",[s._v("docker-compose")]),s._v("时要连接远程docker：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DOCKER_HOST")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ssh://user@remotehost"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" up -d\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"docker-context"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-context"}},[s._v("#")]),s._v(" Docker Context")]),s._v(" "),a("p",[s._v("列出当前主机的"),a("code",[s._v("Docker 上下文")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" context "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\nNAME                DESCRIPTION                               DOCKER ENDPOINT     KUBERNETES ENDPOINT                ORCHESTRATOR\ndefault *           Current DOCKER_HOST based configuration   unix:///var/run/docker.sock    https://127.0.0.1:6443 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("default"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   swarm\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("创建一个新的上下文：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" context create remote ‐‐docker "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"host=ssh://root@woniu"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者使用tcp进行连接")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# docker context create remote --docker "host=tcp://IP:PORT"')]),s._v("\nremote\nSuccessfully created context “remote”\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("临时使用：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" ‐‐context remote "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\nCONTAINER ID    IMAGE   COMMAND   CREATED   STATUS   NAMES\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("切换当前上下文：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" context use remote\nremote\nCurrent context is now "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"remote"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);