(window.webpackJsonp=window.webpackJsonp||[]).push([[263],{895:function(s,a,t){"use strict";t.r(a);var n=t(6),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"influxdb-telegraf-basic"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#influxdb-telegraf-basic"}},[s._v("#")]),s._v(" influxDB/Telegraf basic")]),s._v(" "),t("h2",{attrs:{id:"简介及相关知识"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#简介及相关知识"}},[s._v("#")]),s._v(" 简介及相关知识")]),s._v(" "),t("blockquote",[t("p",[s._v("Telegraf 是一个用 Go 编写的代理程序，可收集系统和服务的统计数据，并写入到 InfluxDB 数据库。内存占用小，通过插件系统可轻松添加支持其他服务的扩展。")]),s._v(" "),t("p",[s._v("Influxdb 是一个开源的分布式时序、时间和指标数据库，使用 Go 语言编写，无需外部依赖。Influxdb 有如下三大特性：")]),s._v(" "),t("p",[s._v("①、基于时间序列，支持与时间有关的相关函数（如最大，最小，求和等）；")]),s._v(" "),t("p",[s._v("②、可度量性：你可以实时对大量数据进行计算；")]),s._v(" "),t("p",[s._v("③、基于事件：它支持任意的事件数据；")]),s._v(" "),t("p",[t("strong",[s._v("2、为什么要用telegraf和influxdb？")])]),s._v(" "),t("p",[s._v("①、在数据采集和平台监控系统中，Telegraf 可以采集多种组件的运行信息，而不需要自己手写脚本定时采集，降低数据获取的难度；")]),s._v(" "),t("p",[s._v("②、Telegraf 配置简单，只要有基本的 Linux 基础即可快速上手；")]),s._v(" "),t("p",[s._v("③、Telegraf 按照时间序列采集数据，数据结构中包含时序信息，influxdb就是为此类数据设计而来，使用 Influxdb 可以针采集得到的数据完成各种分析计算操作；")]),s._v(" "),t("p",[s._v("以上来源于：https://www.cnblogs.com/imyalost/p/9873621.html")])]),s._v(" "),t("p",[s._v("时序数据库主要用于存储基于时间序列的指标数据，例如一个Web页面的PV、UV等指标，将其定期采集，并打上时间戳，就是一份基于时间序列的指标。时序数据库通常用来配合前端页面来展示一段时间的指标曲线。")]),s._v(" "),t("h2",{attrs:{id:"快速安装与启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#快速安装与启动"}},[s._v("#")]),s._v(" 快速安装与启动")]),s._v(" "),t("p",[s._v("官方下载地址： https://portal.influxdata.com/downloads/")]),s._v(" "),t("p",[s._v("安装"),t("code",[s._v("influxDB")]),s._v(":")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -qO- https://repos.influxdata.com/influxdb.key "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" gpg -- dearmor "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/apt/trusted.gpg.d/influxdb.gpg "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /dev/null\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DISTRIB_ID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("lsb_release -si"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DISTRIB_CODENAME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("lsb_release -sc"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"deb [signed-by=/etc/apt/trusted.gpg.d/influxdb.gpg] https://repos.influxdata.com/'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${DISTRIB_ID"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(",,")]),s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${DISTRIB_CODENAME}")]),s._v(' stable"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/apt/sources.list.d/influxdb.list "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /dev/null\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" influxdb2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("安装"),t("code",[s._v("Telegraf")]),s._v("：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://dl.influxdata.com/telegraf/releases/telegraf_1.22.1-1_amd64.deb\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" dpkg -i telegraf_1.22.1-1_amd64.deb\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("启动服务：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("systemctl start influxdb\nsystemctl start telegraf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"telegraf收集nginx状态到influxdb并用grafana查询展示"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#telegraf收集nginx状态到influxdb并用grafana查询展示"}},[s._v("#")]),s._v(" Telegraf收集nginx状态到influxDB并用Grafana查询展示")]),s._v(" "),t("h3",{attrs:{id:"telegraf简单配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#telegraf简单配置"}},[s._v("#")]),s._v(" telegraf简单配置")]),s._v(" "),t("p",[s._v("配置"),t("code",[s._v("Telegraf")]),s._v("(默认deb安装的位置为"),t("code",[s._v("/etc/telegraf/telegraf.conf")]),s._v(")：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改配置文件相关内容，没有该文件的话，可以使用以下命令初始化个默认的配置文件")]),s._v("\ntelegraf --sample-config "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" telegraf.conf\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 同目录下也有个sample文件，可以直接复制改名")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("需要略微修改的地方：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://agou-images.oss-cn-qingdao.aliyuncs.com/others/image-20220422144857745.png",alt:"image-20220422144857745"}})]),s._v(" "),t("p",[s._v("将"),t("code",[s._v("122")]),s._v("行和"),t("code",[s._v("129")]),s._v("行取消注释，具体以当前文件为准。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://agou-images.oss-cn-qingdao.aliyuncs.com/others/image-20220422150746282.png",alt:"image-20220422150746282"}})]),s._v(" "),t("p",[s._v("大概"),t("code",[s._v("5761")]),s._v("行和"),t("code",[s._v("5763")]),s._v("行，取消注释[[inputs.nginx]]，注意，这里的"),t("code",[s._v("urls")]),s._v("填写的是你nginx的"),t("code",[s._v("nginx-status")]),s._v("页面，")]),s._v(" "),t("p",[s._v("如果你没有该页面，或者该模块没有被编译进nginx，参考这篇文章👉🏻：https://www.tecmint.com/enable-nginx-status-page/")]),s._v(" "),t("p",[s._v("重启telegraf使配置生效：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("systemctl restart telegraf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"influxdb中查看收集到的数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#influxdb中查看收集到的数据"}},[s._v("#")]),s._v(" influxDB中查看收集到的数据")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@localhost:~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("# influx\nConnected to http://localhost:8086 version "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.8")]),s._v(".10\nInfluxDB shell version: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.8")]),s._v(".10\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show databases\nname: databases\nname\n----\n_internal\ntelegraf\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use telegraf\nUsing database telegraf\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" show measurements\nname: measurements\nname\n----\ncpu\ndisk\ndiskio\nkernel\nmem\nnginx\nprocesses\nswap\nsystem\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" * from nginx\nname: nginx\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v("                accepts active handled "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("      port reading requests server    waiting writing\n----                ------- ------ ------- ----      ---- ------- -------- ------    ------- -------\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1650607510000000000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("        localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1650607520000000000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("        localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1650607530000000000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("        localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1650607540000000000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("        localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1650607550000000000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("        localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1650607560000000000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("        localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1650607570000000000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("        localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1650607580000000000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("        localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1650607590000000000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("        localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1650607600000000000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("       localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1650607610000000000")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("       localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("       localhost "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br")])]),t("h3",{attrs:{id:"grafana中查询influxdb并展示"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#grafana中查询influxdb并展示"}},[s._v("#")]),s._v(" Grafana中查询influxDB并展示")]),s._v(" "),t("p",[s._v("添加"),t("code",[s._v("influxDB")]),s._v("数据源很简单，填好"),t("code",[s._v("URL")]),s._v("和"),t("code",[s._v("Database")]),s._v("为"),t("code",[s._v("telegraf")]),s._v("就可以了，这里我就不再赘述.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://agou-images.oss-cn-qingdao.aliyuncs.com/others/image-20220422151431964.png",alt:"image-20220422151431964"}})]),s._v(" "),t("p",[s._v("其他高级操作自行摸索。。。：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://agou-images.oss-cn-qingdao.aliyuncs.com/others/image-20220422151521757.png",alt:"image-20220422151521757"}})]),s._v(" "),t("h2",{attrs:{id:"附录-influxdb-基本操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#附录-influxdb-基本操作"}},[s._v("#")]),s._v(" 附录：influxdb 基本操作")]),s._v(" "),t("p",[s._v("⚠️ "),t("code",[s._v("influxdb")]),s._v("的本地客户端cli工具名称叫做："),t("code",[s._v("influx")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建数据库")]),s._v("\ncreate database "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db_name"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示所有的数据库")]),s._v("\nshow databases\n \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除数据库")]),s._v("\ndrop database "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db_name"')]),s._v("\n \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#使用数据库")]),s._v("\nuse db_name\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示该数据库中所有的表")]),s._v("\nshow measurements\n \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建表，直接在插入数据的时候指定表名")]),s._v("\ninsert test,host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1,monitor_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("count")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除表")]),s._v("\ndrop measurement "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"measurement_name"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("p",[s._v("经典CRUD操作：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 增")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" use metrics\nUsing database metrics\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" insert test,host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1,monitor_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("count")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -i -XPOST "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://127.0.0.1:8086/write?db=metrics'")]),s._v(" -- data-binary "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test,host=127.0.0.1,monitor_name=test count=1'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" * from "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" order by "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" desc\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -G "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://localhost:8086/query?pretty=true'")]),s._v(" -- data-urlencode "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"db=metrics"')]),s._v(" -- data-urlencode "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"q=select * from test order by time desc"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 改")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" insert test,host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1,monitor_name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("count")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删")]),s._v("\ndrop measurement "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"measurement_name"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("导入导出数据：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("influx_inspect "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" -datadir "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/influxdb/data"')]),s._v(" -waldir "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/influxdb/wal"')]),s._v(" -out "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"geoip2influx.bak"')]),s._v(" -database "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"geoip2influx"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# -start "2021-09-10T00:00:00Z"')]),s._v("\n其中：\n  datadir: influxdb的数据存放位置\n  waldir: influxdb的wal目录\n  out: 输出文件\n  database: 导出的db名称\n  start: 从什么时间导出\n  \n  \n  \ninflux -import -path"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/agou-ops/geoip2influx.bak -precision"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ns\n\n其中：\n  import: 标识导入\n  path: 导入文件\n  precision: 导入的数据时间精度\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("用户管理：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#显示用户")]),s._v("\nshow "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("users")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建用户")]),s._v("\ncreate user "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),s._v(" with password "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'password'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建管理员权限用户")]),s._v("\ncreate user "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),s._v(" with password "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'password'")]),s._v(" with all privileges\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除用户")]),s._v("\ndrop user "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("其他：")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" FIELD "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEYS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看当前数据库所有表的字段")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" series "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pay "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看key数据")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" TAG "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEYS")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pay"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看key中tag key值")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" TAG "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pay"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"merId"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看key中tag 指定key值对应的值")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" TAG "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" cpu "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WITH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"region"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"host"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" service "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'redis'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" SERIES "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("measurement_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("measurement_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("tag_key"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'<tag_value>'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 删除key")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" CONTINUOUS QUERIES   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看连续执行命令")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" QUERIES  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看最后执行命令")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KILL")]),s._v(" QUERY "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("qid"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 结束命令")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" RETENTION POLICIES "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" mydb  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看保留数据")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--  查询数据")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LIMIT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查询当前数据库下所有表的第一行记录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pay  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("order")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("desc")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("limit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("  db_name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"POLICIES name"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("measurement_name "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 指定查询数据库下数据保留中的表数据 POLICIES name数据保留")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--  删除数据")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("delete")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"query"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 删除表所有数据，则表就不存在了")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("drop")]),s._v(" MEASUREMENT "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"query"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 删除表（注意会把数据保留删除使用delete不会）")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DELETE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" cpu\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DELETE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" cpu "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2000-01-01T00:00:00Z'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DELETE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("time")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'2000-01-01T00:00:00Z'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATABASE")]),s._v(" “testDB” "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 删除数据库")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" RETENTION POLICY "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dbbak"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" mydb "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 删除保留数据为dbbak数据")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" SERIES "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pay "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" tag_key"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 删除key中的tag")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" SHARDS  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查看数据存储文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" SHARD "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" SHARD GROUPS\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" SUBSCRIPTIONS\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("h2",{attrs:{id:"参考链接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[s._v("#")]),s._v(" 参考链接")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("数据采集工具Telegraf：简介及安装：https://www.cnblogs.com/imyalost/p/9873621.html")])]),s._v(" "),t("li",[t("p",[s._v("InfluxDB documentation：https://docs.influxdata.com/influxdb/v2.2/install/?t=Linux")])]),s._v(" "),t("li",[t("p",[s._v("influxdb基本操作：https://blog.csdn.net/u010185262/article/details/53158786")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);