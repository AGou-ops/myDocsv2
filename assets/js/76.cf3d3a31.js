(window.webpackJsonp=window.webpackJsonp||[]).push([[76],{707:function(e,s,t){"use strict";t.r(s);var a=t(6),n=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"kompose-basic"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kompose-basic"}},[e._v("#")]),e._v(" Kompose Basic")]),e._v(" "),t("h2",{attrs:{id:"简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[e._v("#")]),e._v(" 简介")]),e._v(" "),t("h3",{attrs:{id:"a-conversion-tool-to-go-from-docker-compose-to-kubernetes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#a-conversion-tool-to-go-from-docker-compose-to-kubernetes"}},[e._v("#")]),e._v(" A conversion tool to go from Docker Compose to Kubernetes")]),e._v(" "),t("h4",{attrs:{id:"what-s-kompose"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#what-s-kompose"}},[e._v("#")]),e._v(" What’s Kompose?")]),e._v(" "),t("p",[e._v("Kompose is a conversion tool for Docker Compose to container orchestrators such as Kubernetes (or OpenShift).")]),e._v(" "),t("p",[e._v("Kompose is deployed as a binary onto a client. To install Kompose on Katacoda, run the command as blow:")]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" -L https://github.com/kubernetes/kompose/releases/download/v1.9.0/kompose-linux-amd64 -o /usr/bin/kompose "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("chmod")]),e._v(" +x /usr/bin/kompose\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("Details on how to install Kompose for your OS can be found at https://github.com/kubernetes/kompose/releases")]),e._v(" "),t("h2",{attrs:{id:"简单样例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#简单样例"}},[e._v("#")]),e._v(" 简单样例")]),e._v(" "),t("p",[t("code",[e._v("docker-compose.yaml")]),e._v("文件内容如下所示：")]),e._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"2"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("redis-master")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" redis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("latest\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"6379"')]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("redis-slave")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" gcr.io/google_samples/gb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("redisslave"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("v1\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"6379"')]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" GET_HOSTS_FROM=dns\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("frontend")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" gcr.io/google"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("samples/gb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("frontend"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("v3\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"80:80"')]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" GET_HOSTS_FROM=dns\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br"),t("span",{staticClass:"line-number"},[e._v("17")]),t("br"),t("span",{staticClass:"line-number"},[e._v("18")]),t("br")])]),t("p",[e._v("As with Docker Compose, Kompose allows the Images to be deployed using a single command of "),t("code",[e._v("kompose up")])]),e._v(" "),t("p",[e._v("The details of what has been deployed can be discovered with the Kubernetes CLI "),t("em",[e._v("kubectl")]),e._v(".")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("kubectl get deployment,svc,pods,pvc\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("Kompose also has the ability to take existing Compose files and generate the related Kubernetes Manifest files.")]),e._v(" "),t("p",[e._v("The command "),t("code",[e._v("kompose convert")]),e._v(" will generate the files, viewable via "),t("code",[e._v("ls")]),e._v(".")]),e._v(" "),t("p",[e._v("Use command "),t("code",[e._v("kompose convert -j")]),e._v(" will generate the json format files.")]),e._v(" "),t("p",[e._v("Use command "),t("code",[e._v("kompose --provider openshift convert")]),e._v(" will generate the "),t("code",[e._v("OpenShift")]),e._v(" format files.")]),e._v(" "),t("blockquote",[t("p",[e._v("转载：Deploy Docker Compose with Kompose -- Katacoda")])]),e._v(" "),t("h2",{attrs:{id:"minikube-and-kompose"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#minikube-and-kompose"}},[e._v("#")]),e._v(" Minikube and Kompose")]),e._v(" "),t("p",[e._v("In this guide, we’ll deploy a sample "),t("code",[e._v("docker-compose.yaml")]),e._v(" file to a Kubernetes cluster.")]),e._v(" "),t("p",[e._v("Requirements:")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://github.com/kubernetes/minikube",target:"_blank",rel:"noopener noreferrer"}},[e._v("minikube"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/kubernetes/kompose",target:"_blank",rel:"noopener noreferrer"}},[e._v("kompose"),t("OutboundLink")],1)])]),e._v(" "),t("p",[t("strong",[e._v("Start "),t("code",[e._v("minikube")]),e._v(":")])]),e._v(" "),t("p",[e._v("If you don’t already have a Kubernetes cluster running, "),t("a",{attrs:{href:"https://github.com/kubernetes/minikube",target:"_blank",rel:"noopener noreferrer"}},[e._v("minikube"),t("OutboundLink")],1),e._v(" is the best way to get started.")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ minikube start\nStarting local Kubernetes v1.7.5 cluster...\nStarting VM...\nGetting VM IP address...\nMoving files into cluster...\nSetting up certs...\nConnecting to cluster...\nSetting up kubeconfig...\nStarting cluster components...\nKubectl is now configured to use the cluster\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br")])]),t("p",[t("strong",[e._v("Download an "),t("a",{attrs:{href:"https://raw.githubusercontent.com/kubernetes/kompose/master/examples/docker-compose.yaml",target:"_blank",rel:"noopener noreferrer"}},[e._v("example Docker Compose file"),t("OutboundLink")],1),e._v(", or use your own:")])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("wget https://raw.githubusercontent.com/kubernetes/kompose/master/examples/docker-compose.yaml\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("strong",[e._v("Convert your Docker Compose file to Kubernetes:")])]),e._v(" "),t("p",[e._v("Run "),t("code",[e._v("kompose convert")]),e._v(" in the same directory as your "),t("code",[e._v("docker-compose.yaml")]),e._v(" file.")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('$ kompose convert                           \nINFO Kubernetes file "frontend-service.yaml" created         \nINFO Kubernetes file "redis-master-service.yaml" created     \nINFO Kubernetes file "redis-slave-service.yaml" created      \nINFO Kubernetes file "frontend-deployment.yaml" created      \nINFO Kubernetes file "redis-master-deployment.yaml" created  \nINFO Kubernetes file "redis-slave-deployment.yaml" created \n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br")])]),t("p",[e._v("Alternatively, you can convert and deploy directly to Kubernetes with "),t("code",[e._v("kompose up")]),e._v(".")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ kompose up\nWe are going to create Kubernetes Deployments, Services and PersistentVolumeClaims for your Dockerized application. \nIf you need different kind of resources, use the 'kompose convert' and 'kubectl create -f' commands instead. \n\nINFO Successfully created Service: redis          \nINFO Successfully created Service: web            \nINFO Successfully created Deployment: redis       \nINFO Successfully created Deployment: web         \n\nYour application has been deployed to Kubernetes. You can run 'kubectl get deployment,svc,pods,pvc' for details.\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br")])]),t("p",[t("strong",[e._v("Access the newly deployed service:")])]),e._v(" "),t("p",[e._v("Now that your service has been deployed, let’s access it.")]),e._v(" "),t("p",[e._v("If you’re using "),t("code",[e._v("minikube")]),e._v(" you may access it via the "),t("code",[e._v("minikube service")]),e._v(" command.")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ minikube service frontend\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("Otherwise, use "),t("code",[e._v("kubectl")]),e._v(" to see what IP the service is using:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ kubectl describe svc frontend\nName:                   frontend\nNamespace:              default\nLabels:                 service=frontend\nSelector:               service=frontend\nType:                   LoadBalancer\nIP:                     10.0.0.183\nLoadBalancer Ingress:   123.45.67.89\nPort:                   80      80/TCP\nNodePort:               80      31144/TCP\nEndpoints:              172.17.0.4:80\nSession Affinity:       None\nNo events.\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br")])]),t("p",[e._v("Note: If you’re using a cloud provider, your IP will be listed next to "),t("code",[e._v("LoadBalancer Ingress")]),e._v(".")]),e._v(" "),t("p",[e._v("If you have yet to expose your service (for example, within GCE), use the command:")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('kubectl expose deployment frontend --type="LoadBalancer" \n')])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("To check functionality, you may also "),t("code",[e._v("curl")]),e._v(" the URL.")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ curl http://123.45.67.89\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h2",{attrs:{id:"参考链接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[e._v("#")]),e._v(" 参考链接")]),e._v(" "),t("ul",[t("li",[e._v("kompose user-guide: https://kompose.io/user-guide/")])])])}),[],!1,null,null,null);s.default=n.exports}}]);