(window.webpackJsonp=window.webpackJsonp||[]).push([[206],{839:function(e,s,a){"use strict";a.r(s);var t=a(6),n=Object(t.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"ceph-部署问题汇总"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ceph-部署问题汇总"}},[e._v("#")]),e._v(" ceph 部署问题汇总")]),e._v(" "),a("h2",{attrs:{id:"ceph部署问题汇总"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ceph部署问题汇总"}},[e._v("#")]),e._v(" ceph部署问题汇总")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("运行"),a("code",[e._v("ceph-deploy --verion")]),e._v("或者相关命令出现"),a("code",[e._v('Traceback (most recent call last): File "/usr/bin/ceph-deploy", line 5, in <module> from pkg_resources import load_entry_point ImportError: No module named pkg_resources')]),e._v("报错。\n解决方法：")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -y python-setuptools\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])])]),e._v(" "),a("li",[a("p",[e._v("运行"),a("code",[e._v("ceph-deploy install")]),e._v("时出现"),a("code",[e._v("[ceph_deploy][ERROR ] RuntimeError: Failed to execute command: yum -y install yum-plugin-priorities")]),e._v("。\n解决方法：")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# 尝试清理yum缓存并重建缓存")]),e._v("\nyum clean all\nyum makecache\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])])])]),e._v(" "),a("p",[e._v("或者可能是由于网络原因，可以单独对失败的节点重新install一遍")]),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[a("p",[e._v("运行"),a("code",[e._v("ceph-deploy admin")]),e._v("分发密钥时出现"),a("code",[e._v("[ceph_deploy.admin][ERROR ] RuntimeError: config file /etc/ceph/ceph.conf exists with different content; use --overwrite-conf to ov")]),e._v("。\n解决方法：")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("ceph-deploy --overwrite-conf config push stor1 stor2 stor3\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])])]),e._v(" "),a("li",[a("p",[e._v("添加osd"),a("code",[e._v("ceph-deploy osd create")]),e._v("时出现"),a("code",[e._v("[ceph_deploy.osd][ERROR ] Failed to execute command: /usr/sbin/ceph-volume --cluster ceph lvm create --bluestore --data /dev/sdb")]),e._v("。\n解决方法：")]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("这里的key 可以从"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")]),e._v("ceph auth get client.bootstrap-osd"),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("`")])]),e._v(" 里面得到\n"),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" /var/lib/ceph/bootstrap-osd/ceph.keyring\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("client.bootstrap-osd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n        key "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" AQD9qhRcBjs+MRAAKGOWtabeQlc/HvVa+yemv\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])])])]),e._v(" "),a("p",[e._v("实在不行或者删除掉错误节点的"),a("code",[e._v("/var/lib/ceph/bootstrap-osd/ceph.keyring")]),e._v("，再重新"),a("code",[e._v("ceph-deploy admin")]),e._v("一次")]),e._v(" "),a("p",[e._v("🙂 终极方法：")]),e._v(" "),a("p",[e._v("如果在某些地方碰到麻烦，想从头再来，可以用下列命令清除配置：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ceph-deploy purgedata {ceph-node} [{ceph-node}]\nceph-deploy forgetkeys\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("用下列命令可以连 Ceph 安装包一起清除：")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("ceph-deploy purge {ceph-node} [{ceph-node}]\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])])])}),[],!1,null,null,null);s.default=n.exports}}]);