(window.webpackJsonp=window.webpackJsonp||[]).push([[264],{896:function(s,a,t){"use strict";t.r(a);var n=t(6),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"rabbitmq-basic"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmq-basic"}},[s._v("#")]),s._v(" RabbitMQ Basic")]),s._v(" "),t("h2",{attrs:{id:"rabbitmq-简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmq-简介"}},[s._v("#")]),s._v(" RabbitMQ 简介")]),s._v(" "),t("p",[s._v("RabbitMQ 架构图：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://agou-images.oss-cn-qingdao.aliyuncs.com/blog-images/rabbitmq/rabbitMQ-arch.jpg",alt:"",title:"Rabbitmq Arch"}})]),s._v(" "),t("ul",[t("li",[t("code",[s._v("Broker")]),s._v(":它提供一种传输服务,它的角色就是维护一条从生产者到消费者的路线，保证数据能按照指定的方式进行传输,")]),s._v(" "),t("li",[t("code",[s._v("Exchange")]),s._v(":消息交换机,它指定消息按什么规则,路由到哪个队列。")]),s._v(" "),t("li",[t("code",[s._v("Queue")]),s._v(":消息的载体,每个消息都会被投到一个或多个队列。")]),s._v(" "),t("li",[t("code",[s._v("Binding")]),s._v(":绑定，它的作用就是把exchange和queue按照路由规则绑定起来.")]),s._v(" "),t("li",[t("code",[s._v("Routing Key")]),s._v(":路由关键字,exchange根据这个关键字进行消息投递。")]),s._v(" "),t("li",[t("code",[s._v("vhost")]),s._v(":虚拟主机,一个broker里可以有多个vhost，用作不同用户的权限分离。")]),s._v(" "),t("li",[t("code",[s._v("Producer")]),s._v(":消息生产者,就是投递消息的程序.")]),s._v(" "),t("li",[t("code",[s._v("Consumer")]),s._v(":消息消费者,就是接受消息的程序.")])]),s._v(" "),t("h2",{attrs:{id:"rabbitmq-安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmq-安装"}},[s._v("#")]),s._v(" RabbitMQ 安装")]),s._v(" "),t("h3",{attrs:{id:"单机部署"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#单机部署"}},[s._v("#")]),s._v(" 单机部署")]),s._v(" "),t("ol",[t("li",[t("code",[s._v("rabbitmq")]),s._v(" 依赖于 "),t("code",[s._v("erlang")]),s._v(" 环境，所以需要先安装"),t("code",[s._v("erlang")]),s._v("：")])]),s._v(" "),t("p",[s._v("官方提供适用的 erlang 程序包：https://github.com/rabbitmq/erlang-rpm/releases")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y https://github.com/rabbitmq/erlang-rpm/releases/download/v23.0.2/erlang-23.0.2-1.el7.x86_64.rpm\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输入erl验证erlang是否成功安装")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("、"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("# erl\nErlang/OTP "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("erts-11.0.2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("source"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("-bit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("smp:2:2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ds:2:2:10"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("async-threads:1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("hipe"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nEshell V11.0.2  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("abort with ^G"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("1")]),s._v(">")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("从 github 官方仓库直接安装 rpm 包：")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y https://github.com/rabbitmq/rabbitmq-server/releases/download/v3.8.4/rabbitmq-server-3.8.4-1.el7.noarch.rpm\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("启动"),t("code",[s._v("rabbitmq")]),s._v("：")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("systemctl start rabbitmq-server.service\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"4"}},[t("li",[s._v("查看"),t("code",[s._v("rabbitmq")]),s._v("运行状态：")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("rabbitmqctl status\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"集群搭建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#集群搭建"}},[s._v("#")]),s._v(" 集群搭建")]),s._v(" "),t("ol",[t("li",[s._v("在三台主机上添加相对应的"),t("code",[s._v("hosts")]),s._v("内容：")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -==----- /etc/hosts --------")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".1.128 master\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 仅为主机标识，并非真正主节点")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".1.134 node01\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".1.142 node02\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("把"),t("code",[s._v("master")]),s._v("上的"),t("code",[s._v("cookie")]),s._v("文件，复制到"),t("code",[s._v("node01")]),s._v("、"),t("code",[s._v("node02")]),s._v("节点上，集群环境下"),t("strong",[s._v("各个节点的cookie必须一致")]),s._v("。rpm安装的cookie 文件默认路径为 "),t("code",[s._v("/var/lib/rabbitmq/.erlang.cookie")])])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" /var/lib/rabbitmq/.erlang.cookie node01:/var/lib/rabbitmq/\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" /var/lib/rabbitmq/.erlang.cookie node02:/var/lib/rabbitmq/\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在各台主机上赋予其权限")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" -R "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),s._v(" /var/lib/rabbitmq/.erlang.cookie\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R rabbitmq:rabbitmq /var/lib/rabbitmq/.erlang.cookie\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("通过"),t("code",[s._v("rabbitmqctl")]),s._v("来配置集群，集群内部通讯端口为"),t("code",[s._v("25672")]),s._v("：")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动三个节点上的 rabbitmq 服务")]),s._v("\nsystemctl start rabbitmq-server\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("ol",{attrs:{start:"4"}},[t("li",[s._v("将"),t("code",[s._v("node01")]),s._v("和"),t("code",[s._v("node02")]),s._v("加入到"),t("code",[s._v("master")]),s._v("节点当中，并全都设置为硬盘节点：")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在 node01 上")]),s._v("\nrabbitmq-server -detached\t\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 -detached 参数是为了让 RabbitMQ 以守护进程方式在后台运行")]),s._v("\nrabbitmqctl stop_app                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只关闭rabbitmq服务，不关闭erlang服务")]),s._v("\nrabbitmqctl join_cluster rabbit@master   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --ram这个参数是内存节点模式，不加参数就是硬盘节点")]),s._v("\nrabbitmqctl start_app\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在 node02 上")]),s._v("\nrabbitmq-server -detached\nrabbitmqctl stop_app                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只关闭rabbitmq服务，不关闭erlang服务")]),s._v("\nrabbitmqctl join_cluster rabbit@master   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --ram这个参数是内存节点模式，不加参数就是硬盘节点")]),s._v("\nrabbitmqctl start_app\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("ol",{attrs:{start:"5"}},[t("li",[s._v("在任一主机上查看集群状态：")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@node01 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("# rabbitmqctl cluster_status\nCluster status of "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" rabbit@node01 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nBasics\n\nCluster name: rabbit@master\n\nDisk Nodes\n\nrabbit@master\nrabbit@node01\nrabbit@node02\n\nRunning Nodes\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 正在运行中的节点")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("rabbit@master"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("rabbit@node01"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("rabbit@node02"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n\nVersions\n\nrabbit@master: RabbitMQ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.8")]),s._v(".4 on Erlang "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23.0")]),s._v(".2\nrabbit@node01: RabbitMQ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.8")]),s._v(".4 on Erlang "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23.0")]),s._v(".2\nrabbit@node02: RabbitMQ "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.8")]),s._v(".4 on Erlang "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23.0")]),s._v(".2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("p",[s._v("启用 Web GUI 参考下面的[使用 web GUI 管理](#使用 web GUI 管理)")]),s._v(" "),t("p",[s._v("❓如果在 web 管理页面中看到节点出现"),t("code",[s._v("Node statistics not available")]),s._v("警告，则表示该节点没有启动相应 web 管理模块，使用以下三条命令进行启动：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("rabbitmqctl stop_app\nrabbitmq-plugins "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" rabbitmq_management\nrabbitmqctl start_app\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h4",{attrs:{id:"其他-剔除单个节点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其他-剔除单个节点"}},[s._v("#")]),s._v(" 其他 -- 剔除单个节点")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("rabbitmqctl stop_app\nrabbitmqctl reset\nrabbitmqctl start_app\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("or:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# For example, this command will remove the node "rabbit@stringer" from the node "hare@mcnulty":')]),s._v("\nrabbitmqctl -n hare@mcnulty forget_cluster_node rabbit@stringer\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# # on rabbit2")]),s._v("\nrabbitmqctl forget_cluster_node rabbit@rabbit1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"使用-web-gui-管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-web-gui-管理"}},[s._v("#")]),s._v(" 使用 web GUI 管理")]),s._v(" "),t("p",[s._v("查看当前所有用户：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("rabbitmqctl list_users\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("查看默认guest用户的权限（"),t("strong",[s._v("默认情况下仅有该账户")]),s._v("）：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("rabbitmqctl list_user_permissions guest\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("由于RabbitMQ默认的账号用户名和密码都是guest。为了安全起见, 先删掉默认用户：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("rabbitmqctl delete_user guest\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("添加新用户：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("rabbitmqctl add_user "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("password"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("设置用户标签：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("rabbitmqctl set_user_tags "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" administrator\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置用户tag为管理员")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("赋予用户默认vhost的全部操作权限：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("rabbitmqctl set_permissions -p / "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('".*"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('".*"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('".*"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("查看用户的权限：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@master ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("# rabbitmqctl list_user_permissions "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里我设置的是suofeiya用户名")]),s._v("\nListing permissions "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"suofeiya"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nvhost   configure       "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("write")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v("\n/       .*      .*      .*\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("开启"),t("code",[s._v("web")]),s._v("管理接口：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启 web 管理接口前停止rabbitmq")]),s._v("\nrabbitmqctl stop_app\nrabbitmq-plugins "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" rabbitmq_management\nrabbitmqctl start_app\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("最后打开浏览器访问：http://YOUR_IP:15672 即可。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://agou-images.oss-cn-qingdao.aliyuncs.com/blog-images/rabbitmq/rabbitmq.png",alt:""}})]),s._v(" "),t("p",[s._v("rabbitmq 集群：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://agou-images.oss-cn-qingdao.aliyuncs.com/blog-images/rabbitmq/rabbitmq-cluster.png",alt:"",title:"rabbitmq 集群"}})]),s._v(" "),t("h2",{attrs:{id:"参考资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),t("ul",[t("li",[s._v("RabbitMQ installation: https://www.rabbitmq.com/install-rpm.html")]),s._v(" "),t("li",[s._v("RabbitMQ Debian详细安装： https://www.rabbitmq.com/install-debian.html")]),s._v(" "),t("li",[s._v("RabbitMQ 系列教程（笔记）：https://zq99299.github.io/mq-tutorial")])])])}),[],!1,null,null,null);a.default=e.exports}}]);