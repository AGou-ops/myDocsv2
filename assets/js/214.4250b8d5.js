(window.webpackJsonp=window.webpackJsonp||[]).push([[214],{846:function(s,a,t){"use strict";t.r(a);var n=t(6),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("blockquote",[t("p",[s._v("Samba是在Linux和UNIX系统上实现SMB协议的一个免费软件，主要用于实现Windows和Linux之间互相共享资源.")])]),s._v(" "),t("h1",{attrs:{id:"samba-基础及实战"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#samba-基础及实战"}},[s._v("#")]),s._v(" SAMBA 基础及实战")]),s._v(" "),t("p",[t("code",[s._v("SMB（Server Message Block）通信协议")]),s._v("：是微软（Microsoft）和英特尔(Intel)在1987年制定的协议，主要是作为Microsoft网络的通讯协议，SMB协议在局域网上用于服务器文件访问和打印的协议。SMB 是在会话层（session layer）和表示层（presentation layer）以及小部分应用层（application layer）的协议。")]),s._v(" "),t("p",[t("code",[s._v("CIFS (Common Internet File System)")]),s._v("：通用Internet文件系统，在windows主机之间进行网络文件共享是通过使用微软公司自己的CIFS服务实现的，例如：Windows的网上邻居功能")]),s._v(" "),t("p",[s._v("SMB协议的实现在Windows上是"),t("code",[s._v("CIFS")]),s._v("，在Linux系统上是"),t("code",[s._v("SMABA")])]),s._v(" "),t("blockquote",[t("p",[s._v("Samba服务采用C/S模式,，其工作机制是让"),t("code",[s._v("NetBIOS")]),s._v("（Windows 网上邻居的通信协议）和"),t("code",[s._v("SMB")]),s._v("两个协议运行于TCP/IP通信协议之上，并且用NetBIOS协议让Windows在“网上邻居”中能浏览Linux服务器。Samba服务器既可以充当文件共享服务器，也可以充当一个Samba的客户端，例如，一台在Linux 下已经架设好的Samba服务器，windows客户端就可以通过SMB协议共享Samba服务器上的资源文件，同时，Samba服务器也可以访问网络中 其它windows系统或者Linux系统共享出来的文件")]),s._v(" "),t("p",[s._v("FROM:https://blog.51cto.com/itwish/2174270")])]),s._v(" "),t("h1",{attrs:{id:"所需软件及守护进程说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#所需软件及守护进程说明"}},[s._v("#")]),s._v(" 所需软件及守护进程说明")]),s._v(" "),t("p",[s._v("Samba所需软件包括：")]),s._v(" "),t("ul",[t("li",[s._v("Samba（服务器端软件包）")]),s._v(" "),t("li",[s._v("Samba-client（客户端软件包）")]),s._v(" "),t("li",[s._v("Samba-common（Samba公共文件软件包）")]),s._v(" "),t("li",[s._v("Samba-Winbind（使用 Windows 域控制器管理 Linux 帐户）")])]),s._v(" "),t("p",[s._v("Samba由"),t("code",[s._v("smbd")]),s._v("和 "),t("code",[s._v("nmbd")]),s._v("两个守护进程组成：")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",[s._v("smbd")]),s._v("服务进程是Samba的核心启动服务，用于提供"),t("code",[s._v("smb/cifs")]),s._v("服务，主要负责建立 Linux Samba服务器与Samba客户机之间的对话，为客户端提供文件共享与打印机服务及负责用户权限验证以及锁功能，smdb默认监听端口是 "),t("strong",[s._v("139 与 445 TCP")]),s._v("端口")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("nmbd")]),s._v("进程提供"),t("code",[s._v("NetBIOS")]),s._v("名称服务，用于实现Windows访问Linux文件，以满足基于Common Internet File System("),t("code",[s._v("CIFS")]),s._v(")协议的共享访问环境（类似与DNS实现的功能，实现把Linux系统共享的工作组名称与其IP对应起来），Samba通过nmb 服务启动 nmbd进程，该进程"),t("strong",[s._v("默认监听的是137与 138 UDP")]),s._v("端口")])])]),s._v(" "),t("h1",{attrs:{id:"samba安装与使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#samba安装与使用"}},[s._v("#")]),s._v(" SAMBA安装与使用")]),s._v(" "),t("h2",{attrs:{id:"使用yum安装smaba"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用yum安装smaba"}},[s._v("#")]),s._v(" 使用yum安装SMABA")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务器端程序")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y smaba\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 客户端程序")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y smaba-client\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"samba的简单使用-单用户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#samba的简单使用-单用户"}},[s._v("#")]),s._v(" SAMBA的简单使用(单用户)")]),s._v(" "),t("p",[s._v("⚠️用户创建的共享目录配置文件为"),t("code",[s._v("/var/lib/samba/usershares")])]),s._v(" "),t("ol",[t("li",[s._v("修改"),t("code",[s._v("smb.conf")]),s._v("参数（不修改默认也可以直接运行samba）：")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#======================= Global Settings =====================================")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ----------------------- Network-Related Options -------------------------")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# interfaces选项，值可以使用网卡名，也可以使用网卡地址，默认为所有地址，比如：")]),s._v("\ninterfaces "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" lo ens33 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".122.\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 简单写法172.16.122.\t表示172.16.122.0/24网段的地址")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --------------------------- Logging Options -----------------------------")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 日志滚动分割")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log file = specify where log files are written to and how they are split")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log files split per-machine:")]),s._v("\n        log "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /var/log/samba/log.%m\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文件名称")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# maximum size of 50KB per log file, then rotate:")]),s._v("\n        max log size "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\t\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 单个日志文件最大大小")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ----------------------- Standalone Server Options ------------------------")]),s._v("\n        security "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" user\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 系统用户安全模式，使用的是系统的用户")]),s._v("\n        passdb backend "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tdbsam\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 密码不是系统用户的密码")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("检查配置文件语法错误，使用命令"),t("code",[s._v("testparm")]),s._v("即可")]),s._v(" "),t("li",[s._v("语法检查无错误的话，可以直接启动samba服务")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("systemctl start nmbd smb\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"4"}},[t("li",[s._v("创建用户")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" smb\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以不指定用户密码")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用使用smbpasswd为该用户指定samba密码")]),s._v("\nsmbpasswd -a smb\n* 注意：首次创建用户的时候需要使用"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("-a"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("选项\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ol",{attrs:{start:"5"}},[t("li",[s._v("客户端挂载samba")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出服务器端的samba共享目录")]),s._v("\nsmbclient -L "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".122.132 -U smb\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 交互式命令行连接使用samba")]),s._v("\nsmbclient //172.16.122.132/smb -U smb\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"samba共享目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#samba共享目录"}},[s._v("#")]),s._v(" SAMBA共享目录")]),s._v(" "),t("ol",[t("li",[s._v("编辑"),t("code",[s._v("smb.conf")]),s._v("配置文件，添加自定义共享目录")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加以下内容")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sharing"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\tcomment "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sharing samba files\n\tpath "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /data/samba\n\tpublic "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\twritable "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\tbrowseable "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("检查语法错误"),t("code",[s._v("testparm")])]),s._v(" "),t("li",[s._v("重启"),t("code",[s._v("nmb")]),s._v("和"),t("code",[s._v("smb")]),s._v("服务")]),s._v(" "),t("li",[s._v("客户端查看并使用")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看")]),s._v("\nsmbclient -L "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".122.132 -U smb\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#### 结果")]),s._v("\nSharename       Type      Comment\n        ---------       ----      -------\n       "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v(" sharing         Disk      sharing samba files"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n        IPC$            IPC       IPC Service "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Samba Server Version "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.9")]),s._v(".1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        smb             Disk      Home Directories\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cli使用")]),s._v("\nsmbclient //172.16.122.132/sharing -U smb%123\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("ol",{attrs:{start:"5"}},[t("li",[s._v("可以使用facl来针对某些用户进行权限控制")])]),s._v(" "),t("h2",{attrs:{id:"smb-conf-配置详解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#smb-conf-配置详解"}},[s._v("#")]),s._v(" smb.conf 配置详解")]),s._v(" "),t("p",[t("RouterLink",{attrs:{to:"/post/FileSystem/smb.conf详解.html"}},[s._v("smb.conf文件详解")])],1),s._v(" "),t("h2",{attrs:{id:"windows-linux客户端挂载samba"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#windows-linux客户端挂载samba"}},[s._v("#")]),s._v(" Windows/Linux客户端挂载SAMBA")]),s._v(" "),t("p",[s._v("对于Windows客户端查看Linux服务器端共享文件而言：可以通过"),t("strong",[s._v("网页浏览器")]),s._v("、"),t("strong",[s._v("我的电脑")]),s._v("或者"),t("strong",[s._v("网上邻居")]),s._v("直接使用，具体方法是在地址栏输入")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用IP访问")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".122.133"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("共享目录名称"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用域访问")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("ZONE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("共享目录名称"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("对于Linux用户而言：有以下三种方法")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方法一：使用smbclient客户端工具")]),s._v("\nsmbclient //172.16.122.133/"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("共享目录名称"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -U "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("USER_NAME"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方法二：使用mount手动挂载")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" -t cifs  //172.16.122.133/"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("共享目录名称"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /mnt/samba -o "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("username")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("USER_NAME"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方法三：使用`/etc/fstab`开机自动挂载，添入以下内容")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####")]),s._v("\n//172.16.122.133/"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("共享目录名称"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\t/mnt/samba\tcifs\tdefaults,_netdev,user"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("suofeiya,password"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("suofeiya "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者")]),s._v("\n//172.16.122.133/"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("共享目录名称"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\t/mnt/samba\tcifs\tdefaults,_netdev,credentials"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/samba/pwd.txt "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# `/etc/smaba/pwd.txt`内容")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("username")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("suofeiya\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("password")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("suofeiya\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h1",{attrs:{id:"pdbedit、smbpasswd、smbclient的使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pdbedit、smbpasswd、smbclient的使用"}},[s._v("#")]),s._v(" pdbedit、smbpasswd、smbclient的使用")]),s._v(" "),t("h2",{attrs:{id:"pdbedit-增删用户-passdb-tdb-库中"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pdbedit-增删用户-passdb-tdb-库中"}},[s._v("#")]),s._v(" pdbedit(增删用户 --\x3e passdb.tdb 库中)")]),s._v(" "),t("p",[s._v("参数列表：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("–a username\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新建Samba账户")]),s._v("\n–x username\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除Samba账户")]),s._v("\n–L\t\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出Samba用户列表，读取passdb.tdb数据库文件")]),s._v("\n–Lv\t\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出Samba用户列表的详细信息")]),s._v("\n–c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[D]"')]),s._v(" –u username\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暂停该Samba用户账号的使用")]),s._v("\n–c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[]"')]),s._v(" –u username\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 恢复该Samba用户账号的使用")]),s._v("\n-t \t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从标准输出中接受用户信息，不显示提示符")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"smbpasswd-增删用户-单独文件中"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#smbpasswd-增删用户-单独文件中"}},[s._v("#")]),s._v(" smbpasswd(增删用户 --\x3e 单独文件中)")]),s._v(" "),t("p",[s._v("参数列表：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("-a username\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 向smbpasswd文件中添加用户，首次添加用户时需要加入该参数")]),s._v("\n-c /"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v("/TO/CONF_FILE\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定samba的配置文件")]),s._v("\n-x \t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从smbpasswd文件中删除用户")]),s._v("\n-d\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在smbpasswd文件中禁用指定的用户")]),s._v("\n-e\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在smbpasswd文件中激活指定的用户")]),s._v("\n-n\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将指定的用户的密码置空")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h2",{attrs:{id:"smbclient-客户端工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#smbclient-客户端工具"}},[s._v("#")]),s._v(" smbclient(客户端工具)")]),s._v(" "),t("p",[s._v("常用组合：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("smbclient -L "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.16")]),s._v(".122.133 -U username%password    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出samba共享服务器端的文件列表")]),s._v("\n* 服务器端可以使用smbstatus查看samba共享情况\nsmbclient  //172.16.122.133/data/smaba  -U username%password    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 像ftp一样，使用smbclient 与samba服务器进行交互操作")]),s._v("\nsmbclient -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls"')]),s._v("  //172.16.122.133//data/smaba  -U username%password    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不进入交互界面，直接显示共享目录下的列表文件")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h1",{attrs:{id:"samba-swat-smaba的web管理工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#samba-swat-smaba的web管理工具"}},[s._v("#")]),s._v(" samba-swat(SMABA的WEB管理工具)")]),s._v(" "),t("h2",{attrs:{id:"swat的安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#swat的安装"}},[s._v("#")]),s._v(" SWAT的安装")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 首先需要xinetd，因为swat工具是嵌套在xinetd超级守护进程中，需要用xinetd来管理")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y xinetd\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打开samba-swat的下载网站")]),s._v("\n* http://www.rpmfind.net/linux/rpm2html/search.php?query"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("samba-swat"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x86-64"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n* https://centos.pkgs.org/7/centos-x86_64/samba-4.9.1-6.el7.x86_64.rpm.html\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在服务器端进行安装")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y http://www.rpmfind.net/linux/mageia/distrib/5/x86_64/media/core/updates/samba-swat-3.6.25-2.9.mga5.x86_64.rpm\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"配置与启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置与启动"}},[s._v("#")]),s._v(" 配置与启动")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编辑/etc/xinetd.d/swat文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#### ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# default: off")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# description: SWAT is the Samba Web Admin Tool. Use swat \\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#              to configure your Samba server. To use SWAT, \\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#              connect to port 901 with your favorite web browser.")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" swat\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        port            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("901")]),s._v("\n        socket_type     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" stream\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wait")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" no\n        only_from       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 表示允许任意ip的主机访问")]),s._v("\n        user            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" root\n        server          "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/sbin/swat\n        log_on_failure  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" USERID\n        disable         "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" no    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把该项改为no ，代表启用swat 功能")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("####")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("p",[s._v("重启"),t("code",[s._v("xinetd")]),s._v("服务来启动"),t("code",[s._v("swat")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("systemctl restart xinetd\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);