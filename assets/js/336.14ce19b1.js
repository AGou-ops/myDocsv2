(window.webpackJsonp=window.webpackJsonp||[]).push([[336],{970:function(s,a,t){"use strict";t.r(a);var n=t(6),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"inotify-文件监控"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#inotify-文件监控"}},[s._v("#")]),s._v(" Inotify 文件监控")]),s._v(" "),t("h2",{attrs:{id:"inotify-简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#inotify-简介"}},[s._v("#")]),s._v(" Inotify 简介")]),s._v(" "),t("blockquote",[t("p",[s._v("开源地址： https：//github.com/inotify-tools/inotify-tools")])]),s._v(" "),t("p",[t("code",[s._v("Inotify")]),s._v(" 一种强大的、细粒度的、异步文件系统监控机制，它满足各种各样的文件监控需要，可以监控文件系统的访问属性、读写属性、权限属性、删除创建、移动等操作，也就是可以监控文件发生的一切变化。")]),s._v(" "),t("p",[t("code",[s._v("inotify-tools")]),s._v(" 是一个C库和一组命令行的工作，提供Linux下inotify的简单接口。"),t("code",[s._v("inotify-tools")]),s._v("安装后会得到"),t("code",[s._v("inotifywait")]),s._v("和"),t("code",[s._v("inotifywatch")]),s._v("这两条命令：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("inotifywait")]),s._v("命令 可以用来收集有关文件访问信息，Linux发行版一般没有包括这个命令，需要安装"),t("code",[s._v("inotify-tools")]),s._v("，"),t("strong",[s._v("这个命令还需要将inotify支持编译入Linux内核，好在大多数Linux发行版都在内核中启用了inotify")]),s._v("。")]),s._v(" "),t("li",[t("code",[s._v("inotifywatch")]),s._v("命令 用于收集关于被监视的文件系统的统计数据，包括每个 inotify 事件发生多少次。")])]),s._v(" "),t("h2",{attrs:{id:"检查和安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#检查和安装"}},[s._v("#")]),s._v(" 检查和安装")]),s._v(" "),t("h3",{attrs:{id:"检查系统内核是否支持inotify"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#检查系统内核是否支持inotify"}},[s._v("#")]),s._v(" 检查系统内核是否支持"),t("code",[s._v("Inotify")])]),s._v(" "),t("ul",[t("li",[s._v("方式一：使用 "),t("code",[s._v("uname -r")]),s._v(" 命令检查Linux内核，如果低于"),t("code",[s._v("2.6.13")]),s._v("，就需要重新编译内核加入"),t("code",[s._v("inotify")]),s._v("的支持。")]),s._v(" "),t("li",[s._v("方式二：使用"),t("code",[s._v("ll /proc/sys/fs/inotify")]),s._v("命令，是否有以下三条信息输出，如果没有表示不支持。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ ll /proc/sys/fs/inotify\n\ntotal "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n-rw-r--r-- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" Jan "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("：41 max_queued_events\n-rw-r--r-- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" Jan "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("：41 max_user_instances\n-rw-r--r-- "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" Jan "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("：41 max_user_watches\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"安装部分"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装部分"}},[s._v("#")]),s._v(" 安装部分")]),s._v(" "),t("ul",[t("li",[s._v("从源码安装(预先配置好编译环境, 在此就不再赘述)：")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载源码包")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https：//github.com/inotify-tools/inotify-tools/archive/3.20.2.2.tar.gz -o inotify-tools.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xf inotify-tools.tar.gz "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译安装")]),s._v("\n./configure --prefix"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'make install'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("ul",[t("li",[s._v("从现成仓库中直接安装：")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" inotify-tools\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum install inotify-tools")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"使用样例及常用参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用样例及常用参数"}},[s._v("#")]),s._v(" 使用样例及常用参数")]),s._v(" "),t("h3",{attrs:{id:"样例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#样例"}},[s._v("#")]),s._v(" 样例")]),s._v(" "),t("p",[s._v("inotifywait")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对某个文件进行只需监听, 使用`-m`选项")]),s._v("\n$ inotifywait -m log.txt\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 监控某个目录")]),s._v("\ninotifywait -mrq /var/log/nginx/\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 监控某个目录, 自定义格式、监控事件以及使用正则排除vim等编辑工具所触发的.swp临时文件的监听事件")]),s._v("\ninotifywait /var/log/nginx/ -r --timefmt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%d/%m/%y %H:%M'")]),s._v(" --format "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%T %f"')]),s._v(" -e MODIFY --exclude "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'^.*.swp$'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("inotifywatch")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# In this example, I’m recursively watching ~/.beagle for 60 seconds, while beagled is running.")]),s._v("\n$ inotifywatch -v -e access -e modify -t "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(" -r ~/.beagle\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"常用参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用参数"}},[s._v("#")]),s._v(" 常用参数")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("--timefmt 时间格式\n    %y年 %m月 %d日 %H小时 %M分钟\n--format 输出格式\n    %T时间 %w路径 %f文件名 %e状态\n \n-m 始终保持监听状态，默认触发事件即退出\n-r 递归查询目录\n-q 减少不必要的输出"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("只打印事件信息"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n \n-e 定义只监控的事件，常用参数如下：\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v("   打开文件\n    access 访问文件\n    modify 修改文件\n    delete 删除文件\n    create 新建文件\n    attrib 属性变更\n \n--exclude "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("pattern"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 指定要排除监控的文件/目录\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("h2",{attrs:{id:"附录1-inotifywait-示例脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#附录1-inotifywait-示例脚本"}},[s._v("#")]),s._v(" 附录1：inotifywait 示例脚本")]),s._v(" "),t("h4",{attrs:{id:"inotifywait-example-1-thanks-to-nick-lothian"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#inotifywait-example-1-thanks-to-nick-lothian"}},[s._v("#")]),s._v(" inotifywait example 1 (thanks to Nick Lothian)")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# get the current path")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CURPATH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n\ninotifywait -mr --timefmt "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%d/%m/%y %H:%M'")]),s._v(" --format "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%T %w %f'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-e close_write /tmp/test "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n\n       "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("FILECHANGE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${dir}")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${file}")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# convert absolute path to relative")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("FILECHANGEREL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$FILECHANGE")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s_'")]),s._v("$CURPATH"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/__'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n\n       "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" --progress --relative -vrae "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ssh -p 22'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$FILECHANGEREL")]),s._v(" usernam@example.com:/backup/root/dir "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"At '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${time}")]),s._v(" on "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${date}")]),s._v(", file "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$FILECHANGE")]),s._v(' was backed up via rsync"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("This may be the most efficient way to block for changes on files from a shell script.")]),s._v(" "),t("p",[s._v("If you don’t specify which event you want to catch, all will be caught, and the event which occurred is output on stdout.")]),s._v(" "),t("h4",{attrs:{id:"inotifywait-example-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#inotifywait-example-2"}},[s._v("#")]),s._v(" inotifywait example 2")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("EVENT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("inotifywait --format "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%e'")]),s._v(" ~/file1"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$?")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$EVENT")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MODIFY"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'file modified!'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$EVENT")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DELETE_SELF"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'file deleted!'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# etc...")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("blockquote",[t("p",[s._v("来源于"),t("a",{attrs:{href:"https://github.com/inotify-tools/inotify-tools/wiki",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方wiki文档"),t("OutboundLink")],1)])]),s._v(" "),t("h2",{attrs:{id:"附录2-inotifywait-参数详解及所有可监听事件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#附录2-inotifywait-参数详解及所有可监听事件"}},[s._v("#")]),s._v(" 附录2： inotifywait 参数详解及所有可监听事件")]),s._v(" "),t("p",[s._v("全部参数详解及命令格式：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("命令格式：\ninotifywait "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-hcmrq"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-e "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("event"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-t "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("seconds"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--format "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("fmt"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("--timefmt "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("fmt"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("file"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n选项参数：\n-h"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("--help 显示帮助信息\n@"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("file"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 排除不需要监视的文件，可以是相对路径，也可以是绝对路径\n--exclude "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("pattern"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 正则匹配需要排除的文件，大小写敏感\n--excludei "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("pattern"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 正则匹配需要排除的文件，忽略大小写。\n-m"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("--monitor 接收到一个事情而不退出，无限期地执行。默认行为是接收到一个事情后立即退出\n-d"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("--daemon 跟--monitor一样，除了是在后台运行，需要指定--outfile把事情输出到一个文件。也意味着使用了--syslog\n-r"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("--recursive 监视一个目录下的所有子目录\n--fromfile "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("file"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 从文件读取需要监视的文件或排除的文件，一个文件一行，排除的文件以@开头\n-o"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("--outfile "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("file"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("   输出事件到文件\n-s"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("--syslog 输出错误信息到系统日志\n-q"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("--quiet 不输出详细信息，只输出事件\n-qq 除了致命错误，不会输出任何信息\n--timefmt "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("fmt"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 指定时间格式，用于format选项中的%T格式\n-c"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("--csv 输出csv格式\n-t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("--timeout "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("seconds"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 设置超时时间，如果为0，则无限期地执行下去\n-e"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("--event "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("event"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("1")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" -e"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("--event "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("event"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  指定监听的时间，如果省略，则侦听所有事件\n--format "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("fmt"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" 指定输出格式  \n%w 表示发生事件的目录\n%f 表示发生事件的文件\n%e 表示发生的事件\n%Xe 事件以“X”分隔\n%T 使用由--timefmt定义的时间格式\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("p",[s._v("可监听事件：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("access 文件或者目录被读\nmodify 文件或目录被写入\nattrib 文件或者目录属性被更改\nclose_write 文件或目录关闭，在写模式下打开后\nclose_nowrite 文件或目录关闭，在只读模式打开后\nclose 文件或目录关闭，而不管是读/写模式\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" 文件或目录被打开\nmoved_to 文件或者目录移动到监视目录\nmoved_from 文件或者目录移出监视目录\nmove 文件或目录移出或者移入目录\ncreate 文件或目录被创建在监视目录\ndelete 文件或者目录被删除在监视目录\ndelete_self 文件或目录移除，之后不再监听此文件或目录\nunmount 文件系统取消挂载，之后不再监听此文件系统\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h2",{attrs:{id:"参考链接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[s._v("#")]),s._v(" 参考链接")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("Getting inotify-tools: https://github.com/inotify-tools/inotify-tools/wiki#getting")])]),s._v(" "),t("li",[t("p",[s._v("inotify 的安装与基本使用： https://blog.csdn.net/qq_37788558/article/details/104985262")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);