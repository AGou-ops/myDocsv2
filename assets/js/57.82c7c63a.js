(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{692:function(s,a,e){"use strict";e.r(a);var n=e(6),t=Object(n.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"五-配置清单使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#五-配置清单使用"}},[s._v("#")]),s._v(" 五 配置清单使用")]),s._v(" "),e("p",[s._v("apiserver 仅接收 json 格式的资源定义，yaml 格式定义提供的配置清单，apiserver 可自动将其转换为 json 格式，而后再进行执行。")]),s._v(" "),e("h2",{attrs:{id:"_5-1-可配置的对象"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-可配置的对象"}},[s._v("#")]),s._v(" 5.1 可配置的对象")]),s._v(" "),e("ul",[e("li",[s._v("可用资源清单配置的对象")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("workload：Pod、ReplicaSet、Deployment、StatefulSet、DaemonSet、Job、CronJob\n服务发现及均衡：Service、Ingress\n配置与存储：Volume、CSI\n    ConfigMap、Secret\n    DownwardAPI\n集群级资源\n    Namespace、None、Role、ClusterRole、RoleBinding、ClusterRoleBinding\n元数据类型资源\n    HPA、PodTemplate、LimitRange\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h2",{attrs:{id:"_5-2-配置清单组成"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-配置清单组成"}},[s._v("#")]),s._v(" 5.2 配置清单组成")]),s._v(" "),e("ul",[e("li",[s._v("配置清单组成部分，大部分资源使用配置清单方式来创建")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("apiVersion\n\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 以 "group/version" 形式指明，这个对象属于哪个 API 组（版本）')]),s._v("\nkind:\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 资源类别，标记创建什么类型的资源")]),s._v("\nmetadata:\n\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 元数据内部是嵌套的字段")]),s._v("\n\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义了资源对象的名称、命名空间（k8s级别的不是系统的）等、标签、注解等")]),s._v("\nspec:\n\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 规范定义资源应该拥有什么样的特性，依靠控制器确保特性能够被满足")]),s._v("\n\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 它是用户定义的所期望了资源状态")]),s._v("\nstatus:\n\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示资源的当前状态，k8s 就是确保当前状态向目标状态无限靠近从而满足用户期望")]),s._v("\n\t"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 它是只读的，代表了资源当前状态")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("ul",[e("li",[s._v("获取全部的 api 版本")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl api-versions\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("获取全部的 api 资源对象")])]),s._v(" "),e("p",[s._v("从内容可以看到一些缩写，方便我们日常命令后简写")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl api-resources\n\nkubectl get po          "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看pod")]),s._v("\nkubectl get deploy      "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看deployment")]),s._v("\nkubectl get svc         "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看service")]),s._v("\nkubectl get cm          "),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 configmap")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("h2",{attrs:{id:"_5-3-获取清单帮助"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-获取清单帮助"}},[s._v("#")]),s._v(" 5.3 获取清单帮助")]),s._v(" "),e("ul",[e("li",[s._v("查看 k8s 某个内置对象的配置清单格式，应该包含哪些字段，使用 . 来显示字段的格式帮助信息")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl explain pods\nkubectl explain pods.metadata\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h2",{attrs:{id:"_5-4-清单基本格式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-4-清单基本格式"}},[s._v("#")]),s._v(" 5.4 清单基本格式")]),s._v(" "),e("ul",[e("li",[s._v("定义一个资源清单")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("apiVersion: v1\nkind: Pod\nmetadata:\n  name: pod-deme\n  namespace: default\n  labels:\n    app: myapp\n    tier: frontend\nspec:\n  containers:\n  - name: myapp\n    image: ikubernetes/myapp:v1\n  - name: busybox\n    image: busybox:latest\n    command:\n    - "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/sh"')]),s._v("\n    - "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),s._v("\n    - "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sleep 10"')]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br")])]),e("h2",{attrs:{id:"_5-5-快捷获取清单"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-5-快捷获取清单"}},[s._v("#")]),s._v(" 5.5 快捷获取清单")]),s._v(" "),e("ul",[e("li",[s._v("使用 -o 参数来指定对象数据的输出格式，使用 --dry-run 来测试性执行一个指令，它两个结合起来，就可以通过命令创建，且生成 yaml 格式配置文件了 -o yaml --dry-run")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl create secret docker-registry regsecret --docker-server"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("registry-vpc.cn-hangzhou.aliyuncs.com --docker-username"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("admin --docker-password"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" --docker-email"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("420123641")]),s._v("@qq.com -o yaml --dry-run\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"_5-6-create-创建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-6-create-创建"}},[s._v("#")]),s._v(" 5.6 create 创建")]),s._v(" "),e("ul",[e("li",[s._v("创建资源清单中的资源，这样创建的为裸 POD ，没有控制器管理，所以删除后不会自动重建，成为自主式 POD")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl create -f pod-demo.yaml\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"_5-7-delete-删除"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-7-delete-删除"}},[s._v("#")]),s._v(" 5.7 delete 删除")]),s._v(" "),e("ul",[e("li",[s._v("删除资源清单中定义的 POD")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl delete -f pod-demo.yaml\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"_5-8-apply-创建或更新"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-8-apply-创建或更新"}},[s._v("#")]),s._v(" 5.8 apply 创建或更新")]),s._v(" "),e("p",[s._v("apply 可以执行多次，如果发现文件不同，则更新")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("kubectl apply -f pod-demo.yaml\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);