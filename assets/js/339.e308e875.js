(window.webpackJsonp=window.webpackJsonp||[]).push([[339],{972:function(s,a,t){"use strict";t.r(a);var n=t(6),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"lsyncd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lsyncd"}},[s._v("#")]),s._v(" lsyncd")]),s._v(" "),t("h2",{attrs:{id:"lsyncd-简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lsyncd-简介"}},[s._v("#")]),s._v(" lsyncd 简介")]),s._v(" "),t("p",[s._v("Lsyncd功能跟Inotify和Sersync相同，属于实时同步工具，但是Lsyncd功能更加强大，Lysncd 实际上是lua语言封装了 inotify 和 rsync 工具，采用了 Linux 内核 *（2.6.13 及以后）里的 inotify 触发机制，然后通过rsync去差异同步，达到实时的效果。Lsyncd最强大之处在于简单高效传输海量数据并且Lsyncd支持多种工作模式。")]),s._v(" "),t("p",[s._v("github 项目地址：https://github.com/axkibe/lsyncd")]),s._v(" "),t("h2",{attrs:{id:"lsyncd-安装与程序环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lsyncd-安装与程序环境"}},[s._v("#")]),s._v(" lsyncd 安装与程序环境")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum -y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" lsyncd\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 该包属于epel仓库，如果没有需要提前配置好epel仓库")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("程序环境：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("# "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ql lsyncd\n/etc/logrotate.d/lsyncd\n/etc/lsyncd.conf\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置文件")]),s._v("\n/etc/sysconfig/lsyncd\n/usr/bin/lsyncd\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 主程序")]),s._v("\n/usr/lib/systemd/system/lsyncd.service\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Unit FIle")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"lsyncd-简单示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lsyncd-简单示例"}},[s._v("#")]),s._v(" lsyncd 简单示例")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("角色")]),s._v(" "),t("th",[s._v("IP")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("主 lsyncd Server")]),s._v(" "),t("td",[s._v("192.168.8.176")])]),s._v(" "),t("tr",[t("td",[s._v("备 rsync Client")]),s._v(" "),t("td",[s._v("192.168.8.113")])])])]),s._v(" "),t("p",[s._v("为了方便起见，在这里我关闭了"),t("code",[s._v("Selinux")]),s._v("和防火墙.")]),s._v(" "),t("h3",{attrs:{id:"在-server-端"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在-server-端"}},[s._v("#")]),s._v(" 在 Server 端")]),s._v(" "),t("p",[s._v("编辑"),t("code",[s._v("/etc/lsyncd.conf")]),s._v("配置文件：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("settings "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  logfile "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/log/lsyncd/lsyncd.log"')]),s._v(",\n  statusFile "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/log/lsyncd/lsyncd.status"')]),s._v(",\n  inotifyMode "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CloseWrite"')]),s._v(",\n  maxProcesses "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(",\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  default.rsync,\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/backup"')]),s._v(",\n  target "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"agou_ops@192.168.8.113::backup"')]),s._v(",\n  delete "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" true,\n  exclude "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('".*"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  delay "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    binary "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/rsync"')]),s._v(",\n    archive "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" true,\n    compress "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" true,\n    verbose "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" true,\n    password_file "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/rsync_passwd"')]),s._v(",\n    _extra "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--bwlimit=200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("p",[s._v("提供密码文件"),t("code",[s._v("/etc/rsync.passwd")]),s._v("：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("suofeiya\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("修改文件权限，"),t("code",[s._v("chmod 600 /etc/rsync.passwd")])]),s._v(" "),t("p",[s._v("启动"),t("code",[s._v("lsyncd")]),s._v("服务，"),t("code",[s._v("systemctl start lsyncd")])]),s._v(" "),t("h3",{attrs:{id:"在-client-端"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在-client-端"}},[s._v("#")]),s._v(" 在 Client 端")]),s._v(" "),t("p",[s._v("安装"),t("code",[s._v("rsync")]),s._v("：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum -y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v("\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认有的发行版自带")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("编辑其配置文件"),t("code",[s._v("/etc/rsyncd.conf")]),s._v("：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("uid "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" root\ngid "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" root\nuse "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chroot")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nmax "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("connections")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nlog "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("file")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/log/rsyncd/rsyncd.log\npid "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("file")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/run/rsyncd.pid\nlock "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("file")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/run/rsyncd.lock\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("backup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 该名称要与Server端相一致")]),s._v("\npath "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /tmp/\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" only "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" no\nlist "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nauth "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("users")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" agou_ops\nsecrets "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /etc/rsync_passwd\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[s._v("创建账户和密码文件并编辑：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("root@PC-20200424YTTE:~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("# "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/rsync_passwd\nagou_ops:suofeiya\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("修改文件权限，"),t("code",[s._v("chmod 600 /etc/rsync.passwd")])]),s._v(" "),t("p",[s._v("启动"),t("code",[s._v("rsync")]),s._v("守护进程，"),t("code",[s._v("systemctl start rsync")])]),s._v(" "),t("h2",{attrs:{id:"lsyncd-配置文件参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lsyncd-配置文件参数"}},[s._v("#")]),s._v(" lsyncd 配置文件参数")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("settings                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 全局设置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\nlogfile                 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义日志文件")]),s._v("\nstausFile               "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义状态文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("nodaemon")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true           "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认不启用守护模式")]),s._v("\nstatusInterval          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将lsyncd的状态写入上面的statusFile的间隔，默认10秒")]),s._v("\ninotifyMode             "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定inotify监控的事件，默认是CloseWrite，还可以是Modify或CloseWrite or Modify")]),s._v("\nmaxProcesses            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 同步进程的最大个数Ls。假如同时有20个文件需要同步，而maxProcesses = 8，则最大能看到有8个rysnc进程")]),s._v("\nmaxDelays               "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 累计到多少所监控的事件激活一次同步，即使后面的delay延迟时间还未到")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -------------------  可以有多个sync，各自的source，各自的target，各自的模式，互不影响。")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("                                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 里面是定义同步参数，可以继续使用maxDelays来重写settings的全局变量。一般第一个参数指定lsyncd以什么模式运行：rsync rsyncssh direct三种模式")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\ndefault.rsync                       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 本地目录间同步，使用rsync，也可以达到使用ssh形式的远程rsync效果，或daemon方式连接远程rsyncd进程；")]),s._v("\ndefault.direct                      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 本地目录间同步，使用cp rm等命令完成差异文件备份；")]),s._v("\ndefault.rsyncssh                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 同步到远程主机目录，rsync的ssh模式，需要使用key来认证")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v("                              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 同步的源目录，使用绝对路径。")]),s._v("\n\ntarget                              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义目的地址.对应不同的模式有几种写法：")]),s._v("\n*（1） /tmp/dest                     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 本地目录同步，可用于direct和rsync模式")]),s._v("\n*（2） "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.29")]),s._v(".88.223:/tmp/dest       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 同步到远程服务器目录，可用于rsync和rsyncssh模式，拼接的命令类似于/usr/bin/rsync -ltsd --delete --include-from=- --exclude=* SOURCE TARGET，剩下的就是rsync的内容了，比如指定username，免密码同步")]),s._v("\n*（3） "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.29")]),s._v(".88.223::module         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 同步到远程服务器目录，用于rsync模式")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -----------------")]),s._v("\ndelete\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在目标上删除源中没有的内容。在启动时以及在正常操作期间删除的内容")]),s._v("\ndelete\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不会删除目标上的任何文件。不在启动时也不在正常操作上")]),s._v("\ndelete\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'startup'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Lsyncd将在启动时删除目标上的文件，但不会在正常操作时删除")]),s._v("\ndelete\t"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'running'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Lsyncd在启动时不会删除目标上的文件，但会删除正常操作期间删除的文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -----------------")]),s._v("\ninit                                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这是一个优化选项，当init = false，只同步进程启动以后发生改动事件的文件，原有的目录即使有差异也不会同步。默认是true")]),s._v("\n\ndelay                               "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 累计事件，等待rsync同步延时时间，默认15秒 *（最大累计到1000个不可合并的事件）。也就是15s内监控目录下发生的改动，会累积到一次rsync同步，避免过于频繁的同步。 *（可合并的意思是，15s内两次修改了同一文件，最后只同步最新的文件）")]),s._v("\n\nexcludeFrom                         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 排除选项，后面指定排除的列表文件，如excludeFrom = "/etc/lsyncd.exclude"如果是简单的排除，可以使用exclude = LIST。这里的排除规则写法与原生rsync有点不同，更为简单：监控路径里的任何部分匹配到一个文本，都会被排除，例如/bin/foo/bar可以匹配规则foo')]),s._v("\n *（1） 如果规则以斜线/开头，则从头开始要匹配全部\n *（2） 如果规则以/结尾，则要匹配监控路径的末尾\n *（3） ?匹配任何字符，但不包括/\n *（4） *匹配0或多个字符，但不包括/\n *（5） **匹配0或多个字符，可以是/\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rsync")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    binary "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/rsync"')]),s._v(",\n    archive "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" true,\n    compress "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" true,\n    verbose "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" true,\n    password_file "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/etc/rsync_passwd"')]),s._v(",\n    _extra "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--bwlimit=200"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n *（1） bwlimit 限速，单位kb/s，与rsync相同 *（这么重要的选项在文档里竟然没有标出）\n *（2） compress 压缩传输默认为true。在带宽与cpu负载之间权衡，本地目录同步可以考虑把它设为false\n *（3） perms 默认保留文件权限。\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br")])]),t("h2",{attrs:{id:"参考链接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[s._v("#")]),s._v(" 参考链接")]),s._v(" "),t("ul",[t("li",[s._v("官方文档：https://axkibe.github.io/lsyncd/")])])])}),[],!1,null,null,null);a.default=e.exports}}]);